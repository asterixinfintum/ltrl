import{u as Iw,v as Sw,w as xw,x as Pw,y as Ow,z as Nw,A as Tw,C as Rw,D as Aw,E as Cw,F as jo,G as Lo,J as Mo,K as qo,L as $w,M as Sn,N as oe,O as Dw,P as kf,Q as zo,R as Bf,S as Uw,T as Fo,U as Vf,V as Kf,W as Ho,X as jw,Y as Hr,e as Wf,Z as Lw,_ as Mw}from"./index-K6XkS2Nf.js";import{e as Cr,$ as ru}from"./events-i3GPfRuQ.js";function iu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Gf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?iu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Fc(n,t){t||(t=n.reduce((a,h)=>a+h.length,0));const r=Gf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return iu(r)}const vl={...Iw,...Sw,...xw,...Pw,...Ow,...Nw,...Tw,...Rw,...Aw,...Cw};function Jf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const wl=Jf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),bc=Jf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Gf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Qf={utf8:wl,"utf-8":wl,hex:vl.base16,latin1:bc,ascii:bc,binary:bc,...vl};function nr(n,t="utf8"){const r=Qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?iu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function Qt(n,t="utf8"){const r=Qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var bl=function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,h;s<a;s++)(h||!(s in t))&&(h||(h=Array.prototype.slice.call(t,0,s)),h[s]=t[s]);return n.concat(h||Array.prototype.slice.call(t))},qw=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),zw=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),Fw=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),Hw=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),kw=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Bw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Vw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,_l=3,Kw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Bw]],El=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Ww(n){return n?Il(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new kw:typeof navigator<"u"?Il(navigator.userAgent):Qw()}function Gw(n){return n!==""&&Kw.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var h=a.exec(n);return!!h&&[s,h]},!1)}function Il(n){var t=Gw(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Hw;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<_l&&(a=bl(bl([],a,!0),Yw(_l-a.length),!0)):a=[];var h=a.join("."),y=Jw(n),b=Vw.exec(n);return b&&b[1]?new Fw(r,h,y,b[1]):new qw(r,h,y)}function Jw(n){for(var t=0,r=El.length;t<r;t++){var s=El[t],a=s[0],h=s[1],y=h.exec(n);if(y)return a}return null}function Qw(){var n=typeof process<"u"&&process.version;return n?new zw(process.version.slice(1)):null}function Yw(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}const Xw={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var Zw={};(function(n){const t=Mo,r=qo,s=jo,a=Lo,h=u=>u==null,y=Symbol("encodeFragmentIdentifier");function b(u){switch(u.arrayFormat){case"index":return d=>(m,g)=>{const p=m.length;return g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[",p,"]"].join("")]:[...m,[E(d,u),"[",E(p,u),"]=",E(g,u)].join("")]};case"bracket":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[]"].join("")]:[...m,[E(d,u),"[]=",E(g,u)].join("")];case"colon-list-separator":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),":list="].join("")]:[...m,[E(d,u),":list=",E(g,u)].join("")];case"comma":case"separator":case"bracket-separator":{const d=u.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(g,p)=>p===void 0||u.skipNull&&p===null||u.skipEmptyString&&p===""?g:(p=p===null?"":p,g.length===0?[[E(m,u),d,E(p,u)].join("")]:[[g,E(p,u)].join(u.arrayFormatSeparator)])}default:return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,E(d,u)]:[...m,[E(d,u),"=",E(g,u)].join("")]}}function O(u){let d;switch(u.arrayFormat){case"index":return(m,g,p)=>{if(d=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!d){p[m]=g;return}p[m]===void 0&&(p[m]={}),p[m][d[1]]=g};case"bracket":return(m,g,p)=>{if(d=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"colon-list-separator":return(m,g,p)=>{if(d=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"comma":case"separator":return(m,g,p)=>{const T=typeof g=="string"&&g.includes(u.arrayFormatSeparator),x=typeof g=="string"&&!T&&N(g,u).includes(u.arrayFormatSeparator);g=x?N(g,u):g;const Q=T||x?g.split(u.arrayFormatSeparator).map(se=>N(se,u)):g===null?g:N(g,u);p[m]=Q};case"bracket-separator":return(m,g,p)=>{const T=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!T){p[m]=g&&N(g,u);return}const x=g===null?[]:g.split(u.arrayFormatSeparator).map(Q=>N(Q,u));if(p[m]===void 0){p[m]=x;return}p[m]=[].concat(p[m],x)};default:return(m,g,p)=>{if(p[m]===void 0){p[m]=g;return}p[m]=[].concat(p[m],g)}}}function _(u){if(typeof u!="string"||u.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(u,d){return d.encode?d.strict?t(u):encodeURIComponent(u):u}function N(u,d){return d.decode?r(u):u}function L(u){return Array.isArray(u)?u.sort():typeof u=="object"?L(Object.keys(u)).sort((d,m)=>Number(d)-Number(m)).map(d=>u[d]):u}function H(u){const d=u.indexOf("#");return d!==-1&&(u=u.slice(0,d)),u}function M(u){let d="";const m=u.indexOf("#");return m!==-1&&(d=u.slice(m)),d}function J(u){u=H(u);const d=u.indexOf("?");return d===-1?"":u.slice(d+1)}function te(u,d){return d.parseNumbers&&!Number.isNaN(Number(u))&&typeof u=="string"&&u.trim()!==""?u=Number(u):d.parseBooleans&&u!==null&&(u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(u=u.toLowerCase()==="true"),u}function ue(u,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),_(d.arrayFormatSeparator);const m=O(d),g=Object.create(null);if(typeof u!="string"||(u=u.trim().replace(/^[?#&]/,""),!u))return g;for(const p of u.split("&")){if(p==="")continue;let[T,x]=s(d.decode?p.replace(/\+/g," "):p,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?x:N(x,d),m(N(T,d),x,g)}for(const p of Object.keys(g)){const T=g[p];if(typeof T=="object"&&T!==null)for(const x of Object.keys(T))T[x]=te(T[x],d);else g[p]=te(T,d)}return d.sort===!1?g:(d.sort===!0?Object.keys(g).sort():Object.keys(g).sort(d.sort)).reduce((p,T)=>{const x=g[T];return x&&typeof x=="object"&&!Array.isArray(x)?p[T]=L(x):p[T]=x,p},Object.create(null))}n.extract=J,n.parse=ue,n.stringify=(u,d)=>{if(!u)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),_(d.arrayFormatSeparator);const m=x=>d.skipNull&&h(u[x])||d.skipEmptyString&&u[x]==="",g=b(d),p={};for(const x of Object.keys(u))m(x)||(p[x]=u[x]);const T=Object.keys(p);return d.sort!==!1&&T.sort(d.sort),T.map(x=>{const Q=u[x];return Q===void 0?"":Q===null?E(x,d):Array.isArray(Q)?Q.length===0&&d.arrayFormat==="bracket-separator"?E(x,d)+"[]":Q.reduce(g(x),[]).join("&"):E(x,d)+"="+E(Q,d)}).filter(x=>x.length>0).join("&")},n.parseUrl=(u,d)=>{d=Object.assign({decode:!0},d);const[m,g]=s(u,"#");return Object.assign({url:m.split("?")[0]||"",query:ue(J(u),d)},d&&d.parseFragmentIdentifier&&g?{fragmentIdentifier:N(g,d)}:{})},n.stringifyUrl=(u,d)=>{d=Object.assign({encode:!0,strict:!0,[y]:!0},d);const m=H(u.url).split("?")[0]||"",g=n.extract(u.url),p=n.parse(g,{sort:!1}),T=Object.assign(p,u.query);let x=n.stringify(T,d);x&&(x=`?${x}`);let Q=M(u.url);return u.fragmentIdentifier&&(Q=`#${d[y]?E(u.fragmentIdentifier,d):u.fragmentIdentifier}`),`${m}${x}${Q}`},n.pick=(u,d,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[y]:!1},m);const{url:g,query:p,fragmentIdentifier:T}=n.parseUrl(u,m);return n.stringifyUrl({url:g,query:a(p,d),fragmentIdentifier:T},m)},n.exclude=(u,d,m)=>{const g=Array.isArray(d)?p=>!d.includes(p):(p,T)=>!d(p,T);return n.pick(u,g,m)}})(Zw);function eb(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}const tb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function rb(n,t){const{message:r,code:s}=tb[n];return{message:t?`${r} ${t}`:r,code:s}}function Hc(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}const ib=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,nb=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,sb=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function ob(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){ab(n);return}return t}function ab(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function wo(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!sb.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(ib.test(n)||nb.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,ob)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function cb(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function zt(n,...t){try{return cb(n(...t))}catch(r){return Promise.reject(r)}}function ub(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function hb(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function xo(n){if(ub(n))return String(n);if(hb(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return xo(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Yf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const kc="base64:";function lb(n){if(typeof n=="string")return n;Yf();const t=Buffer.from(n).toString("base64");return kc+t}function fb(n){return typeof n!="string"||!n.startsWith(kc)?n:(Yf(),Buffer.from(n.slice(kc.length),"base64"))}function dr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function db(...n){return dr(n.join(":"))}function bo(n){return n=dr(n),n?n+":":""}const pb="memory",gb=()=>{const n=new Map;return{name:pb,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function yb(n={}){const t={mounts:{"":n.driver||gb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=_=>{for(const E of t.mountpoints)if(_.startsWith(E))return{base:E,relativeKey:_.slice(E.length),driver:t.mounts[E]};return{base:"",relativeKey:_,driver:t.mounts[""]}},s=(_,E)=>t.mountpoints.filter(N=>N.startsWith(_)||E&&_.startsWith(N)).map(N=>({relativeBase:_.length>N.length?_.slice(N.length):void 0,mountpoint:N,driver:t.mounts[N]})),a=(_,E)=>{if(t.watching){E=dr(E);for(const N of t.watchListeners)N(_,E)}},h=async()=>{if(!t.watching){t.watching=!0;for(const _ in t.mounts)t.unwatch[_]=await Sl(t.mounts[_],a,_)}},y=async()=>{if(t.watching){for(const _ in t.unwatch)await t.unwatch[_]();t.unwatch={},t.watching=!1}},b=(_,E,N)=>{const L=new Map,H=M=>{let J=L.get(M.base);return J||(J={driver:M.driver,base:M.base,items:[]},L.set(M.base,J)),J};for(const M of _){const J=typeof M=="string",te=dr(J?M:M.key),ue=J?void 0:M.value,u=J||!M.options?E:{...E,...M.options},d=r(te);H(d).items.push({key:te,value:ue,relativeKey:d.relativeKey,options:u})}return Promise.all([...L.values()].map(M=>N(M))).then(M=>M.flat())},O={hasItem(_,E={}){_=dr(_);const{relativeKey:N,driver:L}=r(_);return zt(L.hasItem,N,E)},getItem(_,E={}){_=dr(_);const{relativeKey:N,driver:L}=r(_);return zt(L.getItem,N,E).then(H=>wo(H))},getItems(_,E){return b(_,E,N=>N.driver.getItems?zt(N.driver.getItems,N.items.map(L=>({key:L.relativeKey,options:L.options})),E).then(L=>L.map(H=>({key:db(N.base,H.key),value:wo(H.value)}))):Promise.all(N.items.map(L=>zt(N.driver.getItem,L.relativeKey,L.options).then(H=>({key:L.key,value:wo(H)})))))},getItemRaw(_,E={}){_=dr(_);const{relativeKey:N,driver:L}=r(_);return L.getItemRaw?zt(L.getItemRaw,N,E):zt(L.getItem,N,E).then(H=>fb(H))},async setItem(_,E,N={}){if(E===void 0)return O.removeItem(_);_=dr(_);const{relativeKey:L,driver:H}=r(_);H.setItem&&(await zt(H.setItem,L,xo(E),N),H.watch||a("update",_))},async setItems(_,E){await b(_,E,async N=>{N.driver.setItems&&await zt(N.driver.setItems,N.items.map(L=>({key:L.relativeKey,value:xo(L.value),options:L.options})),E),N.driver.setItem&&await Promise.all(N.items.map(L=>zt(N.driver.setItem,L.relativeKey,xo(L.value),L.options)))})},async setItemRaw(_,E,N={}){if(E===void 0)return O.removeItem(_,N);_=dr(_);const{relativeKey:L,driver:H}=r(_);if(H.setItemRaw)await zt(H.setItemRaw,L,E,N);else if(H.setItem)await zt(H.setItem,L,lb(E),N);else return;H.watch||a("update",_)},async removeItem(_,E={}){typeof E=="boolean"&&(E={removeMeta:E}),_=dr(_);const{relativeKey:N,driver:L}=r(_);L.removeItem&&(await zt(L.removeItem,N,E),(E.removeMeta||E.removeMata)&&await zt(L.removeItem,N+"$",E),L.watch||a("remove",_))},async getMeta(_,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),_=dr(_);const{relativeKey:N,driver:L}=r(_),H=Object.create(null);if(L.getMeta&&Object.assign(H,await zt(L.getMeta,N,E)),!E.nativeOnly){const M=await zt(L.getItem,N+"$",E).then(J=>wo(J));M&&typeof M=="object"&&(typeof M.atime=="string"&&(M.atime=new Date(M.atime)),typeof M.mtime=="string"&&(M.mtime=new Date(M.mtime)),Object.assign(H,M))}return H},setMeta(_,E,N={}){return this.setItem(_+"$",E,N)},removeMeta(_,E={}){return this.removeItem(_+"$",E)},async getKeys(_,E={}){_=bo(_);const N=s(_,!0);let L=[];const H=[];for(const M of N){const te=(await zt(M.driver.getKeys,M.relativeBase,E)).map(ue=>M.mountpoint+dr(ue)).filter(ue=>!L.some(u=>ue.startsWith(u)));H.push(...te),L=[M.mountpoint,...L.filter(ue=>!ue.startsWith(M.mountpoint))]}return _?H.filter(M=>M.startsWith(_)&&!M.endsWith("$")):H.filter(M=>!M.endsWith("$"))},async clear(_,E={}){_=bo(_),await Promise.all(s(_,!1).map(async N=>{if(N.driver.clear)return zt(N.driver.clear,N.relativeBase,E);if(N.driver.removeItem){const L=await N.driver.getKeys(N.relativeBase||"",E);return Promise.all(L.map(H=>N.driver.removeItem(H,E)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(_=>xl(_)))},async watch(_){return await h(),t.watchListeners.push(_),async()=>{t.watchListeners=t.watchListeners.filter(E=>E!==_),t.watchListeners.length===0&&await y()}},async unwatch(){t.watchListeners=[],await y()},mount(_,E){if(_=bo(_),_&&t.mounts[_])throw new Error(`already mounted at ${_}`);return _&&(t.mountpoints.push(_),t.mountpoints.sort((N,L)=>L.length-N.length)),t.mounts[_]=E,t.watching&&Promise.resolve(Sl(E,a,_)).then(N=>{t.unwatch[_]=N}).catch(console.error),O},async unmount(_,E=!0){_=bo(_),!(!_||!t.mounts[_])&&(t.watching&&_ in t.unwatch&&(t.unwatch[_](),delete t.unwatch[_]),E&&await xl(t.mounts[_]),t.mountpoints=t.mountpoints.filter(N=>N!==_),delete t.mounts[_])},getMount(_=""){_=dr(_)+":";const E=r(_);return{driver:E.driver,base:E.base}},getMounts(_="",E={}){return _=dr(_),s(_,E.parents).map(L=>({driver:L.driver,base:L.mountpoint}))}};return O}function Sl(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function xl(n){typeof n.dispose=="function"&&await zt(n.dispose)}function Qi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function Xf(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Qi(r);return(a,h)=>s.then(y=>h(y.transaction(t,a).objectStore(t)))}let _c;function hs(){return _c||(_c=Xf("keyval-store","keyval")),_c}function Pl(n,t=hs()){return t("readonly",r=>Qi(r.get(n)))}function mb(n,t,r=hs()){return r("readwrite",s=>(s.put(t,n),Qi(s.transaction)))}function vb(n,t=hs()){return t("readwrite",r=>(r.delete(n),Qi(r.transaction)))}function wb(n=hs()){return n("readwrite",t=>(t.clear(),Qi(t.transaction)))}function bb(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Qi(n.transaction)}function _b(n=hs()){return n("readonly",t=>{if(t.getAllKeys)return Qi(t.getAllKeys());const r=[];return bb(t,s=>r.push(s.key)).then(()=>r)})}const Eb=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Ib=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function ls(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Ib(n)}catch{return n}}function Ji(n){return typeof n=="string"?n:Eb(n)||""}const Sb="idb-keyval";var xb=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=Xf(n.dbName,n.storeName)),{name:Sb,options:n,async hasItem(a){return!(typeof await Pl(r(a),s)>"u")},async getItem(a){return await Pl(r(a),s)??null},setItem(a,h){return mb(r(a),h,s)},removeItem(a){return vb(r(a),s)},getKeys(){return _b(s)},clear(){return wb(s)}}};const Pb="WALLET_CONNECT_V2_INDEXED_DB",Ob="keyvaluestorage";let Nb=class{constructor(){this.indexedDb=yb({driver:xb({dbName:Pb,storeName:Ob})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Ji(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Ec=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Po={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ec<"u"&&Ec.localStorage?Po.exports=Ec.localStorage:typeof window<"u"&&window.localStorage?Po.exports=window.localStorage:Po.exports=new t})();function Tb(n){var t;return[n[0],ls((t=n[1])!=null?t:"")]}let Rb=class{constructor(){this.localStorage=Po.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Tb)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ls(r)}async setItem(t,r){this.localStorage.setItem(t,Ji(r))}async removeItem(t){this.localStorage.removeItem(t)}};const Ab="wc_storage_version",Ol=1,Cb=async(n,t,r)=>{const s=Ab,a=await t.getItem(s);if(a&&a>=Ol){r(t);return}const h=await n.getKeys();if(!h.length){r(t);return}const y=[];for(;h.length;){const b=h.shift();if(!b)continue;const O=b.toLowerCase();if(O.includes("wc@")||O.includes("walletconnect")||O.includes("wc_")||O.includes("wallet_connect")){const _=await n.getItem(b);await t.setItem(b,_),y.push(b)}}await t.setItem(s,Ol),r(t),$b(n,y)},$b=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let Db=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Rb;this.storage=t;try{const r=new Nb;Cb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var xn={},Gn={},Ic={},Jn={};let Yi=class{};const Ub=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Yi},Symbol.toStringTag,{value:"Module"})),jb=$w(Ub);var Nl;function Lb(){if(Nl)return Jn;Nl=1,Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.IHeartBeat=void 0;const n=jb;class t extends n.IEvents{constructor(s){super()}}return Jn.IHeartBeat=t,Jn}var Tl;function Zf(){return Tl||(Tl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Sn.__exportStar(Lb(),n)}(Ic)),Ic}var Sc={},Vi={},Rl;function Mb(){if(Rl)return Vi;Rl=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.HEARTBEAT_EVENTS=Vi.HEARTBEAT_INTERVAL=void 0;const n=oe;return Vi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Vi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Vi}var Al;function ed(){return Al||(Al=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Sn.__exportStar(Mb(),n)}(Sc)),Sc}var Cl;function qb(){if(Cl)return Gn;Cl=1,Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.HeartBeat=void 0;const n=Sn,t=Cr,r=oe,s=Zf(),a=ed();class h extends s.IHeartBeat{constructor(b){super(b),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(b==null?void 0:b.interval)||a.HEARTBEAT_INTERVAL}static init(b){return n.__awaiter(this,void 0,void 0,function*(){const O=new h(b);return yield O.init(),O})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(b,O){this.events.on(b,O)}once(b,O){this.events.once(b,O)}off(b,O){this.events.off(b,O)}removeListener(b,O){this.events.removeListener(b,O)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Gn.HeartBeat=h,Gn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Sn;t.__exportStar(qb(),n),t.__exportStar(Zf(),n),t.__exportStar(ed(),n)})(xn);var Re={},xc,$l;function zb(){if($l)return xc;$l=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}xc=t;function t(r,s,a){var h=a&&a.stringify||n,y=1;if(typeof r=="object"&&r!==null){var b=s.length+y;if(b===1)return r;var O=new Array(b);O[0]=h(r);for(var _=1;_<b;_++)O[_]=h(s[_]);return O.join(" ")}if(typeof r!="string")return r;var E=s.length;if(E===0)return r;for(var N="",L=1-y,H=-1,M=r&&r.length||0,J=0;J<M;){if(r.charCodeAt(J)===37&&J+1<M){switch(H=H>-1?H:0,r.charCodeAt(J+1)){case 100:case 102:if(L>=E||s[L]==null)break;H<J&&(N+=r.slice(H,J)),N+=Number(s[L]),H=J+2,J++;break;case 105:if(L>=E||s[L]==null)break;H<J&&(N+=r.slice(H,J)),N+=Math.floor(Number(s[L])),H=J+2,J++;break;case 79:case 111:case 106:if(L>=E||s[L]===void 0)break;H<J&&(N+=r.slice(H,J));var te=typeof s[L];if(te==="string"){N+="'"+s[L]+"'",H=J+2,J++;break}if(te==="function"){N+=s[L].name||"<anonymous>",H=J+2,J++;break}N+=h(s[L]),H=J+2,J++;break;case 115:if(L>=E)break;H<J&&(N+=r.slice(H,J)),N+=String(s[L]),H=J+2,J++;break;case 37:H<J&&(N+=r.slice(H,J)),N+="%",H=J+2,J++,L--;break}++L}++J}return H===-1?r:(H<M&&(N+=r.slice(H)),N)}return xc}var Pc,Dl;function Fb(){if(Dl)return Pc;Dl=1;const n=zb();Pc=a;const t=g().console||{},r={mapHttpRequest:M,mapHttpResponse:M,wrapRequestSerializer:J,wrapResponseSerializer:J,wrapErrorSerializer:J,req:M,res:M,err:L};function s(p,T){return Array.isArray(p)?p.filter(function(Q){return Q!=="!stdSerializers.err"}):p===!0?Object.keys(T):!1}function a(p){p=p||{},p.browser=p.browser||{};const T=p.browser.transmit;if(T&&typeof T.send!="function")throw Error("pino: transmit option must have a send function");const x=p.browser.write||t;p.browser.write&&(p.browser.asObject=!0);const Q=p.serializers||{},se=s(p.browser.serialize,Q);let pe=p.browser.serialize;Array.isArray(p.browser.serialize)&&p.browser.serialize.indexOf("!stdSerializers.err")>-1&&(pe=!1);const Ae=["error","fatal","warn","info","debug","trace"];typeof x=="function"&&(x.error=x.fatal=x.warn=x.info=x.debug=x.trace=x),p.enabled===!1&&(p.level="silent");const ze=p.level||"info",S=Object.create(x);S.log||(S.log=te),Object.defineProperty(S,"levelVal",{get:ie}),Object.defineProperty(S,"level",{get:de,set:X});const C={transmit:T,serialize:se,asObject:p.browser.asObject,levels:Ae,timestamp:H(p)};S.levels=a.levels,S.level=ze,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=te,S.serializers=Q,S._serialize=se,S._stdErrSerialize=pe,S.child=W,T&&(S._logEvent=N());function ie(){return this.level==="silent"?1/0:this.levels.values[this.level]}function de(){return this._level}function X(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,h(C,S,"error","log"),h(C,S,"fatal","error"),h(C,S,"warn","error"),h(C,S,"info","log"),h(C,S,"debug","log"),h(C,S,"trace","log")}function W(Y,Z){if(!Y)throw new Error("missing bindings for child Pino");Z=Z||{},se&&Y.serializers&&(Z.serializers=Y.serializers);const Qe=Z.serializers;if(se&&Qe){var Be=Object.assign({},Q,Qe),Br=p.browser.serialize===!0?Object.keys(Be):se;delete Y.serializers,O([Y],Br,Be,this._stdErrSerialize)}function Ie(St){this._childLevel=(St._childLevel|0)+1,this.error=_(St,Y,"error"),this.fatal=_(St,Y,"fatal"),this.warn=_(St,Y,"warn"),this.info=_(St,Y,"info"),this.debug=_(St,Y,"debug"),this.trace=_(St,Y,"trace"),Be&&(this.serializers=Be,this._serialize=Br),T&&(this._logEvent=N([].concat(St._logEvent.bindings,Y)))}return Ie.prototype=this,new Ie(this)}return S}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ue,epochTime:u,unixTime:d,isoTime:m});function h(p,T,x,Q){const se=Object.getPrototypeOf(T);T[x]=T.levelVal>T.levels.values[x]?te:se[x]?se[x]:t[x]||t[Q]||te,y(p,T,x)}function y(p,T,x){!p.transmit&&T[x]===te||(T[x]=function(Q){return function(){const pe=p.timestamp(),Ae=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var S=0;S<Ae.length;S++)Ae[S]=arguments[S];if(p.serialize&&!p.asObject&&O(Ae,this._serialize,this.serializers,this._stdErrSerialize),p.asObject?Q.call(ze,b(this,x,Ae,pe)):Q.apply(ze,Ae),p.transmit){const C=p.transmit.level||T.level,ie=a.levels.values[C],de=a.levels.values[x];if(de<ie)return;E(this,{ts:pe,methodLevel:x,methodValue:de,transmitLevel:C,transmitValue:a.levels.values[p.transmit.level||T.level],send:p.transmit.send,val:T.levelVal},Ae)}}}(T[x]))}function b(p,T,x,Q){p._serialize&&O(x,p._serialize,p.serializers,p._stdErrSerialize);const se=x.slice();let pe=se[0];const Ae={};Q&&(Ae.time=Q),Ae.level=a.levels.values[T];let ze=(p._childLevel|0)+1;if(ze<1&&(ze=1),pe!==null&&typeof pe=="object"){for(;ze--&&typeof se[0]=="object";)Object.assign(Ae,se.shift());pe=se.length?n(se.shift(),se):void 0}else typeof pe=="string"&&(pe=n(se.shift(),se));return pe!==void 0&&(Ae.msg=pe),Ae}function O(p,T,x,Q){for(const se in p)if(Q&&p[se]instanceof Error)p[se]=a.stdSerializers.err(p[se]);else if(typeof p[se]=="object"&&!Array.isArray(p[se]))for(const pe in p[se])T&&T.indexOf(pe)>-1&&pe in x&&(p[se][pe]=x[pe](p[se][pe]))}function _(p,T,x){return function(){const Q=new Array(1+arguments.length);Q[0]=T;for(var se=1;se<Q.length;se++)Q[se]=arguments[se-1];return p[x].apply(this,Q)}}function E(p,T,x){const Q=T.send,se=T.ts,pe=T.methodLevel,Ae=T.methodValue,ze=T.val,S=p._logEvent.bindings;O(x,p._serialize||Object.keys(p.serializers),p.serializers,p._stdErrSerialize===void 0?!0:p._stdErrSerialize),p._logEvent.ts=se,p._logEvent.messages=x.filter(function(C){return S.indexOf(C)===-1}),p._logEvent.level.label=pe,p._logEvent.level.value=Ae,Q(pe,p._logEvent,ze),p._logEvent=N(S)}function N(p){return{ts:0,messages:[],bindings:p||[],level:{label:"",value:0}}}function L(p){const T={type:p.constructor.name,msg:p.message,stack:p.stack};for(const x in p)T[x]===void 0&&(T[x]=p[x]);return T}function H(p){return typeof p.timestamp=="function"?p.timestamp:p.timestamp===!1?ue:u}function M(){return{}}function J(p){return p}function te(){}function ue(){return!1}function u(){return Date.now()}function d(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function g(){function p(T){return typeof T<"u"&&T}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return p(self)||p(window)||p(this)||{}}}return Pc}var Ki={},Ul;function td(){return Ul||(Ul=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.PINO_CUSTOM_CONTEXT_KEY=Ki.PINO_LOGGER_DEFAULTS=void 0,Ki.PINO_LOGGER_DEFAULTS={level:"info"},Ki.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ki}var ir={},jl;function Hb(){if(jl)return ir;jl=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.generateChildLogger=ir.formatChildLoggerContext=ir.getLoggerContext=ir.setBrowserLoggerContext=ir.getBrowserLoggerContext=ir.getDefaultLoggerOptions=void 0;const n=td();function t(b){return Object.assign(Object.assign({},b),{level:(b==null?void 0:b.level)||n.PINO_LOGGER_DEFAULTS.level})}ir.getDefaultLoggerOptions=t;function r(b,O=n.PINO_CUSTOM_CONTEXT_KEY){return b[O]||""}ir.getBrowserLoggerContext=r;function s(b,O,_=n.PINO_CUSTOM_CONTEXT_KEY){return b[_]=O,b}ir.setBrowserLoggerContext=s;function a(b,O=n.PINO_CUSTOM_CONTEXT_KEY){let _="";return typeof b.bindings>"u"?_=r(b,O):_=b.bindings().context||"",_}ir.getLoggerContext=a;function h(b,O,_=n.PINO_CUSTOM_CONTEXT_KEY){const E=a(b,_);return E.trim()?`${E}/${O}`:O}ir.formatChildLoggerContext=h;function y(b,O,_=n.PINO_CUSTOM_CONTEXT_KEY){const E=h(b,O,_),N=b.child({context:E});return s(N,E,_)}return ir.generateChildLogger=y,ir}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Sn,r=t.__importDefault(Fb());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(td(),n),t.__exportStar(Hb(),n)})(Re);class kb extends Yi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let Bb=class extends Yi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},Vb=class{constructor(t,r){this.logger=t,this.core=r}},Kb=class extends Yi{constructor(t,r){super(),this.relayer=t,this.logger=r}},Wb=class extends Yi{constructor(t){super()}},Gb=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class Jb extends Yi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let Qb=class extends Yi{constructor(t,r){super(),this.core=t,this.logger=r}},Yb=class{constructor(t,r){this.projectId=t,this.logger=r}},Xb=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Zb=class{constructor(t){this.client=t}};var nu={},rd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Dw,r=kf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function b(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return b.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},b.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},b.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},b.prototype.update=function(O,_){if(_===void 0&&(_=O.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=_,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&_>0;)this._buffer[this._bufferLength++]=O[E++],_--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(_>=this.blockSize&&(E=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,O,E,_),_%=this.blockSize);_>0;)this._buffer[this._bufferLength++]=O[E++],_--;return this},b.prototype.finish=function(O){if(!this._finished){var _=this._bytesHashed,E=this._bufferLength,N=_/536870912|0,L=_<<3,H=_%128<112?128:256;this._buffer[E]=128;for(var M=E+1;M<H-8;M++)this._buffer[M]=0;t.writeUint32BE(N,this._buffer,H-8),t.writeUint32BE(L,this._buffer,H-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,H),this._finished=!0}for(var M=0;M<this.digestLength/8;M++)t.writeUint32BE(this._stateHi[M],O,M*8),t.writeUint32BE(this._stateLo[M],O,M*8+4);return this},b.prototype.digest=function(){var O=new Uint8Array(this.digestLength);return this.finish(O),O},b.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},b.prototype.restoreState=function(O){return this._stateHi.set(O.stateHi),this._stateLo.set(O.stateLo),this._bufferLength=O.bufferLength,O.buffer&&this._buffer.set(O.buffer),this._bytesHashed=O.bytesHashed,this._finished=!1,this},b.prototype.cleanSavedState=function(O){r.wipe(O.stateHi),r.wipe(O.stateLo),O.buffer&&r.wipe(O.buffer),O.bufferLength=0,O.bytesHashed=0},b}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(b,O,_,E,N,L,H){for(var M=_[0],J=_[1],te=_[2],ue=_[3],u=_[4],d=_[5],m=_[6],g=_[7],p=E[0],T=E[1],x=E[2],Q=E[3],se=E[4],pe=E[5],Ae=E[6],ze=E[7],S,C,ie,de,X,W,Y,Z;H>=128;){for(var Qe=0;Qe<16;Qe++){var Be=8*Qe+L;b[Qe]=t.readUint32BE(N,Be),O[Qe]=t.readUint32BE(N,Be+4)}for(var Qe=0;Qe<80;Qe++){var Br=M,Ie=J,St=te,F=ue,z=u,j=d,l=m,A=g,ae=p,ye=T,_e=x,Ce=Q,De=se,Pe=pe,xt=Ae,wt=ze;if(S=g,C=ze,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=(u>>>14|se<<18)^(u>>>18|se<<14)^(se>>>9|u<<23),C=(se>>>14|u<<18)^(se>>>18|u<<14)^(u>>>9|se<<23),X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,S=u&d^~u&m,C=se&pe^~se&Ae,X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,S=a[Qe*2],C=a[Qe*2+1],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,S=b[Qe%16],C=O[Qe%16],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,ie=Y&65535|Z<<16,de=X&65535|W<<16,S=ie,C=de,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=(M>>>28|p<<4)^(p>>>2|M<<30)^(p>>>7|M<<25),C=(p>>>28|M<<4)^(M>>>2|p<<30)^(M>>>7|p<<25),X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,S=M&J^M&te^J&te,C=p&T^p&x^T&x,X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,A=Y&65535|Z<<16,wt=X&65535|W<<16,S=F,C=Ce,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=ie,C=de,X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,F=Y&65535|Z<<16,Ce=X&65535|W<<16,J=Br,te=Ie,ue=St,u=F,d=z,m=j,g=l,M=A,T=ae,x=ye,Q=_e,se=Ce,pe=De,Ae=Pe,ze=xt,p=wt,Qe%16===15)for(var Be=0;Be<16;Be++)S=b[Be],C=O[Be],X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=b[(Be+9)%16],C=O[(Be+9)%16],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,ie=b[(Be+1)%16],de=O[(Be+1)%16],S=(ie>>>1|de<<31)^(ie>>>8|de<<24)^ie>>>7,C=(de>>>1|ie<<31)^(de>>>8|ie<<24)^(de>>>7|ie<<25),X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,ie=b[(Be+14)%16],de=O[(Be+14)%16],S=(ie>>>19|de<<13)^(de>>>29|ie<<3)^ie>>>6,C=(de>>>19|ie<<13)^(ie>>>29|de<<3)^(de>>>6|ie<<26),X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,b[Be]=Y&65535|Z<<16,O[Be]=X&65535|W<<16}S=M,C=p,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[0],C=E[0],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[0]=M=Y&65535|Z<<16,E[0]=p=X&65535|W<<16,S=J,C=T,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[1],C=E[1],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[1]=J=Y&65535|Z<<16,E[1]=T=X&65535|W<<16,S=te,C=x,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[2],C=E[2],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[2]=te=Y&65535|Z<<16,E[2]=x=X&65535|W<<16,S=ue,C=Q,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[3],C=E[3],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[3]=ue=Y&65535|Z<<16,E[3]=Q=X&65535|W<<16,S=u,C=se,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[4],C=E[4],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[4]=u=Y&65535|Z<<16,E[4]=se=X&65535|W<<16,S=d,C=pe,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[5],C=E[5],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[5]=d=Y&65535|Z<<16,E[5]=pe=X&65535|W<<16,S=m,C=Ae,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[6],C=E[6],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[6]=m=Y&65535|Z<<16,E[6]=Ae=X&65535|W<<16,S=g,C=ze,X=C&65535,W=C>>>16,Y=S&65535,Z=S>>>16,S=_[7],C=E[7],X+=C&65535,W+=C>>>16,Y+=S&65535,Z+=S>>>16,W+=X>>>16,Y+=W>>>16,Z+=Y>>>16,_[7]=g=Y&65535|Z<<16,E[7]=ze=X&65535|W<<16,L+=128,H-=128}return L}function y(b){var O=new s;O.update(b);var _=O.digest();return O.clean(),_}n.hash=y})(rd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=zo,r=rd,s=kf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(F){const z=new Float64Array(16);if(F)for(let j=0;j<F.length;j++)z[j]=F[j];return z}const h=new Uint8Array(32);h[0]=9;const y=a(),b=a([1]),O=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),_=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),N=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function H(F,z){for(let j=0;j<16;j++)F[j]=z[j]|0}function M(F){let z=1;for(let j=0;j<16;j++){let l=F[j]+z+65535;z=Math.floor(l/65536),F[j]=l-z*65536}F[0]+=z-1+37*(z-1)}function J(F,z,j){const l=~(j-1);for(let A=0;A<16;A++){const ae=l&(F[A]^z[A]);F[A]^=ae,z[A]^=ae}}function te(F,z){const j=a(),l=a();for(let A=0;A<16;A++)l[A]=z[A];M(l),M(l),M(l);for(let A=0;A<2;A++){j[0]=l[0]-65517;for(let ye=1;ye<15;ye++)j[ye]=l[ye]-65535-(j[ye-1]>>16&1),j[ye-1]&=65535;j[15]=l[15]-32767-(j[14]>>16&1);const ae=j[15]>>16&1;j[14]&=65535,J(l,j,1-ae)}for(let A=0;A<16;A++)F[2*A]=l[A]&255,F[2*A+1]=l[A]>>8}function ue(F,z){let j=0;for(let l=0;l<32;l++)j|=F[l]^z[l];return(1&j-1>>>8)-1}function u(F,z){const j=new Uint8Array(32),l=new Uint8Array(32);return te(j,F),te(l,z),ue(j,l)}function d(F){const z=new Uint8Array(32);return te(z,F),z[0]&1}function m(F,z){for(let j=0;j<16;j++)F[j]=z[2*j]+(z[2*j+1]<<8);F[15]&=32767}function g(F,z,j){for(let l=0;l<16;l++)F[l]=z[l]+j[l]}function p(F,z,j){for(let l=0;l<16;l++)F[l]=z[l]-j[l]}function T(F,z,j){let l,A,ae=0,ye=0,_e=0,Ce=0,De=0,Pe=0,xt=0,wt=0,at=0,je=0,Xe=0,Ze=0,ct=0,Fe=0,et=0,$e=0,Ve=0,lt=0,Me=0,Pt=0,Dt=0,Ft=0,Ht=0,Lt=0,Yt=0,or=0,Vr=0,Xt=0,Xr=0,mi=0,Ai=0,ft=j[0],it=j[1],dt=j[2],pt=j[3],ut=j[4],nt=j[5],Ot=j[6],Nt=j[7],gt=j[8],Tt=j[9],yt=j[10],bt=j[11],mt=j[12],Ye=j[13],Rt=j[14],At=j[15];l=z[0],ae+=l*ft,ye+=l*it,_e+=l*dt,Ce+=l*pt,De+=l*ut,Pe+=l*nt,xt+=l*Ot,wt+=l*Nt,at+=l*gt,je+=l*Tt,Xe+=l*yt,Ze+=l*bt,ct+=l*mt,Fe+=l*Ye,et+=l*Rt,$e+=l*At,l=z[1],ye+=l*ft,_e+=l*it,Ce+=l*dt,De+=l*pt,Pe+=l*ut,xt+=l*nt,wt+=l*Ot,at+=l*Nt,je+=l*gt,Xe+=l*Tt,Ze+=l*yt,ct+=l*bt,Fe+=l*mt,et+=l*Ye,$e+=l*Rt,Ve+=l*At,l=z[2],_e+=l*ft,Ce+=l*it,De+=l*dt,Pe+=l*pt,xt+=l*ut,wt+=l*nt,at+=l*Ot,je+=l*Nt,Xe+=l*gt,Ze+=l*Tt,ct+=l*yt,Fe+=l*bt,et+=l*mt,$e+=l*Ye,Ve+=l*Rt,lt+=l*At,l=z[3],Ce+=l*ft,De+=l*it,Pe+=l*dt,xt+=l*pt,wt+=l*ut,at+=l*nt,je+=l*Ot,Xe+=l*Nt,Ze+=l*gt,ct+=l*Tt,Fe+=l*yt,et+=l*bt,$e+=l*mt,Ve+=l*Ye,lt+=l*Rt,Me+=l*At,l=z[4],De+=l*ft,Pe+=l*it,xt+=l*dt,wt+=l*pt,at+=l*ut,je+=l*nt,Xe+=l*Ot,Ze+=l*Nt,ct+=l*gt,Fe+=l*Tt,et+=l*yt,$e+=l*bt,Ve+=l*mt,lt+=l*Ye,Me+=l*Rt,Pt+=l*At,l=z[5],Pe+=l*ft,xt+=l*it,wt+=l*dt,at+=l*pt,je+=l*ut,Xe+=l*nt,Ze+=l*Ot,ct+=l*Nt,Fe+=l*gt,et+=l*Tt,$e+=l*yt,Ve+=l*bt,lt+=l*mt,Me+=l*Ye,Pt+=l*Rt,Dt+=l*At,l=z[6],xt+=l*ft,wt+=l*it,at+=l*dt,je+=l*pt,Xe+=l*ut,Ze+=l*nt,ct+=l*Ot,Fe+=l*Nt,et+=l*gt,$e+=l*Tt,Ve+=l*yt,lt+=l*bt,Me+=l*mt,Pt+=l*Ye,Dt+=l*Rt,Ft+=l*At,l=z[7],wt+=l*ft,at+=l*it,je+=l*dt,Xe+=l*pt,Ze+=l*ut,ct+=l*nt,Fe+=l*Ot,et+=l*Nt,$e+=l*gt,Ve+=l*Tt,lt+=l*yt,Me+=l*bt,Pt+=l*mt,Dt+=l*Ye,Ft+=l*Rt,Ht+=l*At,l=z[8],at+=l*ft,je+=l*it,Xe+=l*dt,Ze+=l*pt,ct+=l*ut,Fe+=l*nt,et+=l*Ot,$e+=l*Nt,Ve+=l*gt,lt+=l*Tt,Me+=l*yt,Pt+=l*bt,Dt+=l*mt,Ft+=l*Ye,Ht+=l*Rt,Lt+=l*At,l=z[9],je+=l*ft,Xe+=l*it,Ze+=l*dt,ct+=l*pt,Fe+=l*ut,et+=l*nt,$e+=l*Ot,Ve+=l*Nt,lt+=l*gt,Me+=l*Tt,Pt+=l*yt,Dt+=l*bt,Ft+=l*mt,Ht+=l*Ye,Lt+=l*Rt,Yt+=l*At,l=z[10],Xe+=l*ft,Ze+=l*it,ct+=l*dt,Fe+=l*pt,et+=l*ut,$e+=l*nt,Ve+=l*Ot,lt+=l*Nt,Me+=l*gt,Pt+=l*Tt,Dt+=l*yt,Ft+=l*bt,Ht+=l*mt,Lt+=l*Ye,Yt+=l*Rt,or+=l*At,l=z[11],Ze+=l*ft,ct+=l*it,Fe+=l*dt,et+=l*pt,$e+=l*ut,Ve+=l*nt,lt+=l*Ot,Me+=l*Nt,Pt+=l*gt,Dt+=l*Tt,Ft+=l*yt,Ht+=l*bt,Lt+=l*mt,Yt+=l*Ye,or+=l*Rt,Vr+=l*At,l=z[12],ct+=l*ft,Fe+=l*it,et+=l*dt,$e+=l*pt,Ve+=l*ut,lt+=l*nt,Me+=l*Ot,Pt+=l*Nt,Dt+=l*gt,Ft+=l*Tt,Ht+=l*yt,Lt+=l*bt,Yt+=l*mt,or+=l*Ye,Vr+=l*Rt,Xt+=l*At,l=z[13],Fe+=l*ft,et+=l*it,$e+=l*dt,Ve+=l*pt,lt+=l*ut,Me+=l*nt,Pt+=l*Ot,Dt+=l*Nt,Ft+=l*gt,Ht+=l*Tt,Lt+=l*yt,Yt+=l*bt,or+=l*mt,Vr+=l*Ye,Xt+=l*Rt,Xr+=l*At,l=z[14],et+=l*ft,$e+=l*it,Ve+=l*dt,lt+=l*pt,Me+=l*ut,Pt+=l*nt,Dt+=l*Ot,Ft+=l*Nt,Ht+=l*gt,Lt+=l*Tt,Yt+=l*yt,or+=l*bt,Vr+=l*mt,Xt+=l*Ye,Xr+=l*Rt,mi+=l*At,l=z[15],$e+=l*ft,Ve+=l*it,lt+=l*dt,Me+=l*pt,Pt+=l*ut,Dt+=l*nt,Ft+=l*Ot,Ht+=l*Nt,Lt+=l*gt,Yt+=l*Tt,or+=l*yt,Vr+=l*bt,Xt+=l*mt,Xr+=l*Ye,mi+=l*Rt,Ai+=l*At,ae+=38*Ve,ye+=38*lt,_e+=38*Me,Ce+=38*Pt,De+=38*Dt,Pe+=38*Ft,xt+=38*Ht,wt+=38*Lt,at+=38*Yt,je+=38*or,Xe+=38*Vr,Ze+=38*Xt,ct+=38*Xr,Fe+=38*mi,et+=38*Ai,A=1,l=ae+A+65535,A=Math.floor(l/65536),ae=l-A*65536,l=ye+A+65535,A=Math.floor(l/65536),ye=l-A*65536,l=_e+A+65535,A=Math.floor(l/65536),_e=l-A*65536,l=Ce+A+65535,A=Math.floor(l/65536),Ce=l-A*65536,l=De+A+65535,A=Math.floor(l/65536),De=l-A*65536,l=Pe+A+65535,A=Math.floor(l/65536),Pe=l-A*65536,l=xt+A+65535,A=Math.floor(l/65536),xt=l-A*65536,l=wt+A+65535,A=Math.floor(l/65536),wt=l-A*65536,l=at+A+65535,A=Math.floor(l/65536),at=l-A*65536,l=je+A+65535,A=Math.floor(l/65536),je=l-A*65536,l=Xe+A+65535,A=Math.floor(l/65536),Xe=l-A*65536,l=Ze+A+65535,A=Math.floor(l/65536),Ze=l-A*65536,l=ct+A+65535,A=Math.floor(l/65536),ct=l-A*65536,l=Fe+A+65535,A=Math.floor(l/65536),Fe=l-A*65536,l=et+A+65535,A=Math.floor(l/65536),et=l-A*65536,l=$e+A+65535,A=Math.floor(l/65536),$e=l-A*65536,ae+=A-1+37*(A-1),A=1,l=ae+A+65535,A=Math.floor(l/65536),ae=l-A*65536,l=ye+A+65535,A=Math.floor(l/65536),ye=l-A*65536,l=_e+A+65535,A=Math.floor(l/65536),_e=l-A*65536,l=Ce+A+65535,A=Math.floor(l/65536),Ce=l-A*65536,l=De+A+65535,A=Math.floor(l/65536),De=l-A*65536,l=Pe+A+65535,A=Math.floor(l/65536),Pe=l-A*65536,l=xt+A+65535,A=Math.floor(l/65536),xt=l-A*65536,l=wt+A+65535,A=Math.floor(l/65536),wt=l-A*65536,l=at+A+65535,A=Math.floor(l/65536),at=l-A*65536,l=je+A+65535,A=Math.floor(l/65536),je=l-A*65536,l=Xe+A+65535,A=Math.floor(l/65536),Xe=l-A*65536,l=Ze+A+65535,A=Math.floor(l/65536),Ze=l-A*65536,l=ct+A+65535,A=Math.floor(l/65536),ct=l-A*65536,l=Fe+A+65535,A=Math.floor(l/65536),Fe=l-A*65536,l=et+A+65535,A=Math.floor(l/65536),et=l-A*65536,l=$e+A+65535,A=Math.floor(l/65536),$e=l-A*65536,ae+=A-1+37*(A-1),F[0]=ae,F[1]=ye,F[2]=_e,F[3]=Ce,F[4]=De,F[5]=Pe,F[6]=xt,F[7]=wt,F[8]=at,F[9]=je,F[10]=Xe,F[11]=Ze,F[12]=ct,F[13]=Fe,F[14]=et,F[15]=$e}function x(F,z){T(F,z,z)}function Q(F,z){const j=a();let l;for(l=0;l<16;l++)j[l]=z[l];for(l=253;l>=0;l--)x(j,j),l!==2&&l!==4&&T(j,j,z);for(l=0;l<16;l++)F[l]=j[l]}function se(F,z){const j=a();let l;for(l=0;l<16;l++)j[l]=z[l];for(l=250;l>=0;l--)x(j,j),l!==1&&T(j,j,z);for(l=0;l<16;l++)F[l]=j[l]}function pe(F,z){const j=a(),l=a(),A=a(),ae=a(),ye=a(),_e=a(),Ce=a(),De=a(),Pe=a();p(j,F[1],F[0]),p(Pe,z[1],z[0]),T(j,j,Pe),g(l,F[0],F[1]),g(Pe,z[0],z[1]),T(l,l,Pe),T(A,F[3],z[3]),T(A,A,_),T(ae,F[2],z[2]),g(ae,ae,ae),p(ye,l,j),p(_e,ae,A),g(Ce,ae,A),g(De,l,j),T(F[0],ye,_e),T(F[1],De,Ce),T(F[2],Ce,_e),T(F[3],ye,De)}function Ae(F,z,j){for(let l=0;l<4;l++)J(F[l],z[l],j)}function ze(F,z){const j=a(),l=a(),A=a();Q(A,z[2]),T(j,z[0],A),T(l,z[1],A),te(F,l),F[31]^=d(j)<<7}function S(F,z,j){H(F[0],y),H(F[1],b),H(F[2],b),H(F[3],y);for(let l=255;l>=0;--l){const A=j[l/8|0]>>(l&7)&1;Ae(F,z,A),pe(z,F),pe(F,F),Ae(F,z,A)}}function C(F,z){const j=[a(),a(),a(),a()];H(j[0],E),H(j[1],N),H(j[2],b),T(j[3],E,N),S(F,j,z)}function ie(F){if(F.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const z=(0,r.hash)(F);z[0]&=248,z[31]&=127,z[31]|=64;const j=new Uint8Array(32),l=[a(),a(),a(),a()];C(l,z),ze(j,l);const A=new Uint8Array(64);return A.set(F),A.set(j,32),{publicKey:j,secretKey:A}}n.generateKeyPairFromSeed=ie;function de(F){const z=(0,t.randomBytes)(32,F),j=ie(z);return(0,s.wipe)(z),j}n.generateKeyPair=de;function X(F){if(F.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(F.subarray(32))}n.extractPublicKeyFromSecretKey=X;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(F,z){let j,l,A,ae;for(l=63;l>=32;--l){for(j=0,A=l-32,ae=l-12;A<ae;++A)z[A]+=j-16*z[l]*W[A-(l-32)],j=Math.floor((z[A]+128)/256),z[A]-=j*256;z[A]+=j,z[l]=0}for(j=0,A=0;A<32;A++)z[A]+=j-(z[31]>>4)*W[A],j=z[A]>>8,z[A]&=255;for(A=0;A<32;A++)z[A]-=j*W[A];for(l=0;l<32;l++)z[l+1]+=z[l]>>8,F[l]=z[l]&255}function Z(F){const z=new Float64Array(64);for(let j=0;j<64;j++)z[j]=F[j];for(let j=0;j<64;j++)F[j]=0;Y(F,z)}function Qe(F,z){const j=new Float64Array(64),l=[a(),a(),a(),a()],A=(0,r.hash)(F.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const ae=new Uint8Array(64);ae.set(A.subarray(32),32);const ye=new r.SHA512;ye.update(ae.subarray(32)),ye.update(z);const _e=ye.digest();ye.clean(),Z(_e),C(l,_e),ze(ae,l),ye.reset(),ye.update(ae.subarray(0,32)),ye.update(F.subarray(32)),ye.update(z);const Ce=ye.digest();Z(Ce);for(let De=0;De<32;De++)j[De]=_e[De];for(let De=0;De<32;De++)for(let Pe=0;Pe<32;Pe++)j[De+Pe]+=Ce[De]*A[Pe];return Y(ae.subarray(32),j),ae}n.sign=Qe;function Be(F,z){const j=a(),l=a(),A=a(),ae=a(),ye=a(),_e=a(),Ce=a();return H(F[2],b),m(F[1],z),x(A,F[1]),T(ae,A,O),p(A,A,F[2]),g(ae,F[2],ae),x(ye,ae),x(_e,ye),T(Ce,_e,ye),T(j,Ce,A),T(j,j,ae),se(j,j),T(j,j,A),T(j,j,ae),T(j,j,ae),T(F[0],j,ae),x(l,F[0]),T(l,l,ae),u(l,A)&&T(F[0],F[0],L),x(l,F[0]),T(l,l,ae),u(l,A)?-1:(d(F[0])===z[31]>>7&&p(F[0],y,F[0]),T(F[3],F[0],F[1]),0)}function Br(F,z,j){const l=new Uint8Array(32),A=[a(),a(),a(),a()],ae=[a(),a(),a(),a()];if(j.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(Be(ae,F))return!1;const ye=new r.SHA512;ye.update(j.subarray(0,32)),ye.update(F),ye.update(z);const _e=ye.digest();return Z(_e),S(A,ae,_e),C(ae,j.subarray(32)),pe(A,ae),ze(l,A),!ue(j,l)}n.verify=Br;function Ie(F){let z=[a(),a(),a(),a()];if(Be(z,F))throw new Error("Ed25519: invalid public key");let j=a(),l=a(),A=z[1];g(j,b,A),p(l,b,A),Q(l,l),T(j,j,l);let ae=new Uint8Array(32);return te(ae,j),ae}n.convertPublicKeyToX25519=Ie;function St(F){const z=(0,r.hash)(F.subarray(0,32));z[0]&=248,z[31]&=127,z[31]|=64;const j=new Uint8Array(z.subarray(0,32));return(0,s.wipe)(z),j}n.convertSecretKeyToX25519=St})(nu);const e_="EdDSA",t_="JWT",id=".",nd="base64url",r_="utf8",i_="utf8",n_=":",s_="did",o_="key",Ll="base58btc",a_="z",c_="K36",u_=32;function Ro(n){return Qt(nr(Ji(n),r_),nd)}function sd(n){const t=nr(c_,Ll),r=a_+Qt(Fc([t,n]),Ll);return[s_,o_,r].join(n_)}function h_(n){return Qt(n,nd)}function l_(n){return nr([Ro(n.header),Ro(n.payload)].join(id),i_)}function f_(n){return[Ro(n.header),Ro(n.payload),h_(n.signature)].join(id)}function Ml(n=zo.randomBytes(u_)){return nu.generateKeyPairFromSeed(n)}async function d_(n,t,r,s,a=oe.fromMiliseconds(Date.now())){const h={alg:e_,typ:t_},y=sd(s.publicKey),b=a+r,O={iss:y,sub:n,aud:t,iat:a,exp:b},_=l_({header:h,payload:O}),E=nu.sign(s.secretKey,_);return f_({header:h,payload:O,signature:E})}var cs={};(function(n){const t=Mo,r=qo,s=jo,a=Lo,h=u=>u==null,y=Symbol("encodeFragmentIdentifier");function b(u){switch(u.arrayFormat){case"index":return d=>(m,g)=>{const p=m.length;return g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[",p,"]"].join("")]:[...m,[E(d,u),"[",E(p,u),"]=",E(g,u)].join("")]};case"bracket":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[]"].join("")]:[...m,[E(d,u),"[]=",E(g,u)].join("")];case"colon-list-separator":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),":list="].join("")]:[...m,[E(d,u),":list=",E(g,u)].join("")];case"comma":case"separator":case"bracket-separator":{const d=u.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(g,p)=>p===void 0||u.skipNull&&p===null||u.skipEmptyString&&p===""?g:(p=p===null?"":p,g.length===0?[[E(m,u),d,E(p,u)].join("")]:[[g,E(p,u)].join(u.arrayFormatSeparator)])}default:return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,E(d,u)]:[...m,[E(d,u),"=",E(g,u)].join("")]}}function O(u){let d;switch(u.arrayFormat){case"index":return(m,g,p)=>{if(d=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!d){p[m]=g;return}p[m]===void 0&&(p[m]={}),p[m][d[1]]=g};case"bracket":return(m,g,p)=>{if(d=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"colon-list-separator":return(m,g,p)=>{if(d=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"comma":case"separator":return(m,g,p)=>{const T=typeof g=="string"&&g.includes(u.arrayFormatSeparator),x=typeof g=="string"&&!T&&N(g,u).includes(u.arrayFormatSeparator);g=x?N(g,u):g;const Q=T||x?g.split(u.arrayFormatSeparator).map(se=>N(se,u)):g===null?g:N(g,u);p[m]=Q};case"bracket-separator":return(m,g,p)=>{const T=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!T){p[m]=g&&N(g,u);return}const x=g===null?[]:g.split(u.arrayFormatSeparator).map(Q=>N(Q,u));if(p[m]===void 0){p[m]=x;return}p[m]=[].concat(p[m],x)};default:return(m,g,p)=>{if(p[m]===void 0){p[m]=g;return}p[m]=[].concat(p[m],g)}}}function _(u){if(typeof u!="string"||u.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(u,d){return d.encode?d.strict?t(u):encodeURIComponent(u):u}function N(u,d){return d.decode?r(u):u}function L(u){return Array.isArray(u)?u.sort():typeof u=="object"?L(Object.keys(u)).sort((d,m)=>Number(d)-Number(m)).map(d=>u[d]):u}function H(u){const d=u.indexOf("#");return d!==-1&&(u=u.slice(0,d)),u}function M(u){let d="";const m=u.indexOf("#");return m!==-1&&(d=u.slice(m)),d}function J(u){u=H(u);const d=u.indexOf("?");return d===-1?"":u.slice(d+1)}function te(u,d){return d.parseNumbers&&!Number.isNaN(Number(u))&&typeof u=="string"&&u.trim()!==""?u=Number(u):d.parseBooleans&&u!==null&&(u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(u=u.toLowerCase()==="true"),u}function ue(u,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),_(d.arrayFormatSeparator);const m=O(d),g=Object.create(null);if(typeof u!="string"||(u=u.trim().replace(/^[?#&]/,""),!u))return g;for(const p of u.split("&")){if(p==="")continue;let[T,x]=s(d.decode?p.replace(/\+/g," "):p,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?x:N(x,d),m(N(T,d),x,g)}for(const p of Object.keys(g)){const T=g[p];if(typeof T=="object"&&T!==null)for(const x of Object.keys(T))T[x]=te(T[x],d);else g[p]=te(T,d)}return d.sort===!1?g:(d.sort===!0?Object.keys(g).sort():Object.keys(g).sort(d.sort)).reduce((p,T)=>{const x=g[T];return x&&typeof x=="object"&&!Array.isArray(x)?p[T]=L(x):p[T]=x,p},Object.create(null))}n.extract=J,n.parse=ue,n.stringify=(u,d)=>{if(!u)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),_(d.arrayFormatSeparator);const m=x=>d.skipNull&&h(u[x])||d.skipEmptyString&&u[x]==="",g=b(d),p={};for(const x of Object.keys(u))m(x)||(p[x]=u[x]);const T=Object.keys(p);return d.sort!==!1&&T.sort(d.sort),T.map(x=>{const Q=u[x];return Q===void 0?"":Q===null?E(x,d):Array.isArray(Q)?Q.length===0&&d.arrayFormat==="bracket-separator"?E(x,d)+"[]":Q.reduce(g(x),[]).join("&"):E(x,d)+"="+E(Q,d)}).filter(x=>x.length>0).join("&")},n.parseUrl=(u,d)=>{d=Object.assign({decode:!0},d);const[m,g]=s(u,"#");return Object.assign({url:m.split("?")[0]||"",query:ue(J(u),d)},d&&d.parseFragmentIdentifier&&g?{fragmentIdentifier:N(g,d)}:{})},n.stringifyUrl=(u,d)=>{d=Object.assign({encode:!0,strict:!0,[y]:!0},d);const m=H(u.url).split("?")[0]||"",g=n.extract(u.url),p=n.parse(g,{sort:!1}),T=Object.assign(p,u.query);let x=n.stringify(T,d);x&&(x=`?${x}`);let Q=M(u.url);return u.fragmentIdentifier&&(Q=`#${d[y]?E(u.fragmentIdentifier,d):u.fragmentIdentifier}`),`${m}${x}${Q}`},n.pick=(u,d,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[y]:!1},m);const{url:g,query:p,fragmentIdentifier:T}=n.parseUrl(u,m);return n.stringifyUrl({url:g,query:a(p,d),fragmentIdentifier:T},m)},n.exclude=(u,d,m)=>{const g=Array.isArray(d)?p=>!d.includes(p):(p,T)=>!d(p,T);return n.pick(u,g,m)}})(cs);const od="base10",sr="base16",Bc="base64pad",su="utf8",ad=0,Pn=1,p_=0,ql=1,Vc=12,ou=32;function g_(){const n=Bf.generateKeyPair();return{privateKey:Qt(n.secretKey,sr),publicKey:Qt(n.publicKey,sr)}}function Kc(){const n=zo.randomBytes(ou);return Qt(n,sr)}function y_(n,t){const r=Bf.sharedKey(nr(n,sr),nr(t,sr),!0),s=new Uw(Fo.SHA256,r).expand(ou);return Qt(s,sr)}function m_(n){const t=Fo.hash(nr(n,sr));return Qt(t,sr)}function Wc(n){const t=Fo.hash(nr(n,su));return Qt(t,sr)}function v_(n){return nr(`${n}`,od)}function fs(n){return Number(Qt(n,od))}function w_(n){const t=v_(typeof n.type<"u"?n.type:ad);if(fs(t)===Pn&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?nr(n.senderPublicKey,sr):void 0,s=typeof n.iv<"u"?nr(n.iv,sr):zo.randomBytes(Vc),a=new Vf.ChaCha20Poly1305(nr(n.symKey,sr)).seal(s,nr(n.message,su));return __({type:t,sealed:a,iv:s,senderPublicKey:r})}function b_(n){const t=new Vf.ChaCha20Poly1305(nr(n.symKey,sr)),{sealed:r,iv:s}=Ao(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return Qt(a,su)}function __(n){if(fs(n.type)===Pn){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Qt(Fc([n.type,n.senderPublicKey,n.iv,n.sealed]),Bc)}return Qt(Fc([n.type,n.iv,n.sealed]),Bc)}function Ao(n){const t=nr(n,Bc),r=t.slice(p_,ql),s=ql;if(fs(r)===Pn){const b=s+ou,O=b+Vc,_=t.slice(s,b),E=t.slice(b,O),N=t.slice(O);return{type:r,sealed:N,iv:E,senderPublicKey:_}}const a=s+Vc,h=t.slice(s,a),y=t.slice(a);return{type:r,sealed:y,iv:h}}function E_(n,t){const r=Ao(n);return cd({type:fs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Qt(r.senderPublicKey,sr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function cd(n){const t=(n==null?void 0:n.type)||ad;if(t===Pn){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function zl(n){return n.type===Pn&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var I_=Object.defineProperty,Fl=Object.getOwnPropertySymbols,S_=Object.prototype.hasOwnProperty,x_=Object.prototype.propertyIsEnumerable,Hl=(n,t,r)=>t in n?I_(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,kl=(n,t)=>{for(var r in t||(t={}))S_.call(t,r)&&Hl(n,r,t[r]);if(Fl)for(var r of Fl(t))x_.call(t,r)&&Hl(n,r,t[r]);return n};const P_="ReactNative",kr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},O_="js";function au(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function On(){return!Kf()&&!!Ho()&&navigator.product===P_}function ko(){return!au()&&!!Ho()}function Bo(){return On()?kr.reactNative:au()?kr.node:ko()?kr.browser:kr.unknown}function N_(){var n;try{return On()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function T_(n,t){let r=cs.parse(n);return r=kl(kl({},r),t),n=cs.stringify(r),n}function R_(){if(Bo()===kr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=Ww();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function A_(){var n;const t=Bo();return t===kr.browser?[t,((n=jw())==null?void 0:n.host)||"unknown"].join(":"):t}function C_(n,t,r){const s=R_(),a=A_();return[[n,t].join("-"),[O_,r].join("-"),s,a].join("/")}function $_({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:h,useOnCloseEvent:y,bundleId:b}){const O=r.split("?"),_=C_(n,t,s),E={auth:a,ua:_,projectId:h,useOnCloseEvent:y||void 0,origin:b||void 0},N=T_(O[1]||"",E);return O[0]+"?"+N}function ud(n){return Object.fromEntries(n.entries())}function hd(n){return new Map(Object.entries(n))}function D_(n=oe.FIVE_MINUTES,t){const r=oe.toMiliseconds(n||oe.FIVE_MINUTES);let s,a,h;return{resolve:y=>{h&&s&&(clearTimeout(h),s(y))},reject:y=>{h&&a&&(clearTimeout(h),a(y))},done:()=>new Promise((y,b)=>{h=setTimeout(()=>{b(new Error(t))},r),s=y,a=b})}}function us(n,t,r){return new Promise(async(s,a)=>{const h=setTimeout(()=>a(new Error(r)),t);try{const y=await n;s(y)}catch(y){a(y)}clearTimeout(h)})}function ld(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function U_(n){return ld("topic",n)}function j_(n){return ld("id",n)}function L_(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Oo(n,t){return oe.fromMiliseconds((t||Date.now())+oe.toMiliseconds(n))}function Bl(n){return Date.now()>=oe.toMiliseconds(n)}function Oc(n,t){return`${n}${t?`:${t}`:""}`}const M_="irn";function Gc(n){return(n==null?void 0:n.relay)||{protocol:M_}}function No(n){const t=Xw[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var q_=Object.defineProperty,Vl=Object.getOwnPropertySymbols,z_=Object.prototype.hasOwnProperty,F_=Object.prototype.propertyIsEnumerable,Kl=(n,t,r)=>t in n?q_(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,H_=(n,t)=>{for(var r in t||(t={}))z_.call(t,r)&&Kl(n,r,t[r]);if(Vl)for(var r of Vl(t))F_.call(t,r)&&Kl(n,r,t[r]);return n};function k_(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const h=a.replace(s,""),y=n[a];r[h]=y}}),r}function Wl(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),h=typeof r<"u"?n.substring(r):"",y=cs.parse(h);return{protocol:s,topic:B_(a[0]),version:parseInt(a[1],10),symKey:y.symKey,relay:k_(y)}}function B_(n){return n.startsWith("//")?n.substring(2):n}function V_(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const h=r+t+a;n[a]&&(s[h]=n[a])}),s}function K_(n){return`${n.protocol}:${n.topic}@${n.version}?`+cs.stringify(H_({symKey:n.symKey},V_(n.relay)))}const W_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},G_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ke(n,t){const{message:r,code:s}=G_[n];return{message:t?`${r} ${t}`:r,code:s}}function rs(n,t){const{message:r,code:s}=W_[n];return{message:t?`${r} ${t}`:r,code:s}}function J_(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function Co(n){return typeof n>"u"}function fd(n,t){return t&&Co(n)?!0:typeof n=="string"&&!!n.trim().length}function Q_(n){if(fd(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Y_(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function X_(n){return n==null?void 0:n.topic}function Nc(n){return typeof n<"u"&&typeof n!==null}function Gl(){const n=Bo();return new Promise(t=>{switch(n){case kr.browser:t(Z_());break;case kr.reactNative:t(e1());break;case kr.node:t(t1());break;default:t(!0)}})}function Z_(){return ko()&&(navigator==null?void 0:navigator.onLine)}async function e1(){if(On()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function t1(){return!0}function r1(n){switch(Bo()){case kr.browser:i1(n);break;case kr.reactNative:n1(n);break}}function i1(n){!On()&&ko()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function n1(n){On()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const s1="PARSE_ERROR",o1="INVALID_REQUEST",a1="METHOD_NOT_FOUND",c1="INVALID_PARAMS",dd="INTERNAL_ERROR",cu="SERVER_ERROR",u1=[-32700,-32600,-32601,-32602,-32603],os={[s1]:{code:-32700,message:"Parse error"},[o1]:{code:-32600,message:"Invalid Request"},[a1]:{code:-32601,message:"Method not found"},[c1]:{code:-32602,message:"Invalid params"},[dd]:{code:-32603,message:"Internal error"},[cu]:{code:-32e3,message:"Server error"}},pd=cu;function h1(n){return u1.includes(n)}function Jl(n){return Object.keys(os).includes(n)?os[n]:os[pd]}function l1(n){const t=Object.values(os).find(r=>r.code===n);return t||os[pd]}function gd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var yd={},hi={},Ql;function f1(){if(Ql)return hi;Ql=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.isBrowserCryptoAvailable=hi.getSubtleCrypto=hi.getBrowerCrypto=void 0;function n(){return(Hr===null||Hr===void 0?void 0:Hr.crypto)||(Hr===null||Hr===void 0?void 0:Hr.msCrypto)||{}}hi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}hi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return hi.isBrowserCryptoAvailable=r,hi}var li={},Yl;function d1(){if(Yl)return li;Yl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowser=li.isNode=li.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}li.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}li.isNode=t;function r(){return!n()&&!t()}return li.isBrowser=r,li}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Sn;t.__exportStar(f1(),n),t.__exportStar(d1(),n)})(yd);function uu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function md(n=6){return BigInt(uu(n))}function In(n,t,r){return{id:r||uu(),jsonrpc:"2.0",method:n,params:t}}function hu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Vo(n,t,r){return{id:n,jsonrpc:"2.0",error:p1(t,r)}}function p1(n,t){return typeof n>"u"?Jl(dd):(typeof n=="string"&&(n=Object.assign(Object.assign({},Jl(cu)),{message:n})),typeof t<"u"&&(n.data=t),h1(n.code)&&(n=l1(n.code)),n)}class g1{}class y1 extends g1{constructor(){super()}}class m1 extends y1{constructor(t){super()}}const v1="^https?:",w1="^wss?:";function b1(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function vd(n,t){const r=b1(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Xl(n){return vd(n,v1)}function Zl(n){return vd(n,w1)}function _1(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function wd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function lu(n){return wd(n)&&"method"in n}function Ko(n){return wd(n)&&(pi(n)||Fr(n))}function pi(n){return"result"in n}function Fr(n){return"error"in n}class gi extends m1{constructor(t){super(t),this.events=new Cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(In(t.method,t.params||[],t.id||md().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(h){a(h)}this.events.on(`${t.id}`,h=>{Fr(h)?a(h.error):s(h.result)});try{await this.connection.send(t,r)}catch(h){a(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ko(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const E1=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),I1=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ef=n=>n.split("?")[0],tf=10,S1=E1();let x1=class{constructor(t){if(this.url=t,this.events=new Cr.EventEmitter,this.registering=!1,!Zl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ji(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Zl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),h=yd.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!_1(t)},y=new S1(t,[],h);I1()?y.onerror=b=>{const O=b;s(this.emitError(O.error))}:y.on("error",b=>{s(this.emitError(b))}),y.onopen=()=>{this.onOpen(y),r(y)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ls(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Vo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return gd(t,ef(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>tf&&this.events.setMaxListeners(tf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${ef(this.url)}`));return this.events.emit("register_error",r),r}};var $o={exports:{}};$o.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,h=2,y=9007199254740991,b="[object Arguments]",O="[object Array]",_="[object AsyncFunction]",E="[object Boolean]",N="[object Date]",L="[object Error]",H="[object Function]",M="[object GeneratorFunction]",J="[object Map]",te="[object Number]",ue="[object Null]",u="[object Object]",d="[object Promise]",m="[object Proxy]",g="[object RegExp]",p="[object Set]",T="[object String]",x="[object Symbol]",Q="[object Undefined]",se="[object WeakMap]",pe="[object ArrayBuffer]",Ae="[object DataView]",ze="[object Float32Array]",S="[object Float64Array]",C="[object Int8Array]",ie="[object Int16Array]",de="[object Int32Array]",X="[object Uint8Array]",W="[object Uint8ClampedArray]",Y="[object Uint16Array]",Z="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,Br=/^(?:0|[1-9]\d*)$/,Ie={};Ie[ze]=Ie[S]=Ie[C]=Ie[ie]=Ie[de]=Ie[X]=Ie[W]=Ie[Y]=Ie[Z]=!0,Ie[b]=Ie[O]=Ie[pe]=Ie[E]=Ie[Ae]=Ie[N]=Ie[L]=Ie[H]=Ie[J]=Ie[te]=Ie[u]=Ie[g]=Ie[p]=Ie[T]=Ie[se]=!1;var St=typeof Hr=="object"&&Hr&&Hr.Object===Object&&Hr,F=typeof self=="object"&&self&&self.Object===Object&&self,z=St||F||Function("return this")(),j=t&&!t.nodeType&&t,l=j&&!0&&n&&!n.nodeType&&n,A=l&&l.exports===j,ae=A&&St.process,ye=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),_e=ye&&ye.isTypedArray;function Ce(I,$){for(var K=-1,re=I==null?0:I.length,We=0,ve=[];++K<re;){var tt=I[K];$(tt,K,I)&&(ve[We++]=tt)}return ve}function De(I,$){for(var K=-1,re=$.length,We=I.length;++K<re;)I[We+K]=$[K];return I}function Pe(I,$){for(var K=-1,re=I==null?0:I.length;++K<re;)if($(I[K],K,I))return!0;return!1}function xt(I,$){for(var K=-1,re=Array(I);++K<I;)re[K]=$(K);return re}function wt(I){return function($){return I($)}}function at(I,$){return I.has($)}function je(I,$){return I==null?void 0:I[$]}function Xe(I){var $=-1,K=Array(I.size);return I.forEach(function(re,We){K[++$]=[We,re]}),K}function Ze(I,$){return function(K){return I($(K))}}function ct(I){var $=-1,K=Array(I.size);return I.forEach(function(re){K[++$]=re}),K}var Fe=Array.prototype,et=Function.prototype,$e=Object.prototype,Ve=z["__core-js_shared__"],lt=et.toString,Me=$e.hasOwnProperty,Pt=function(){var I=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return I?"Symbol(src)_1."+I:""}(),Dt=$e.toString,Ft=RegExp("^"+lt.call(Me).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=A?z.Buffer:void 0,Lt=z.Symbol,Yt=z.Uint8Array,or=$e.propertyIsEnumerable,Vr=Fe.splice,Xt=Lt?Lt.toStringTag:void 0,Xr=Object.getOwnPropertySymbols,mi=Ht?Ht.isBuffer:void 0,Ai=Ze(Object.keys,Object),ft=pr(z,"DataView"),it=pr(z,"Map"),dt=pr(z,"Promise"),pt=pr(z,"Set"),ut=pr(z,"WeakMap"),nt=pr(Object,"create"),Ot=ei(ft),Nt=ei(it),gt=ei(dt),Tt=ei(pt),yt=ei(ut),bt=Lt?Lt.prototype:void 0,mt=bt?bt.valueOf:void 0;function Ye(I){var $=-1,K=I==null?0:I.length;for(this.clear();++$<K;){var re=I[$];this.set(re[0],re[1])}}function Rt(){this.__data__=nt?nt(null):{},this.size=0}function At(I){var $=this.has(I)&&delete this.__data__[I];return this.size-=$?1:0,$}function Qo(I){var $=this.__data__;if(nt){var K=$[I];return K===s?void 0:K}return Me.call($,I)?$[I]:void 0}function Yo(I){var $=this.__data__;return nt?$[I]!==void 0:Me.call($,I)}function Xo(I,$){var K=this.__data__;return this.size+=this.has(I)?0:1,K[I]=nt&&$===void 0?s:$,this}Ye.prototype.clear=Rt,Ye.prototype.delete=At,Ye.prototype.get=Qo,Ye.prototype.has=Yo,Ye.prototype.set=Xo;function _r(I){var $=-1,K=I==null?0:I.length;for(this.clear();++$<K;){var re=I[$];this.set(re[0],re[1])}}function Zo(){this.__data__=[],this.size=0}function ea(I){var $=this.__data__,K=Ci($,I);if(K<0)return!1;var re=$.length-1;return K==re?$.pop():Vr.call($,K,1),--this.size,!0}function ta(I){var $=this.__data__,K=Ci($,I);return K<0?void 0:$[K][1]}function ra(I){return Ci(this.__data__,I)>-1}function ia(I,$){var K=this.__data__,re=Ci(K,I);return re<0?(++this.size,K.push([I,$])):K[re][1]=$,this}_r.prototype.clear=Zo,_r.prototype.delete=ea,_r.prototype.get=ta,_r.prototype.has=ra,_r.prototype.set=ia;function Zr(I){var $=-1,K=I==null?0:I.length;for(this.clear();++$<K;){var re=I[$];this.set(re[0],re[1])}}function Zi(){this.size=0,this.__data__={hash:new Ye,map:new(it||_r),string:new Ye}}function na(I){var $=vi(this,I).delete(I);return this.size-=$?1:0,$}function en(I){return vi(this,I).get(I)}function sa(I){return vi(this,I).has(I)}function oa(I,$){var K=vi(this,I),re=K.size;return K.set(I,$),this.size+=K.size==re?0:1,this}Zr.prototype.clear=Zi,Zr.prototype.delete=na,Zr.prototype.get=en,Zr.prototype.has=sa,Zr.prototype.set=oa;function tn(I){var $=-1,K=I==null?0:I.length;for(this.__data__=new Zr;++$<K;)this.add(I[$])}function ps(I){return this.__data__.set(I,s),this}function gs(I){return this.__data__.has(I)}tn.prototype.add=tn.prototype.push=ps,tn.prototype.has=gs;function $r(I){var $=this.__data__=new _r(I);this.size=$.size}function aa(){this.__data__=new _r,this.size=0}function ca(I){var $=this.__data__,K=$.delete(I);return this.size=$.size,K}function ua(I){return this.__data__.get(I)}function ha(I){return this.__data__.has(I)}function ys(I,$){var K=this.__data__;if(K instanceof _r){var re=K.__data__;if(!it||re.length<r-1)return re.push([I,$]),this.size=++K.size,this;K=this.__data__=new Zr(re)}return K.set(I,$),this.size=K.size,this}$r.prototype.clear=aa,$r.prototype.delete=ca,$r.prototype.get=ua,$r.prototype.has=ha,$r.prototype.set=ys;function ms(I,$){var K=sn(I),re=!K&&Ts(I),We=!K&&!re&&An(I),ve=!K&&!re&&!We&&Cs(I),tt=K||re||We||ve,Ct=tt?xt(I.length,String):[],Ne=Ct.length;for(var Ge in I)($||Me.call(I,Ge))&&!(tt&&(Ge=="length"||We&&(Ge=="offset"||Ge=="parent")||ve&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Ss(Ge,Ne)))&&Ct.push(Ge);return Ct}function Ci(I,$){for(var K=I.length;K--;)if(Ns(I[K][0],$))return K;return-1}function Tn(I,$,K){var re=$(I);return sn(I)?re:De(re,K(I))}function $i(I){return I==null?I===void 0?Q:ue:Xt&&Xt in Object(I)?Es(I):da(I)}function Rn(I){return Ui(I)&&$i(I)==b}function Di(I,$,K,re,We){return I===$?!0:I==null||$==null||!Ui(I)&&!Ui($)?I!==I&&$!==$:vs(I,$,K,re,Di,We)}function vs(I,$,K,re,We,ve){var tt=sn(I),Ct=sn($),Ne=tt?O:Kr(I),Ge=Ct?O:Kr($);Ne=Ne==b?u:Ne,Ge=Ge==b?u:Ge;var _t=Ne==u,ar=Ge==u,$t=Ne==Ge;if($t&&An(I)){if(!An($))return!1;tt=!0,_t=!1}if($t&&!_t)return ve||(ve=new $r),tt||Cs(I)?rn(I,$,K,re,We,ve):fa(I,$,Ne,K,re,We,ve);if(!(K&a)){var rt=_t&&Me.call(I,"__wrapped__"),Zt=ar&&Me.call($,"__wrapped__");if(rt||Zt){var Dr=rt?I.value():I,Er=Zt?$.value():$;return ve||(ve=new $r),We(Dr,Er,K,re,ve)}}return $t?(ve||(ve=new $r),_s(I,$,K,re,We,ve)):!1}function la(I){if(!As(I)||Ps(I))return!1;var $=on(I)?Ft:Be;return $.test(ei(I))}function ws(I){return Ui(I)&&Rs(I.length)&&!!Ie[$i(I)]}function bs(I){if(!Os(I))return Ai(I);var $=[];for(var K in Object(I))Me.call(I,K)&&K!="constructor"&&$.push(K);return $}function rn(I,$,K,re,We,ve){var tt=K&a,Ct=I.length,Ne=$.length;if(Ct!=Ne&&!(tt&&Ne>Ct))return!1;var Ge=ve.get(I);if(Ge&&ve.get($))return Ge==$;var _t=-1,ar=!0,$t=K&h?new tn:void 0;for(ve.set(I,$),ve.set($,I);++_t<Ct;){var rt=I[_t],Zt=$[_t];if(re)var Dr=tt?re(Zt,rt,_t,$,I,ve):re(rt,Zt,_t,I,$,ve);if(Dr!==void 0){if(Dr)continue;ar=!1;break}if($t){if(!Pe($,function(Er,Wr){if(!at($t,Wr)&&(rt===Er||We(rt,Er,K,re,ve)))return $t.push(Wr)})){ar=!1;break}}else if(!(rt===Zt||We(rt,Zt,K,re,ve))){ar=!1;break}}return ve.delete(I),ve.delete($),ar}function fa(I,$,K,re,We,ve,tt){switch(K){case Ae:if(I.byteLength!=$.byteLength||I.byteOffset!=$.byteOffset)return!1;I=I.buffer,$=$.buffer;case pe:return!(I.byteLength!=$.byteLength||!ve(new Yt(I),new Yt($)));case E:case N:case te:return Ns(+I,+$);case L:return I.name==$.name&&I.message==$.message;case g:case T:return I==$+"";case J:var Ct=Xe;case p:var Ne=re&a;if(Ct||(Ct=ct),I.size!=$.size&&!Ne)return!1;var Ge=tt.get(I);if(Ge)return Ge==$;re|=h,tt.set(I,$);var _t=rn(Ct(I),Ct($),re,We,ve,tt);return tt.delete(I),_t;case x:if(mt)return mt.call(I)==mt.call($)}return!1}function _s(I,$,K,re,We,ve){var tt=K&a,Ct=nn(I),Ne=Ct.length,Ge=nn($),_t=Ge.length;if(Ne!=_t&&!tt)return!1;for(var ar=Ne;ar--;){var $t=Ct[ar];if(!(tt?$t in $:Me.call($,$t)))return!1}var rt=ve.get(I);if(rt&&ve.get($))return rt==$;var Zt=!0;ve.set(I,$),ve.set($,I);for(var Dr=tt;++ar<Ne;){$t=Ct[ar];var Er=I[$t],Wr=$[$t];if(re)var Cn=tt?re(Wr,Er,$t,$,I,ve):re(Er,Wr,$t,I,$,ve);if(!(Cn===void 0?Er===Wr||We(Er,Wr,K,re,ve):Cn)){Zt=!1;break}Dr||(Dr=$t=="constructor")}if(Zt&&!Dr){var ji=I.constructor,Mt=$.constructor;ji!=Mt&&"constructor"in I&&"constructor"in $&&!(typeof ji=="function"&&ji instanceof ji&&typeof Mt=="function"&&Mt instanceof Mt)&&(Zt=!1)}return ve.delete(I),ve.delete($),Zt}function nn(I){return Tn(I,ya,Is)}function vi(I,$){var K=I.__data__;return xs($)?K[typeof $=="string"?"string":"hash"]:K.map}function pr(I,$){var K=je(I,$);return la(K)?K:void 0}function Es(I){var $=Me.call(I,Xt),K=I[Xt];try{I[Xt]=void 0;var re=!0}catch{}var We=Dt.call(I);return re&&($?I[Xt]=K:delete I[Xt]),We}var Is=Xr?function(I){return I==null?[]:(I=Object(I),Ce(Xr(I),function($){return or.call(I,$)}))}:Ke,Kr=$i;(ft&&Kr(new ft(new ArrayBuffer(1)))!=Ae||it&&Kr(new it)!=J||dt&&Kr(dt.resolve())!=d||pt&&Kr(new pt)!=p||ut&&Kr(new ut)!=se)&&(Kr=function(I){var $=$i(I),K=$==u?I.constructor:void 0,re=K?ei(K):"";if(re)switch(re){case Ot:return Ae;case Nt:return J;case gt:return d;case Tt:return p;case yt:return se}return $});function Ss(I,$){return $=$??y,!!$&&(typeof I=="number"||Br.test(I))&&I>-1&&I%1==0&&I<$}function xs(I){var $=typeof I;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?I!=="__proto__":I===null}function Ps(I){return!!Pt&&Pt in I}function Os(I){var $=I&&I.constructor,K=typeof $=="function"&&$.prototype||$e;return I===K}function da(I){return Dt.call(I)}function ei(I){if(I!=null){try{return lt.call(I)}catch{}try{return I+""}catch{}}return""}function Ns(I,$){return I===$||I!==I&&$!==$}var Ts=Rn(function(){return arguments}())?Rn:function(I){return Ui(I)&&Me.call(I,"callee")&&!or.call(I,"callee")},sn=Array.isArray;function pa(I){return I!=null&&Rs(I.length)&&!on(I)}var An=mi||He;function ga(I,$){return Di(I,$)}function on(I){if(!As(I))return!1;var $=$i(I);return $==H||$==M||$==_||$==m}function Rs(I){return typeof I=="number"&&I>-1&&I%1==0&&I<=y}function As(I){var $=typeof I;return I!=null&&($=="object"||$=="function")}function Ui(I){return I!=null&&typeof I=="object"}var Cs=_e?wt(_e):ws;function ya(I){return pa(I)?ms(I):bs(I)}function Ke(){return[]}function He(){return!1}n.exports=ga})($o,$o.exports);var P1=$o.exports;const O1=Wf(P1);var N1={};function T1(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var h=n.charAt(a),y=h.charCodeAt(0);if(r[y]!==255)throw new TypeError(h+" is ambiguous");r[y]=a}var b=n.length,O=n.charAt(0),_=Math.log(b)/Math.log(256),E=Math.log(256)/Math.log(b);function N(M){if(M instanceof Uint8Array||(ArrayBuffer.isView(M)?M=new Uint8Array(M.buffer,M.byteOffset,M.byteLength):Array.isArray(M)&&(M=Uint8Array.from(M))),!(M instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(M.length===0)return"";for(var J=0,te=0,ue=0,u=M.length;ue!==u&&M[ue]===0;)ue++,J++;for(var d=(u-ue)*E+1>>>0,m=new Uint8Array(d);ue!==u;){for(var g=M[ue],p=0,T=d-1;(g!==0||p<te)&&T!==-1;T--,p++)g+=256*m[T]>>>0,m[T]=g%b>>>0,g=g/b>>>0;if(g!==0)throw new Error("Non-zero carry");te=p,ue++}for(var x=d-te;x!==d&&m[x]===0;)x++;for(var Q=O.repeat(J);x<d;++x)Q+=n.charAt(m[x]);return Q}function L(M){if(typeof M!="string")throw new TypeError("Expected String");if(M.length===0)return new Uint8Array;var J=0;if(M[J]!==" "){for(var te=0,ue=0;M[J]===O;)te++,J++;for(var u=(M.length-J)*_+1>>>0,d=new Uint8Array(u);M[J];){var m=r[M.charCodeAt(J)];if(m===255)return;for(var g=0,p=u-1;(m!==0||g<ue)&&p!==-1;p--,g++)m+=b*d[p]>>>0,d[p]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");ue=g,J++}if(M[J]!==" "){for(var T=u-ue;T!==u&&d[T]===0;)T++;for(var x=new Uint8Array(te+(u-T)),Q=te;T!==u;)x[Q++]=d[T++];return x}}}function H(M){var J=L(M);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:N,decodeUnsafe:L,decode:H}}var R1=T1,A1=R1;const bd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},C1=n=>new TextEncoder().encode(n),$1=n=>new TextDecoder().decode(n);class D1{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class U1{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return _d(this,t)}}let j1=class{constructor(t){this.decoders=t}or(t){return _d(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const _d=(n,t)=>new j1({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class L1{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new D1(t,r,s),this.decoder=new U1(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Wo=({name:n,prefix:t,encode:r,decode:s})=>new L1(n,t,r,s),ds=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=A1(r,t);return Wo({prefix:n,name:t,encode:s,decode:h=>bd(a(h))})},M1=(n,t,r,s)=>{const a={};for(let E=0;E<t.length;++E)a[t[E]]=E;let h=n.length;for(;n[h-1]==="=";)--h;const y=new Uint8Array(h*r/8|0);let b=0,O=0,_=0;for(let E=0;E<h;++E){const N=a[n[E]];if(N===void 0)throw new SyntaxError(`Non-${s} character`);O=O<<r|N,b+=r,b>=8&&(b-=8,y[_++]=255&O>>b)}if(b>=r||255&O<<8-b)throw new SyntaxError("Unexpected end of data");return y},q1=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let h="",y=0,b=0;for(let O=0;O<n.length;++O)for(b=b<<8|n[O],y+=8;y>r;)y-=r,h+=t[a&b>>y];if(y&&(h+=t[a&b<<r-y]),s)for(;h.length*r&7;)h+="=";return h},Vt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Wo({prefix:t,name:n,encode(a){return q1(a,s,r)},decode(a){return M1(a,s,r,n)}}),z1=Wo({prefix:"\0",name:"identity",encode:n=>$1(n),decode:n=>C1(n)});var F1=Object.freeze({__proto__:null,identity:z1});const H1=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var k1=Object.freeze({__proto__:null,base2:H1});const B1=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var V1=Object.freeze({__proto__:null,base8:B1});const K1=ds({prefix:"9",name:"base10",alphabet:"0123456789"});var W1=Object.freeze({__proto__:null,base10:K1});const G1=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),J1=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Q1=Object.freeze({__proto__:null,base16:G1,base16upper:J1});const Y1=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),X1=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Z1=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eE=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tE=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rE=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iE=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nE=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sE=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var oE=Object.freeze({__proto__:null,base32:Y1,base32upper:X1,base32pad:Z1,base32padupper:eE,base32hex:tE,base32hexupper:rE,base32hexpad:iE,base32hexpadupper:nE,base32z:sE});const aE=ds({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cE=ds({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var uE=Object.freeze({__proto__:null,base36:aE,base36upper:cE});const hE=ds({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lE=ds({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var fE=Object.freeze({__proto__:null,base58btc:hE,base58flickr:lE});const dE=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),pE=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),gE=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),yE=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var mE=Object.freeze({__proto__:null,base64:dE,base64pad:pE,base64url:gE,base64urlpad:yE});const Ed=Array.from(""),vE=Ed.reduce((n,t,r)=>(n[r]=t,n),[]),wE=Ed.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function bE(n){return n.reduce((t,r)=>(t+=vE[r],t),"")}function _E(n){const t=[];for(const r of n){const s=wE[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const EE=Wo({prefix:"",name:"base256emoji",encode:bE,decode:_E});var IE=Object.freeze({__proto__:null,base256emoji:EE}),SE=Id,rf=128,xE=127,PE=~xE,OE=Math.pow(2,31);function Id(n,t,r){t=t||[],r=r||0;for(var s=r;n>=OE;)t[r++]=n&255|rf,n/=128;for(;n&PE;)t[r++]=n&255|rf,n>>>=7;return t[r]=n|0,Id.bytes=r-s+1,t}var NE=Jc,TE=128,nf=127;function Jc(n,s){var r=0,s=s||0,a=0,h=s,y,b=n.length;do{if(h>=b)throw Jc.bytes=0,new RangeError("Could not decode varint");y=n[h++],r+=a<28?(y&nf)<<a:(y&nf)*Math.pow(2,a),a+=7}while(y>=TE);return Jc.bytes=h-s,r}var RE=Math.pow(2,7),AE=Math.pow(2,14),CE=Math.pow(2,21),$E=Math.pow(2,28),DE=Math.pow(2,35),UE=Math.pow(2,42),jE=Math.pow(2,49),LE=Math.pow(2,56),ME=Math.pow(2,63),qE=function(n){return n<RE?1:n<AE?2:n<CE?3:n<$E?4:n<DE?5:n<UE?6:n<jE?7:n<LE?8:n<ME?9:10},zE={encode:SE,decode:NE,encodingLength:qE},Sd=zE;const sf=(n,t,r=0)=>(Sd.encode(n,t,r),t),of=n=>Sd.encodingLength(n),Qc=(n,t)=>{const r=t.byteLength,s=of(n),a=s+of(r),h=new Uint8Array(a+r);return sf(n,h,0),sf(r,h,s),h.set(t,a),new FE(n,r,t,h)};let FE=class{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}};const xd=({name:n,code:t,encode:r})=>new HE(n,t,r);class HE{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Qc(this.code,r):r.then(s=>Qc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Pd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),kE=xd({name:"sha2-256",code:18,encode:Pd("SHA-256")}),BE=xd({name:"sha2-512",code:19,encode:Pd("SHA-512")});var VE=Object.freeze({__proto__:null,sha256:kE,sha512:BE});const Od=0,KE="identity",Nd=bd,WE=n=>Qc(Od,Nd(n)),GE={code:Od,name:KE,encode:Nd,digest:WE};var JE=Object.freeze({__proto__:null,identity:GE});new TextEncoder,new TextDecoder;const af={...F1,...k1,...V1,...W1,...Q1,...oE,...uE,...fE,...mE,...IE};({...VE,...JE});function Td(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function QE(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Td(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Rd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const cf=Rd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Tc=Rd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=QE(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),YE={utf8:cf,"utf-8":cf,hex:af.base16,latin1:Tc,ascii:Tc,binary:Tc,...af};function XE(n,t="utf8"){const r=YE[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Td(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Ad="wc",ZE=2,fu="core",Ni=`${Ad}@2:${fu}:`,eI={name:fu,logger:"error"},tI={database:":memory:"},rI="crypto",uf="client_ed25519_seed",iI=oe.ONE_DAY,nI="keychain",sI="0.3",oI="messages",aI="0.3",cI=oe.SIX_HOURS,uI="publisher",Cd="irn",hI="error",$d="wss://relay.walletconnect.com",hf="wss://relay.walletconnect.org",lI="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},fI="_subscription",fi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},dI=oe.ONE_SECOND,pI="2.10.6",gI=1e4,yI="0.3",mI="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},vI="subscription",wI="0.3",bI=oe.FIVE_SECONDS*1e3,_I="pairing",EI="0.3",Qn={wc_pairingDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:0},res:{ttl:oe.ONE_DAY,prompt:!1,tag:0}}},is={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},II="history",SI="0.3",xI="expirer",Rr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},PI="0.3",Rc="verify-api",_n="https://verify.walletconnect.com",Yc="https://verify.walletconnect.org",OI=[_n,Yc];class NI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=nI,this.version=sI,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:h}=ke("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(h)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,ud(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?hd(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}}class TI{constructor(t,r,s){this.core=t,this.logger=r,this.name=rI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),h=Ml(a);return sd(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=g_();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const h=await this.getClientSeed(),y=Ml(h),b=Kc();return await d_(b,a,iI,y)},this.generateSharedKey=(a,h,y)=>{this.isInitialized();const b=this.getPrivateKey(a),O=y_(b,h);return this.setSymKey(O,y)},this.setSymKey=async(a,h)=>{this.isInitialized();const y=h||m_(a);return await this.keychain.set(y,a),y},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,h,y)=>{this.isInitialized();const b=cd(y),O=Ji(h);if(zl(b)){const L=b.senderPublicKey,H=b.receiverPublicKey;a=await this.generateSharedKey(L,H)}const _=this.getSymKey(a),{type:E,senderPublicKey:N}=b;return w_({type:E,symKey:_,message:O,senderPublicKey:N})},this.decode=async(a,h,y)=>{this.isInitialized();const b=E_(h,y);if(zl(b)){const O=b.receiverPublicKey,_=b.senderPublicKey;a=await this.generateSharedKey(O,_)}try{const O=this.getSymKey(a),_=b_({symKey:O,encoded:h});return ls(_)}catch(O){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(O)}},this.getPayloadType=a=>{const h=Ao(a);return fs(h.type)},this.getPayloadSenderPublicKey=a=>{const h=Ao(a);return h.senderPublicKey?Qt(h.senderPublicKey,sr):void 0},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=s||new NI(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(uf)}catch{t=Kc(),await this.keychain.set(uf,t)}return XE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}}class RI extends Vb{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=oI,this.version=aI,this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const h=Wc(a);let y=this.messages.get(s);return typeof y>"u"&&(y={}),typeof y[h]<"u"||(y[h]=a,this.messages.set(s,y),await this.persist()),h},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const h=this.get(s),y=Wc(a);return typeof h[y]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,ud(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?hd(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}}class AI extends Kb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Cr.EventEmitter,this.name=uI,this.queue=new Map,this.publishTimeout=oe.toMiliseconds(oe.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,h)=>{var y;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}});try{const b=(h==null?void 0:h.ttl)||cI,O=Gc(h),_=(h==null?void 0:h.prompt)||!1,E=(h==null?void 0:h.tag)||0,N=(h==null?void 0:h.id)||md().toString(),L={topic:s,message:a,opts:{ttl:b,relay:O,prompt:_,tag:E,id:N}},H=setTimeout(()=>this.queue.set(N,L),this.publishTimeout);try{await await us(this.rpcPublish(s,a,b,O,_,E,N),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(N),this.relayer.events.emit(Gt.publish,L)}catch(M){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(y=h==null?void 0:h.internal)!=null&&y.throwOnFailedPublish)throw this.removeRequestFromQueue(N),M;return}finally{clearTimeout(H)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:h}})}catch(b){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(b),b}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,h,y,b){var O,_,E,N;const L={method:No(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:h,tag:y},id:b};return Co((O=L.params)==null?void 0:O.prompt)&&((_=L.params)==null||delete _.prompt),Co((E=L.params)==null?void 0:E.tag)&&((N=L.params)==null||delete N.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:L}),this.relayer.request(L)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class CI{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(h=>h!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var $I=Object.defineProperty,DI=Object.defineProperties,UI=Object.getOwnPropertyDescriptors,lf=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,LI=Object.prototype.propertyIsEnumerable,ff=(n,t,r)=>t in n?$I(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Yn=(n,t)=>{for(var r in t||(t={}))jI.call(t,r)&&ff(n,r,t[r]);if(lf)for(var r of lf(t))LI.call(t,r)&&ff(n,r,t[r]);return n},Ac=(n,t)=>DI(n,UI(t));class MI extends Jb{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new CI,this.events=new Cr.EventEmitter,this.name=vI,this.version=wI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ni,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const h=Gc(a),y={topic:s,relay:h};this.pending.set(s,y);const b=await this.rpcSubscribe(s,h);return this.onSubscribe(b,y),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),b}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,h)=>{const y=new oe.Watch;y.start(this.pendingSubscriptionWatchLabel);const b=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(b),y.stop(this.pendingSubscriptionWatchLabel),a(!0)),y.elapsed(this.pendingSubscriptionWatchLabel)>=bI&&(clearInterval(b),y.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.clientId=""}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Gc(s);await this.rpcUnsubscribe(t,r,a);const h=rs("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:No(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await us(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return Wc(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:No(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await us(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:No(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Ac(Yn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Yn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Yn({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=ke("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(zr.deleted,Ac(Yn({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=ke("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);J_(r)&&this.onBatchSubscribe(r.map((s,a)=>Ac(Yn({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var qI=Object.defineProperty,df=Object.getOwnPropertySymbols,zI=Object.prototype.hasOwnProperty,FI=Object.prototype.propertyIsEnumerable,pf=(n,t,r)=>t in n?qI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,HI=(n,t)=>{for(var r in t||(t={}))zI.call(t,r)&&pf(n,r,t[r]);if(df)for(var r of df(t))FI.call(t,r)&&pf(n,r,t[r]);return n};class kI extends Wb{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Cr.EventEmitter,this.name=lI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fi.payload,this.onPayloadHandler),this.provider.on(fi.connect,this.onConnectHandler),this.provider.on(fi.disconnect,this.onDisconnectHandler),this.provider.on(fi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):Re.pino(Re.getDefaultLoggerOptions({level:t.logger||hI})),this.messages=new RI(this.logger,t.core),this.subscriber=new MI(this,this.logger),this.publisher=new AI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||$d,this.projectId=t.projectId,this.bundleId=N_(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${hf}...`),await this.restartTransport(hf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},gI)}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let h;const y=b=>{b.topic===t&&(this.subscriber.off(zr.created,y),h())};return await Promise.all([new Promise(b=>{h=b,this.subscriber.on(zr.created,y)}),new Promise(async b=>{a=await this.subscriber.subscribe(t,r),b()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await us(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await us(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(fi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Gl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new gi(new x1($_({sdkVersion:pI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),lu(t)){if(!t.method.endsWith(fI))return;const r=t.params,{topic:s,message:a,publishedAt:h}=r.data,y={topic:s,message:a,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(HI({type:"event",event:r.id},y)),this.events.emit(r.id,y),await this.acknowledgePayload(t),await this.onMessageEvent(y)}else Ko(t)&&this.events.emit(Gt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Gt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=hu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fi.payload,this.onPayloadHandler),this.provider.off(fi.connect,this.onConnectHandler),this.provider.off(fi.disconnect,this.onDisconnectHandler),this.provider.off(fi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Gl();r1(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},oe.toMiliseconds(dI)))}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var BI=Object.defineProperty,gf=Object.getOwnPropertySymbols,VI=Object.prototype.hasOwnProperty,KI=Object.prototype.propertyIsEnumerable,yf=(n,t,r)=>t in n?BI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,mf=(n,t)=>{for(var r in t||(t={}))VI.call(t,r)&&yf(n,r,t[r]);if(gf)for(var r of gf(t))KI.call(t,r)&&yf(n,r,t[r]);return n};class Go extends Gb{constructor(t,r,s,a=Ni,h=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=yI,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(y=>{this.getKey&&y!==null&&!Co(y)?this.map.set(this.getKey(y),y):Y_(y)?this.map.set(y.id,y):X_(y)&&this.map.set(y.topic,y)}),this.cached=[],this.initialized=!0)},this.set=async(y,b)=>{this.isInitialized(),this.map.has(y)?await this.update(y,b):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:y,value:b}),this.map.set(y,b),await this.persist())},this.get=y=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:y}),this.getData(y)),this.getAll=y=>(this.isInitialized(),y?this.values.filter(b=>Object.keys(y).every(O=>O1(b[O],y[O]))):this.values),this.update=async(y,b)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:y,update:b});const O=mf(mf({},this.getData(y)),b);this.map.set(y,O),await this.persist()},this.delete=async(y,b)=>{this.isInitialized(),this.map.has(y)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:y,reason:b}),this.map.delete(y),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=h}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=ke("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=ke("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}}class WI{constructor(t,r){this.core=t,this.logger=r,this.name=_I,this.version=EI,this.events=new ru,this.initialized=!1,this.storagePrefix=Ni,this.ignoredPayloadTypes=[Pn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Kc(),a=await this.core.crypto.setSymKey(s),h=Oo(oe.FIVE_MINUTES),y={protocol:Cd},b={topic:a,expiry:h,relay:y,active:!1},O=K_({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:y});return await this.pairings.set(a,b),await this.core.relayer.subscribe(a),this.core.expirer.set(a,h),{topic:a,uri:O}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:h,relay:y}=Wl(s.uri);let b;if(this.pairings.keys.includes(a)&&(b=this.pairings.get(a),b.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const O=Oo(oe.FIVE_MINUTES),_={topic:a,relay:y,expiry:O,active:!1};return await this.pairings.set(a,_),this.core.expirer.set(a,O),s.activatePairing&&await this.activate({topic:a}),this.events.emit(is.create,_),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(h,a),await this.core.relayer.subscribe(a,{relay:y})),_},this.activate=async({topic:s})=>{this.isInitialized();const a=Oo(oe.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const h=await this.sendRequest(a,"wc_pairingPing",{}),{done:y,resolve:b,reject:O}=D_();this.events.once(Oc("pairing_ping",h),({error:_})=>{_?O(_):b()}),await y()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",rs("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,h)=>{const y=In(a,h),b=await this.core.crypto.encode(s,y),O=Qn[a].req;return this.core.history.set(s,y),this.core.relayer.publish(s,b,O),y.id},this.sendResult=async(s,a,h)=>{const y=hu(s,h),b=await this.core.crypto.encode(a,y),O=await this.core.history.get(a,s),_=Qn[O.request.method].res;await this.core.relayer.publish(a,b,_),await this.core.history.resolve(y)},this.sendError=async(s,a,h)=>{const y=Vo(s,h),b=await this.core.crypto.encode(a,y),O=await this.core.history.get(a,s),_=Qn[O.request.method]?Qn[O.request.method].res:Qn.unregistered_method.res;await this.core.relayer.publish(a,b,_),await this.core.history.resolve(y)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,rs("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Bl(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:h}=s;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(a,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,h);default:return this.onUnknownRpcMethodRequest(a,h)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:h}=s,y=(await this.core.history.get(a,h.id)).request.method;switch(y){case"wc_pairingPing":return this.onPairingPingResponse(a,h);default:return this.onUnknownRpcMethodResponse(y)}},this.onPairingPingRequest=async(s,a)=>{const{id:h}=a;try{this.isValidPing({topic:s}),await this.sendResult(h,s,!0),this.events.emit(is.ping,{id:h,topic:s})}catch(y){await this.sendError(h,s,y),this.logger.error(y)}},this.onPairingPingResponse=(s,a)=>{const{id:h}=a;setTimeout(()=>{pi(a)?this.events.emit(Oc("pairing_ping",h),{}):Fr(a)&&this.events.emit(Oc("pairing_ping",h),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:h}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(is.delete,{id:h,topic:s})}catch(y){await this.sendError(h,s,y),this.logger.error(y)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:h,method:y}=a;try{if(this.registeredMethods.includes(y))return;const b=rs("WC_METHOD_UNSUPPORTED",y);await this.sendError(h,s,b),this.logger.error(b)}catch(b){await this.sendError(h,s,b),this.logger.error(b)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(rs("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!Nc(s)){const{message:y}=ke("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(y)}if(!Q_(s.uri)){const{message:y}=ke("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(y)}const h=Wl(s.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:y}=ke("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(y)}if(!(h!=null&&h.symKey)){const{message:y}=ke("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(y)}},this.isValidPing=async s=>{if(!Nc(s)){const{message:h}=ke("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!Nc(s)){const{message:h}=ke("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(h)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!fd(s,!1)){const{message:a}=ke("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=ke("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Bl(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=ke("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new Go(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{lu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Ko(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Rr.expired,async t=>{const{topic:r}=L_(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(is.expire,{topic:r}))})}}let GI=class extends Bb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Cr.EventEmitter,this.name=II,this.version=SI,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:h}),this.records.has(a.id))return;const y={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:h,expiry:Oo(oe.THIRTY_DAYS)};this.records.set(y.id,y),this.events.emit(Yr.created,y)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Fr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Yr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(h=>{if(h.topic===s){if(typeof a<"u"&&h.id!==a)return;this.records.delete(h.id),this.events.emit(Yr.deleted,h)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:In(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=ke("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=ke("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Yr.created,t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.updated,t=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.deleted,t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{oe.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}},JI=class extends Qb{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Cr.EventEmitter,this.name=xI,this.version=PI,this.cached=[],this.initialized=!1,this.storagePrefix=Ni,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const h=this.formatTarget(s),y={target:h,expiry:a};this.expirations.set(h,y),this.checkExpiry(h,y),this.events.emit(Rr.created,{target:h,expiration:y})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),h=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Rr.deleted,{target:a,expiration:h})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return U_(t);if(typeof t=="number")return j_(t);const{message:r}=ke("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=ke("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=ke("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;oe.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Rr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(xn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Rr.created,t=>{const r=Rr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.expired,t=>{const r=Rr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Rr.deleted,t=>{const r=Rr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ke("NOT_INITIALIZED",this.name);throw new Error(t)}}};class QI extends Yb{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Rc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||On()||!ko())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Yc;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let h;try{h=await this.fetchAttestation(s.attestationId,a)}catch(y){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(y),h=await this.fetchAttestation(s.attestationId,Yc)}return h},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(oe.ONE_SECOND*2),y=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(h),y.status===200?await y.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(h=>{if(document.getElementById(Rc))return h();window.addEventListener("message",a);const y=document.createElement("iframe");y.id=Rc,y.src=`${this.verifyUrl}/${this.projectId}`,y.style.display="none",document.body.append(y),this.iframe=y,s=h}),new Promise((h,y)=>setTimeout(()=>{window.removeEventListener("message",a),y("verify iframe load timeout")},oe.toMiliseconds(oe.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||_n;return OI.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${_n}`),a=_n),a},this.logger=Re.generateChildLogger(r,this.name),this.verifyUrl=_n,this.abortController=new AbortController,this.isDevEnv=au()&&N1.IS_VITEST}get context(){return Re.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),oe.toMiliseconds(t))}}var YI=Object.defineProperty,vf=Object.getOwnPropertySymbols,XI=Object.prototype.hasOwnProperty,ZI=Object.prototype.propertyIsEnumerable,wf=(n,t,r)=>t in n?YI(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,bf=(n,t)=>{for(var r in t||(t={}))XI.call(t,r)&&wf(n,r,t[r]);if(vf)for(var r of vf(t))ZI.call(t,r)&&wf(n,r,t[r]);return n};let eS=class Dd extends kb{constructor(t){super(t),this.protocol=Ad,this.version=ZE,this.name=fu,this.events=new Cr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||$d,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||eI.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new xn.HeartBeat,this.crypto=new TI(this,this.logger,t==null?void 0:t.keychain),this.history=new GI(this,this.logger),this.expirer=new JI(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Db(bf(bf({},tI),t==null?void 0:t.storageOptions)),this.relayer=new kI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new WI(this,this.logger),this.verify=new QI(this.projectId||"",this.logger)}static async init(t){const r=new Dd(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(mI,s),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}};const tS=eS;var rS={};(function(n){const t=Mo,r=qo,s=jo,a=Lo,h=u=>u==null,y=Symbol("encodeFragmentIdentifier");function b(u){switch(u.arrayFormat){case"index":return d=>(m,g)=>{const p=m.length;return g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[",p,"]"].join("")]:[...m,[E(d,u),"[",E(p,u),"]=",E(g,u)].join("")]};case"bracket":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[]"].join("")]:[...m,[E(d,u),"[]=",E(g,u)].join("")];case"colon-list-separator":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),":list="].join("")]:[...m,[E(d,u),":list=",E(g,u)].join("")];case"comma":case"separator":case"bracket-separator":{const d=u.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(g,p)=>p===void 0||u.skipNull&&p===null||u.skipEmptyString&&p===""?g:(p=p===null?"":p,g.length===0?[[E(m,u),d,E(p,u)].join("")]:[[g,E(p,u)].join(u.arrayFormatSeparator)])}default:return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,E(d,u)]:[...m,[E(d,u),"=",E(g,u)].join("")]}}function O(u){let d;switch(u.arrayFormat){case"index":return(m,g,p)=>{if(d=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!d){p[m]=g;return}p[m]===void 0&&(p[m]={}),p[m][d[1]]=g};case"bracket":return(m,g,p)=>{if(d=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"colon-list-separator":return(m,g,p)=>{if(d=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"comma":case"separator":return(m,g,p)=>{const T=typeof g=="string"&&g.includes(u.arrayFormatSeparator),x=typeof g=="string"&&!T&&N(g,u).includes(u.arrayFormatSeparator);g=x?N(g,u):g;const Q=T||x?g.split(u.arrayFormatSeparator).map(se=>N(se,u)):g===null?g:N(g,u);p[m]=Q};case"bracket-separator":return(m,g,p)=>{const T=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!T){p[m]=g&&N(g,u);return}const x=g===null?[]:g.split(u.arrayFormatSeparator).map(Q=>N(Q,u));if(p[m]===void 0){p[m]=x;return}p[m]=[].concat(p[m],x)};default:return(m,g,p)=>{if(p[m]===void 0){p[m]=g;return}p[m]=[].concat(p[m],g)}}}function _(u){if(typeof u!="string"||u.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(u,d){return d.encode?d.strict?t(u):encodeURIComponent(u):u}function N(u,d){return d.decode?r(u):u}function L(u){return Array.isArray(u)?u.sort():typeof u=="object"?L(Object.keys(u)).sort((d,m)=>Number(d)-Number(m)).map(d=>u[d]):u}function H(u){const d=u.indexOf("#");return d!==-1&&(u=u.slice(0,d)),u}function M(u){let d="";const m=u.indexOf("#");return m!==-1&&(d=u.slice(m)),d}function J(u){u=H(u);const d=u.indexOf("?");return d===-1?"":u.slice(d+1)}function te(u,d){return d.parseNumbers&&!Number.isNaN(Number(u))&&typeof u=="string"&&u.trim()!==""?u=Number(u):d.parseBooleans&&u!==null&&(u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(u=u.toLowerCase()==="true"),u}function ue(u,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),_(d.arrayFormatSeparator);const m=O(d),g=Object.create(null);if(typeof u!="string"||(u=u.trim().replace(/^[?#&]/,""),!u))return g;for(const p of u.split("&")){if(p==="")continue;let[T,x]=s(d.decode?p.replace(/\+/g," "):p,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?x:N(x,d),m(N(T,d),x,g)}for(const p of Object.keys(g)){const T=g[p];if(typeof T=="object"&&T!==null)for(const x of Object.keys(T))T[x]=te(T[x],d);else g[p]=te(T,d)}return d.sort===!1?g:(d.sort===!0?Object.keys(g).sort():Object.keys(g).sort(d.sort)).reduce((p,T)=>{const x=g[T];return x&&typeof x=="object"&&!Array.isArray(x)?p[T]=L(x):p[T]=x,p},Object.create(null))}n.extract=J,n.parse=ue,n.stringify=(u,d)=>{if(!u)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),_(d.arrayFormatSeparator);const m=x=>d.skipNull&&h(u[x])||d.skipEmptyString&&u[x]==="",g=b(d),p={};for(const x of Object.keys(u))m(x)||(p[x]=u[x]);const T=Object.keys(p);return d.sort!==!1&&T.sort(d.sort),T.map(x=>{const Q=u[x];return Q===void 0?"":Q===null?E(x,d):Array.isArray(Q)?Q.length===0&&d.arrayFormat==="bracket-separator"?E(x,d)+"[]":Q.reduce(g(x),[]).join("&"):E(x,d)+"="+E(Q,d)}).filter(x=>x.length>0).join("&")},n.parseUrl=(u,d)=>{d=Object.assign({decode:!0},d);const[m,g]=s(u,"#");return Object.assign({url:m.split("?")[0]||"",query:ue(J(u),d)},d&&d.parseFragmentIdentifier&&g?{fragmentIdentifier:N(g,d)}:{})},n.stringifyUrl=(u,d)=>{d=Object.assign({encode:!0,strict:!0,[y]:!0},d);const m=H(u.url).split("?")[0]||"",g=n.extract(u.url),p=n.parse(g,{sort:!1}),T=Object.assign(p,u.query);let x=n.stringify(T,d);x&&(x=`?${x}`);let Q=M(u.url);return u.fragmentIdentifier&&(Q=`#${d[y]?E(u.fragmentIdentifier,d):u.fragmentIdentifier}`),`${m}${x}${Q}`},n.pick=(u,d,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[y]:!1},m);const{url:g,query:p,fragmentIdentifier:T}=n.parseUrl(u,m);return n.stringifyUrl({url:g,query:a(p,d),fragmentIdentifier:T},m)},n.exclude=(u,d,m)=>{const g=Array.isArray(d)?p=>!d.includes(p):(p,T)=>!d(p,T);return n.pick(u,g,m)}})(rS);function Ud(n,t){return n.includes(":")?[n]:t.chains||[]}const iS="base16",nS="utf8",sS=1;function Cc(n){const t=Fo.hash(nr(n,nS));return Qt(t,iS)}const oS="ReactNative",En={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function jd(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function aS(){return!Kf()&&!!Ho()&&navigator.product===oS}function du(){return!jd()&&!!Ho()}function cS(){return aS()?En.reactNative:jd()?En.node:du()?En.browser:En.unknown}function uS(){return Lw()||{name:"",description:"",url:"",icons:[""]}}function Gi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Xn(n=oe.FIVE_MINUTES,t){const r=oe.toMiliseconds(n||oe.FIVE_MINUTES);let s,a,h;return{resolve:y=>{h&&s&&(clearTimeout(h),s(y))},reject:y=>{h&&a&&(clearTimeout(h),a(y))},done:()=>new Promise((y,b)=>{h=setTimeout(()=>{b(new Error(t))},r),s=y,a=b})}}function hS(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function Wi(n,t){return oe.fromMiliseconds((t||Date.now())+oe.toMiliseconds(n))}function bn(n){return Date.now()>=oe.toMiliseconds(n)}function Bt(n,t){return`${n}${t?`:${t}`:""}`}async function lS({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const h=`${a}/wc?requestId=${n}&sessionTopic=${t}`,y=cS();y===En.browser?h.startsWith("https://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,"_self","noreferrer noopener"):y===En.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(s){console.error(s)}}async function fS(n,t){try{return await n.getItem(t)||(du()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}function Nn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function dS(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Nn(r.accounts))}),t}function pS(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function gS(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.events)}),r}function yS(n,t){const r=To(n,t);if(r)throw new Error(r.message);const s={};for(const[a,h]of Object.entries(n))s[a]={methods:h.methods,events:h.events,chains:h.accounts.map(y=>`${y.split(":")[0]}:${y.split(":")[1]}`)};return s}const mS={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},vS={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ge(n,t){const{message:r,code:s}=vS[n];return{message:t?`${r} ${t}`:r,code:s}}function br(n,t){const{message:r,code:s}=mS[n];return{message:t?`${r} ${t}`:r,code:s}}function Jo(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function as(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function Ar(n){return typeof n>"u"}function Jt(n,t){return t&&Ar(n)?!0:typeof n=="string"&&!!n.trim().length}function pu(n,t){return t&&Ar(n)?!0:typeof n=="number"&&!isNaN(n)}function wS(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let h=!0;return Gi(a,s)?(s.forEach(y=>{const{accounts:b,methods:O,events:_}=n.namespaces[y],E=Nn(b),N=r[y];(!Gi(Ud(y,N),E)||!Gi(N.methods,O)||!Gi(N.events,_))&&(h=!1)}),h):!1}function Do(n){return Jt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function bS(n){if(Jt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Do(r)}}return!1}function _S(n,t){let r=null;return Jt(n==null?void 0:n.publicKey,!1)||(r=ge("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function _f(n){let t=!0;return Jo(n)?n.length&&(t=n.every(r=>Jt(r,!1))):t=!1,t}function ES(n,t,r){let s=null;return Jo(t)&&t.length?t.forEach(a=>{s||Do(a)||(s=br("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Do(n)||(s=br("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function IS(n,t,r){let s=null;return Object.entries(n).forEach(([a,h])=>{if(s)return;const y=ES(a,Ud(a,h),`${t} ${r}`);y&&(s=y)}),s}function SS(n,t){let r=null;return Jo(n)?n.forEach(s=>{r||bS(s)||(r=br("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=br("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function xS(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=SS(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function PS(n,t){let r=null;return _f(n==null?void 0:n.methods)?_f(n==null?void 0:n.events)||(r=br("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=br("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Ld(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=PS(s,`${t}, namespace`);a&&(r=a)}),r}function OS(n,t,r){let s=null;if(n&&as(n)){const a=Ld(n,t);a&&(s=a);const h=IS(n,t,r);h&&(s=h)}else s=ge("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function To(n,t){let r=null;if(n&&as(n)){const s=Ld(n,t);s&&(r=s);const a=xS(n,t);a&&(r=a)}else r=ge("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Md(n){return Jt(n.protocol,!0)}function NS(n,t){let r=!1;return t&&!n?r=!0:n&&Jo(n)&&n.length&&n.forEach(s=>{r=Md(s)}),r}function TS(n){return typeof n=="number"}function qr(n){return typeof n<"u"&&typeof n!==null}function RS(n){return!(!n||typeof n!="object"||!n.code||!pu(n.code,!1)||!n.message||!Jt(n.message,!1))}function AS(n){return!(Ar(n)||!Jt(n.method,!1))}function CS(n){return!(Ar(n)||Ar(n.result)&&Ar(n.error)||!pu(n.id,!1)||!Jt(n.jsonrpc,!1))}function $S(n){return!(Ar(n)||!Jt(n.name,!1))}function Ef(n,t){return!(!Do(t)||!dS(n).includes(t))}function DS(n,t,r){return Jt(r,!1)?pS(n,t).includes(r):!1}function US(n,t,r){return Jt(r,!1)?gS(n,t).includes(r):!1}function If(n,t,r){let s=null;const a=jS(n),h=LS(t),y=Object.keys(a),b=Object.keys(h),O=Sf(Object.keys(n)),_=Sf(Object.keys(t)),E=O.filter(N=>!_.includes(N));return E.length&&(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(t).toString()}`)),Gi(y,b)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${y.toString()}
      Approved: ${b.toString()}`)),Object.keys(t).forEach(N=>{if(!N.includes(":")||s)return;const L=Nn(t[N].accounts);L.includes(N)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${N}
        Required: ${N}
        Approved: ${L.toString()}`))}),y.forEach(N=>{s||(Gi(a[N].methods,h[N].methods)?Gi(a[N].events,h[N].events)||(s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${N}`)):s=ge("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${N}`))}),s}function jS(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Sf(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function LS(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Nn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(h=>h.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function MS(n,t){return pu(n,!1)&&n<=t.max&&n>=t.min}const $c={};class _o{static get(t){return $c[t]}static set(t,r){$c[t]=r}static delete(t){delete $c[t]}}const qd="wc",zd=2,Fd="client",gu=`${qd}@${zd}:${Fd}:`,Dc={name:Fd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},xf="WALLETCONNECT_DEEPLINK_CHOICE",qS="proposal",Hd="Proposal expired",zS="session",Eo=oe.SEVEN_DAYS,FS="engine",Zn={wc_sessionPropose:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1115}}},Uc={min:oe.FIVE_MINUTES,max:oe.SEVEN_DAYS},di={idle:"IDLE",active:"ACTIVE"},HS="request",kS=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var BS=Object.defineProperty,VS=Object.defineProperties,KS=Object.getOwnPropertyDescriptors,Pf=Object.getOwnPropertySymbols,WS=Object.prototype.hasOwnProperty,GS=Object.prototype.propertyIsEnumerable,Of=(n,t,r)=>t in n?BS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,fr=(n,t)=>{for(var r in t||(t={}))WS.call(t,r)&&Of(n,r,t[r]);if(Pf)for(var r of Pf(t))GS.call(t,r)&&Of(n,r,t[r]);return n},es=(n,t)=>VS(n,KS(t));class JS extends Zb{constructor(t){super(t),this.name=FS,this.events=new ru,this.initialized=!1,this.ignoredPayloadTypes=[sS],this.requestQueue={state:di.idle,queue:[]},this.sessionRequestQueue={state:di.idle,queue:[]},this.requestQueueDelay=oe.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Zn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=es(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:h,optionalNamespaces:y,sessionProperties:b,relays:O}=s;let _=a,E,N=!1;if(_&&(N=this.client.core.pairing.pairings.get(_).active),!_||!N){const{topic:d,uri:m}=await this.client.core.pairing.create();_=d,E=m}const L=await this.client.core.crypto.generateKeyPair(),H=fr({requiredNamespaces:h,optionalNamespaces:y,relays:O??[{protocol:Cd}],proposer:{publicKey:L,metadata:this.client.metadata}},b&&{sessionProperties:b}),{reject:M,resolve:J,done:te}=Xn(oe.FIVE_MINUTES,Hd);if(this.events.once(Bt("session_connect"),async({error:d,session:m})=>{if(d)M(d);else if(m){m.self.publicKey=L;const g=es(fr({},m),{requiredNamespaces:m.requiredNamespaces,optionalNamespaces:m.optionalNamespaces});await this.client.session.set(m.topic,g),await this.setExpiry(m.topic,m.expiry),_&&await this.client.core.pairing.updateMetadata({topic:_,metadata:m.peer.metadata}),J(g)}}),!_){const{message:d}=ge("NO_MATCHING_KEY",`connect() pairing topic: ${_}`);throw new Error(d)}const ue=await this.sendRequest({topic:_,method:"wc_sessionPropose",params:H}),u=Wi(oe.FIVE_MINUTES);return await this.setProposal(ue,fr({id:ue,expiry:u},H)),{uri:E,approval:te}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:h,sessionProperties:y}=r,b=this.client.proposal.get(s);let{pairingTopic:O,proposer:_,requiredNamespaces:E,optionalNamespaces:N}=b;O=O||"",as(E)||(E=yS(h,"approve()"));const L=await this.client.core.crypto.generateKeyPair(),H=_.publicKey,M=await this.client.core.crypto.generateSharedKey(L,H);O&&s&&(await this.client.core.pairing.updateMetadata({topic:O,metadata:_.metadata}),await this.sendResult({id:s,topic:O,result:{relay:{protocol:a??"irn"},responderPublicKey:L}}),await this.client.proposal.delete(s,br("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:O}));const J=fr({relay:{protocol:a??"irn"},namespaces:h,requiredNamespaces:E,optionalNamespaces:N,pairingTopic:O,controller:{publicKey:L,metadata:this.client.metadata},expiry:Wi(Eo)},y&&{sessionProperties:y});await this.client.core.relayer.subscribe(M),await this.sendRequest({topic:M,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const te=es(fr({},J),{topic:M,pairingTopic:O,acknowledged:!1,self:J.controller,peer:{publicKey:_.publicKey,metadata:_.metadata},controller:L});return await this.client.session.set(M,te),await this.setExpiry(M,Wi(Eo)),{topic:M,acknowledged:()=>new Promise(ue=>setTimeout(()=>ue(this.client.session.get(M)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:h}=this.client.proposal.get(s);h&&(await this.sendError(s,h,a),await this.client.proposal.delete(s,br("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,h=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:y,resolve:b,reject:O}=Xn();return this.events.once(Bt("session_update",h),({error:_})=>{_?O(_):b()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:y}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:h,resolve:y,reject:b}=Xn();return this.events.once(Bt("session_extend",a),({error:O})=>{O?b(O):y()}),await this.setExpiry(s,Wi(Eo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:h,expiry:y}=r,b=uu(),{done:O,resolve:_,reject:E}=Xn(y,"Request expired. Please try again.");return this.events.once(Bt("session_request",b),({error:N,result:L})=>{N?E(N):_(L)}),await Promise.all([new Promise(async N=>{await this.sendRequest({clientRpcId:b,topic:h,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:y,throwOnFailedPublish:!0}).catch(L=>E(L)),this.client.events.emit("session_request_sent",{topic:h,request:a,chainId:s,id:b}),N()}),new Promise(async N=>{const L=await fS(this.client.core.storage,xf);lS({id:b,topic:h,wcDeepLink:L}),N()}),O()]).then(N=>N[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:h}=a;pi(a)?await this.sendResult({id:h,topic:s,result:a.result,throwOnFailedPublish:!0}):Fr(a)&&await this.sendError(h,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:h,resolve:y,reject:b}=Xn();this.events.once(Bt("session_ping",a),({error:O})=>{O?b(O):y()}),await h()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:h}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:br("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>wS(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(h=>{var y,b;return((y=h.peerMetadata)==null?void 0:y.url)&&((b=h.peerMetadata)==null?void 0:b.url)===r.peer.metadata.url&&h.topic&&h.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,br("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(xf).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,br("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),a&&(this.sessionRequestQueue.state=di.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=Zn.wc_sessionRequest.req.ttl,{id:a,topic:h,params:y,verifyContext:b}=r;await this.client.pendingRequest.set(a,{id:a,topic:h,params:y,verifyContext:b}),s&&this.client.core.expirer.set(a,Wi(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:h,expiry:y,relayRpcId:b,clientRpcId:O,throwOnFailedPublish:_}=r,E=In(a,h,O);if(du()&&kS.includes(a)){const H=Cc(JSON.stringify(E));this.client.core.verify.register({attestationId:H})}const N=await this.client.core.crypto.encode(s,E),L=Zn[a].req;return y&&(L.ttl=y),b&&(L.id=b),this.client.core.history.set(s,E),_?(L.internal=es(fr({},L.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,N,L)):this.client.core.relayer.publish(s,N,L).catch(H=>this.client.logger.error(H)),E.id},this.sendResult=async r=>{const{id:s,topic:a,result:h,throwOnFailedPublish:y}=r,b=hu(s,h),O=await this.client.core.crypto.encode(a,b),_=await this.client.core.history.get(a,s),E=Zn[_.request.method].res;y?(E.internal=es(fr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,O,E)):this.client.core.relayer.publish(a,O,E).catch(N=>this.client.logger.error(N)),await this.client.core.history.resolve(b)},this.sendError=async(r,s,a)=>{const h=Vo(r,a),y=await this.client.core.crypto.encode(s,h),b=await this.client.core.history.get(s,r),O=Zn[b.request.method].res;this.client.core.relayer.publish(s,y,O),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{bn(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{bn(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===di.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=di.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=di.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,h=a.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,h=(await this.client.core.history.get(s,a.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=ge("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:h}=s;try{this.isValidConnect(fr({},s.params));const y=Wi(oe.FIVE_MINUTES),b=fr({id:h,pairingTopic:r,expiry:y},a);await this.setProposal(h,b);const O=Cc(JSON.stringify(s)),_=await this.getVerifyContext(O,b.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:b,verifyContext:_})}catch(y){await this.sendError(h,r,y),this.client.logger.error(y)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(pi(s)){const{result:h}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const y=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:y});const b=y.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:b});const O=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:O});const _=await this.client.core.crypto.generateSharedKey(b,O);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:_});const E=await this.client.core.relayer.subscribe(_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else Fr(s)&&(await this.client.proposal.delete(a,br("USER_DISCONNECTED")),this.events.emit(Bt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidSessionSettleRequest(h);const{relay:y,controller:b,expiry:O,namespaces:_,requiredNamespaces:E,optionalNamespaces:N,sessionProperties:L,pairingTopic:H}=s.params,M=fr({topic:r,relay:y,expiry:O,namespaces:_,acknowledged:!0,pairingTopic:H,requiredNamespaces:E,optionalNamespaces:N,controller:b.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:b.publicKey,metadata:b.metadata}},L&&{sessionProperties:L});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Bt("session_connect"),{session:M}),this.cleanupDuplicatePairings(M)}catch(y){await this.sendError(a,r,y),this.client.logger.error(y)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;pi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Bt("session_approve",a),{})):Fr(s)&&(await this.client.session.delete(r,br("USER_DISCONNECTED")),this.events.emit(Bt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:h}=s;try{const y=`${r}_session_update`,b=_o.get(y);if(b&&this.isRequestOutOfSync(b,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(fr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:a}),_o.set(y,h)}catch(y){await this.sendError(h,r,y),this.client.logger.error(y)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Bt("session_update",a),{}):Fr(s)&&this.events.emit(Bt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Wi(Eo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Bt("session_extend",a),{}):Fr(s)&&this.events.emit(Bt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{pi(s)?this.events.emit(Bt("session_ping",a),{}):Fr(s)&&this.events.emit(Bt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Gt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:h}=s;try{this.isValidRequest(fr({topic:r},h));const y=Cc(JSON.stringify(In("wc_sessionRequest",h,a))),b=this.client.session.get(r),O=await this.getVerifyContext(y,b.peer.metadata),_={id:a,topic:r,params:h,verifyContext:O};await this.setPendingSessionRequest(_),this.addSessionRequestToSessionRequestQueue(_),this.processSessionRequestQueue()}catch(y){await this.sendError(a,r,y),this.client.logger.error(y)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;pi(s)?this.events.emit(Bt("session_request",a),{result:s.result}):Fr(s)&&this.events.emit(Bt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:h}=s;try{const y=`${r}_session_event_${h.event.name}`,b=_o.get(y);if(b&&this.isRequestOutOfSync(b,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(fr({topic:r},h)),this.client.events.emit("session_event",{id:a,topic:r,params:h}),_o.set(y,a)}catch(y){await this.sendError(a,r,y),this.client.logger.error(y)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=di.idle,this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===di.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=di.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,In("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(O)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:y,relays:b}=r;if(Ar(s)||await this.isValidPairingTopic(s),!NS(b,!0)){const{message:O}=ge("MISSING_OR_INVALID",`connect() relays: ${b}`);throw new Error(O)}!Ar(a)&&as(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!Ar(h)&&as(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),Ar(y)||this.validateSessionProps(y,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=OS(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!qr(r))throw new Error(ge("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:h,sessionProperties:y}=r;await this.isValidProposalId(s);const b=this.client.proposal.get(s),O=To(a,"approve()");if(O)throw new Error(O.message);const _=If(b.requiredNamespaces,a,"approve()");if(_)throw new Error(_.message);if(!Jt(h,!0)){const{message:E}=ge("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(E)}Ar(y)||this.validateSessionProps(y,"sessionProperties")},this.isValidReject=async r=>{if(!qr(r)){const{message:h}=ge("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!RS(a)){const{message:h}=ge("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!qr(r)){const{message:_}=ge("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(_)}const{relay:s,controller:a,namespaces:h,expiry:y}=r;if(!Md(s)){const{message:_}=ge("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(_)}const b=_S(a,"onSessionSettleRequest()");if(b)throw new Error(b.message);const O=To(h,"onSessionSettleRequest()");if(O)throw new Error(O.message);if(bn(y)){const{message:_}=ge("EXPIRED","onSessionSettleRequest()");throw new Error(_)}},this.isValidUpdate=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(O)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const h=this.client.session.get(s),y=To(a,"update()");if(y)throw new Error(y.message);const b=If(h.requiredNamespaces,a,"update()");if(b)throw new Error(b.message)},this.isValidExtend=async r=>{if(!qr(r)){const{message:a}=ge("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!qr(r)){const{message:O}=ge("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(O)}const{topic:s,request:a,chainId:h,expiry:y}=r;await this.isValidSessionTopic(s);const{namespaces:b}=this.client.session.get(s);if(!Ef(b,h)){const{message:O}=ge("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(O)}if(!AS(a)){const{message:O}=ge("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(O)}if(!DS(b,h,a.method)){const{message:O}=ge("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(O)}if(y&&!MS(y,Uc)){const{message:O}=ge("MISSING_OR_INVALID",`request() expiry: ${y}. Expiry must be a number (in seconds) between ${Uc.min} and ${Uc.max}`);throw new Error(O)}},this.isValidRespond=async r=>{if(!qr(r)){const{message:h}=ge("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!CS(a)){const{message:h}=ge("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!qr(r)){const{message:a}=ge("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!qr(r)){const{message:b}=ge("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(b)}const{topic:s,event:a,chainId:h}=r;await this.isValidSessionTopic(s);const{namespaces:y}=this.client.session.get(s);if(!Ef(y,h)){const{message:b}=ge("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(b)}if(!$S(a)){const{message:b}=ge("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(b)}if(!US(y,h,a.name)){const{message:b}=ge("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(b)}},this.isValidDisconnect=async r=>{if(!qr(r)){const{message:a}=ge("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||_n,validation:"UNKNOWN",origin:s.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});h&&(a.verified.origin=h.origin,a.verified.isScam=h.isScam,a.verified.validation=h.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Jt(a,!1)){const{message:h}=ge("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ge("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{lu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Ko(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Rr.expired,async t=>{const{topic:r,id:s}=hS(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ge("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(is.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Jt(t,!1)){const{message:r}=ge("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(bn(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ge("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Jt(t,!1)){const{message:r}=ge("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(bn(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=ge("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Jt(t,!1)){const{message:r}=ge("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ge("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!TS(t)){const{message:r}=ge("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ge("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(bn(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=ge("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class QS extends Go{constructor(t,r){super(t,r,qS,gu),this.core=t,this.logger=r}}class YS extends Go{constructor(t,r){super(t,r,zS,gu),this.core=t,this.logger=r}}class XS extends Go{constructor(t,r){super(t,r,HS,gu,s=>s.id),this.core=t,this.logger=r}}let ZS=class kd extends Xb{constructor(t){super(t),this.protocol=qd,this.version=zd,this.name=Dc.name,this.events=new Cr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Dc.name,this.metadata=(t==null?void 0:t.metadata)||uS();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Dc.logger}));this.core=(t==null?void 0:t.core)||new tS(t),this.logger=Re.generateChildLogger(r,this.name),this.session=new YS(this.core,this.logger),this.proposal=new QS(this.core,this.logger),this.pendingRequest=new XS(this.core,this.logger),this.engine=new JS(this)}static async init(t){const r=new kd(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var ex={};(function(n){const t=Mo,r=qo,s=jo,a=Lo,h=u=>u==null,y=Symbol("encodeFragmentIdentifier");function b(u){switch(u.arrayFormat){case"index":return d=>(m,g)=>{const p=m.length;return g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[",p,"]"].join("")]:[...m,[E(d,u),"[",E(p,u),"]=",E(g,u)].join("")]};case"bracket":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),"[]"].join("")]:[...m,[E(d,u),"[]=",E(g,u)].join("")];case"colon-list-separator":return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,[E(d,u),":list="].join("")]:[...m,[E(d,u),":list=",E(g,u)].join("")];case"comma":case"separator":case"bracket-separator":{const d=u.arrayFormat==="bracket-separator"?"[]=":"=";return m=>(g,p)=>p===void 0||u.skipNull&&p===null||u.skipEmptyString&&p===""?g:(p=p===null?"":p,g.length===0?[[E(m,u),d,E(p,u)].join("")]:[[g,E(p,u)].join(u.arrayFormatSeparator)])}default:return d=>(m,g)=>g===void 0||u.skipNull&&g===null||u.skipEmptyString&&g===""?m:g===null?[...m,E(d,u)]:[...m,[E(d,u),"=",E(g,u)].join("")]}}function O(u){let d;switch(u.arrayFormat){case"index":return(m,g,p)=>{if(d=/\[(\d*)\]$/.exec(m),m=m.replace(/\[\d*\]$/,""),!d){p[m]=g;return}p[m]===void 0&&(p[m]={}),p[m][d[1]]=g};case"bracket":return(m,g,p)=>{if(d=/(\[\])$/.exec(m),m=m.replace(/\[\]$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"colon-list-separator":return(m,g,p)=>{if(d=/(:list)$/.exec(m),m=m.replace(/:list$/,""),!d){p[m]=g;return}if(p[m]===void 0){p[m]=[g];return}p[m]=[].concat(p[m],g)};case"comma":case"separator":return(m,g,p)=>{const T=typeof g=="string"&&g.includes(u.arrayFormatSeparator),x=typeof g=="string"&&!T&&N(g,u).includes(u.arrayFormatSeparator);g=x?N(g,u):g;const Q=T||x?g.split(u.arrayFormatSeparator).map(se=>N(se,u)):g===null?g:N(g,u);p[m]=Q};case"bracket-separator":return(m,g,p)=>{const T=/(\[\])$/.test(m);if(m=m.replace(/\[\]$/,""),!T){p[m]=g&&N(g,u);return}const x=g===null?[]:g.split(u.arrayFormatSeparator).map(Q=>N(Q,u));if(p[m]===void 0){p[m]=x;return}p[m]=[].concat(p[m],x)};default:return(m,g,p)=>{if(p[m]===void 0){p[m]=g;return}p[m]=[].concat(p[m],g)}}}function _(u){if(typeof u!="string"||u.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function E(u,d){return d.encode?d.strict?t(u):encodeURIComponent(u):u}function N(u,d){return d.decode?r(u):u}function L(u){return Array.isArray(u)?u.sort():typeof u=="object"?L(Object.keys(u)).sort((d,m)=>Number(d)-Number(m)).map(d=>u[d]):u}function H(u){const d=u.indexOf("#");return d!==-1&&(u=u.slice(0,d)),u}function M(u){let d="";const m=u.indexOf("#");return m!==-1&&(d=u.slice(m)),d}function J(u){u=H(u);const d=u.indexOf("?");return d===-1?"":u.slice(d+1)}function te(u,d){return d.parseNumbers&&!Number.isNaN(Number(u))&&typeof u=="string"&&u.trim()!==""?u=Number(u):d.parseBooleans&&u!==null&&(u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(u=u.toLowerCase()==="true"),u}function ue(u,d){d=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},d),_(d.arrayFormatSeparator);const m=O(d),g=Object.create(null);if(typeof u!="string"||(u=u.trim().replace(/^[?#&]/,""),!u))return g;for(const p of u.split("&")){if(p==="")continue;let[T,x]=s(d.decode?p.replace(/\+/g," "):p,"=");x=x===void 0?null:["comma","separator","bracket-separator"].includes(d.arrayFormat)?x:N(x,d),m(N(T,d),x,g)}for(const p of Object.keys(g)){const T=g[p];if(typeof T=="object"&&T!==null)for(const x of Object.keys(T))T[x]=te(T[x],d);else g[p]=te(T,d)}return d.sort===!1?g:(d.sort===!0?Object.keys(g).sort():Object.keys(g).sort(d.sort)).reduce((p,T)=>{const x=g[T];return x&&typeof x=="object"&&!Array.isArray(x)?p[T]=L(x):p[T]=x,p},Object.create(null))}n.extract=J,n.parse=ue,n.stringify=(u,d)=>{if(!u)return"";d=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},d),_(d.arrayFormatSeparator);const m=x=>d.skipNull&&h(u[x])||d.skipEmptyString&&u[x]==="",g=b(d),p={};for(const x of Object.keys(u))m(x)||(p[x]=u[x]);const T=Object.keys(p);return d.sort!==!1&&T.sort(d.sort),T.map(x=>{const Q=u[x];return Q===void 0?"":Q===null?E(x,d):Array.isArray(Q)?Q.length===0&&d.arrayFormat==="bracket-separator"?E(x,d)+"[]":Q.reduce(g(x),[]).join("&"):E(x,d)+"="+E(Q,d)}).filter(x=>x.length>0).join("&")},n.parseUrl=(u,d)=>{d=Object.assign({decode:!0},d);const[m,g]=s(u,"#");return Object.assign({url:m.split("?")[0]||"",query:ue(J(u),d)},d&&d.parseFragmentIdentifier&&g?{fragmentIdentifier:N(g,d)}:{})},n.stringifyUrl=(u,d)=>{d=Object.assign({encode:!0,strict:!0,[y]:!0},d);const m=H(u.url).split("?")[0]||"",g=n.extract(u.url),p=n.parse(g,{sort:!1}),T=Object.assign(p,u.query);let x=n.stringify(T,d);x&&(x=`?${x}`);let Q=M(u.url);return u.fragmentIdentifier&&(Q=`#${d[y]?E(u.fragmentIdentifier,d):u.fragmentIdentifier}`),`${m}${x}${Q}`},n.pick=(u,d,m)=>{m=Object.assign({parseFragmentIdentifier:!0,[y]:!1},m);const{url:g,query:p,fragmentIdentifier:T}=n.parseUrl(u,m);return n.stringifyUrl({url:g,query:a(p,d),fragmentIdentifier:T},m)},n.exclude=(u,d,m)=>{const g=Array.isArray(d)?p=>!d.includes(p):(p,T)=>!d(p,T);return n.pick(u,g,m)}})(ex);const tx=":";function rx(n){const[t,r]=n.split(tx);return{namespace:t,reference:r}}function jc(n=[],t=[]){return[...new Set([...n,...t])]}function yu(n){return n.includes(":")}function ns(n){return yu(n)?n.split(":")[0]:n}const ix={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Nf(n,t){const{message:r,code:s}=ix[n];return{message:t?`${r} ${t}`:r,code:s}}function Tf(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function nx(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}var Xc={exports:{}};(function(n,t){var r=typeof self<"u"?self:Hr,s=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(y){var b={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function O(S){return S&&DataView.prototype.isPrototypeOf(S)}if(b.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(S){return S&&_.indexOf(Object.prototype.toString.call(S))>-1};function N(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function L(S){return typeof S!="string"&&(S=String(S)),S}function H(S){var C={next:function(){var ie=S.shift();return{done:ie===void 0,value:ie}}};return b.iterable&&(C[Symbol.iterator]=function(){return C}),C}function M(S){this.map={},S instanceof M?S.forEach(function(C,ie){this.append(ie,C)},this):Array.isArray(S)?S.forEach(function(C){this.append(C[0],C[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function(C){this.append(C,S[C])},this)}M.prototype.append=function(S,C){S=N(S),C=L(C);var ie=this.map[S];this.map[S]=ie?ie+", "+C:C},M.prototype.delete=function(S){delete this.map[N(S)]},M.prototype.get=function(S){return S=N(S),this.has(S)?this.map[S]:null},M.prototype.has=function(S){return this.map.hasOwnProperty(N(S))},M.prototype.set=function(S,C){this.map[N(S)]=L(C)},M.prototype.forEach=function(S,C){for(var ie in this.map)this.map.hasOwnProperty(ie)&&S.call(C,this.map[ie],ie,this)},M.prototype.keys=function(){var S=[];return this.forEach(function(C,ie){S.push(ie)}),H(S)},M.prototype.values=function(){var S=[];return this.forEach(function(C){S.push(C)}),H(S)},M.prototype.entries=function(){var S=[];return this.forEach(function(C,ie){S.push([ie,C])}),H(S)},b.iterable&&(M.prototype[Symbol.iterator]=M.prototype.entries);function J(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function te(S){return new Promise(function(C,ie){S.onload=function(){C(S.result)},S.onerror=function(){ie(S.error)}})}function ue(S){var C=new FileReader,ie=te(C);return C.readAsArrayBuffer(S),ie}function u(S){var C=new FileReader,ie=te(C);return C.readAsText(S),ie}function d(S){for(var C=new Uint8Array(S),ie=new Array(C.length),de=0;de<C.length;de++)ie[de]=String.fromCharCode(C[de]);return ie.join("")}function m(S){if(S.slice)return S.slice(0);var C=new Uint8Array(S.byteLength);return C.set(new Uint8Array(S)),C.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(S){this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:b.blob&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:b.formData&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:b.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():b.arrayBuffer&&b.blob&&O(S)?(this._bodyArrayBuffer=m(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):b.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(S)||E(S))?this._bodyArrayBuffer=m(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):b.searchParams&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},b.blob&&(this.blob=function(){var S=J(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?J(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ue)}),this.text=function(){var S=J(this);if(S)return S;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},b.formData&&(this.formData=function(){return this.text().then(Q)}),this.json=function(){return this.text().then(JSON.parse)},this}var p=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function T(S){var C=S.toUpperCase();return p.indexOf(C)>-1?C:S}function x(S,C){C=C||{};var ie=C.body;if(S instanceof x){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,C.headers||(this.headers=new M(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,!ie&&S._bodyInit!=null&&(ie=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=C.credentials||this.credentials||"same-origin",(C.headers||!this.headers)&&(this.headers=new M(C.headers)),this.method=T(C.method||this.method||"GET"),this.mode=C.mode||this.mode||null,this.signal=C.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ie)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ie)}x.prototype.clone=function(){return new x(this,{body:this._bodyInit})};function Q(S){var C=new FormData;return S.trim().split("&").forEach(function(ie){if(ie){var de=ie.split("="),X=de.shift().replace(/\+/g," "),W=de.join("=").replace(/\+/g," ");C.append(decodeURIComponent(X),decodeURIComponent(W))}}),C}function se(S){var C=new M,ie=S.replace(/\r?\n[\t ]+/g," ");return ie.split(/\r?\n/).forEach(function(de){var X=de.split(":"),W=X.shift().trim();if(W){var Y=X.join(":").trim();C.append(W,Y)}}),C}g.call(x.prototype);function pe(S,C){C||(C={}),this.type="default",this.status=C.status===void 0?200:C.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in C?C.statusText:"OK",this.headers=new M(C.headers),this.url=C.url||"",this._initBody(S)}g.call(pe.prototype),pe.prototype.clone=function(){return new pe(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new M(this.headers),url:this.url})},pe.error=function(){var S=new pe(null,{status:0,statusText:""});return S.type="error",S};var Ae=[301,302,303,307,308];pe.redirect=function(S,C){if(Ae.indexOf(C)===-1)throw new RangeError("Invalid status code");return new pe(null,{status:C,headers:{location:S}})},y.DOMException=h.DOMException;try{new y.DOMException}catch{y.DOMException=function(C,ie){this.message=C,this.name=ie;var de=Error(C);this.stack=de.stack},y.DOMException.prototype=Object.create(Error.prototype),y.DOMException.prototype.constructor=y.DOMException}function ze(S,C){return new Promise(function(ie,de){var X=new x(S,C);if(X.signal&&X.signal.aborted)return de(new y.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function Y(){W.abort()}W.onload=function(){var Z={status:W.status,statusText:W.statusText,headers:se(W.getAllResponseHeaders()||"")};Z.url="responseURL"in W?W.responseURL:Z.headers.get("X-Request-URL");var Qe="response"in W?W.response:W.responseText;ie(new pe(Qe,Z))},W.onerror=function(){de(new TypeError("Network request failed"))},W.ontimeout=function(){de(new TypeError("Network request failed"))},W.onabort=function(){de(new y.DOMException("Aborted","AbortError"))},W.open(X.method,X.url,!0),X.credentials==="include"?W.withCredentials=!0:X.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&b.blob&&(W.responseType="blob"),X.headers.forEach(function(Z,Qe){W.setRequestHeader(Qe,Z)}),X.signal&&(X.signal.addEventListener("abort",Y),W.onreadystatechange=function(){W.readyState===4&&X.signal.removeEventListener("abort",Y)}),W.send(typeof X._bodyInit>"u"?null:X._bodyInit)})}return ze.polyfill=!0,h.fetch||(h.fetch=ze,h.Headers=M,h.Request=x,h.Response=pe),y.Headers=M,y.Request=x,y.Response=pe,y.fetch=ze,Object.defineProperty(y,"__esModule",{value:!0}),y})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(Xc,Xc.exports);var sx=Xc.exports;const Rf=Wf(sx),ox={Accept:"application/json","Content-Type":"application/json"},ax="POST",Af={headers:ox,method:ax},Cf=10;class Ri{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Xl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Ji(t),h=await(await Rf(this.url,Object.assign(Object.assign({},Af),{body:s}))).json();this.onPayload({data:h})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Xl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),a(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Ji({id:1,jsonrpc:"2.0",method:"test",params:[]});await Rf(t,Object.assign(Object.assign({},Af),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ls(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),h=Vo(t,a);this.events.emit("payload",h)}parseError(t,r=this.url){return gd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Cf&&this.events.setMaxListeners(Cf)}}const $f="error",cx="wss://relay.walletconnect.com",ux="wc",hx="universal_provider",Df=`${ux}@2:${hx}:`,lx="https://rpc.walletconnect.com/v1/",yi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ts=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",y="Expected a function",b="Invalid `variable` option passed into `_.template`",O="__lodash_hash_undefined__",_=500,E="__lodash_placeholder__",N=1,L=2,H=4,M=1,J=2,te=1,ue=2,u=4,d=8,m=16,g=32,p=64,T=128,x=256,Q=512,se=30,pe="...",Ae=800,ze=16,S=1,C=2,ie=3,de=1/0,X=9007199254740991,W=17976931348623157e292,Y=NaN,Z=4294967295,Qe=Z-1,Be=Z>>>1,Br=[["ary",T],["bind",te],["bindKey",ue],["curry",d],["curryRight",m],["flip",Q],["partial",g],["partialRight",p],["rearg",x]],Ie="[object Arguments]",St="[object Array]",F="[object AsyncFunction]",z="[object Boolean]",j="[object Date]",l="[object DOMException]",A="[object Error]",ae="[object Function]",ye="[object GeneratorFunction]",_e="[object Map]",Ce="[object Number]",De="[object Null]",Pe="[object Object]",xt="[object Promise]",wt="[object Proxy]",at="[object RegExp]",je="[object Set]",Xe="[object String]",Ze="[object Symbol]",ct="[object Undefined]",Fe="[object WeakMap]",et="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",lt="[object Float32Array]",Me="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ft="[object Int32Array]",Ht="[object Uint8Array]",Lt="[object Uint8ClampedArray]",Yt="[object Uint16Array]",or="[object Uint32Array]",Vr=/\b__p \+= '';/g,Xt=/\b(__p \+=) '' \+/g,Xr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mi=/&(?:amp|lt|gt|quot|#39);/g,Ai=/[&<>"']/g,ft=RegExp(mi.source),it=RegExp(Ai.source),dt=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Nt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/[\\^$.*+?()[\]{}|]/g,Tt=RegExp(gt.source),yt=/^\s+/,bt=/\s/,mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,At=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Qo=/[()=,{}\[\]\/\s]/,Yo=/\\(\\)?/g,Xo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_r=/\w*$/,Zo=/^[-+]0x[0-9a-f]+$/i,ea=/^0b[01]+$/i,ta=/^\[object .+?Constructor\]$/,ra=/^0o[0-7]+$/i,ia=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Zi=/($^)/,na=/['\n\r\u2028\u2029\\]/g,en="\\ud800-\\udfff",sa="\\u0300-\\u036f",oa="\\ufe20-\\ufe2f",tn="\\u20d0-\\u20ff",ps=sa+oa+tn,gs="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",aa="\\xac\\xb1\\xd7\\xf7",ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ua="\\u2000-\\u206f",ha=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ys="A-Z\\xc0-\\xd6\\xd8-\\xde",ms="\\ufe0e\\ufe0f",Ci=aa+ca+ua+ha,Tn="[']",$i="["+en+"]",Rn="["+Ci+"]",Di="["+ps+"]",vs="\\d+",la="["+gs+"]",ws="["+$r+"]",bs="[^"+en+Ci+vs+gs+$r+ys+"]",rn="\\ud83c[\\udffb-\\udfff]",fa="(?:"+Di+"|"+rn+")",_s="[^"+en+"]",nn="(?:\\ud83c[\\udde6-\\uddff]){2}",vi="[\\ud800-\\udbff][\\udc00-\\udfff]",pr="["+ys+"]",Es="\\u200d",Is="(?:"+ws+"|"+bs+")",Kr="(?:"+pr+"|"+bs+")",Ss="(?:"+Tn+"(?:d|ll|m|re|s|t|ve))?",xs="(?:"+Tn+"(?:D|LL|M|RE|S|T|VE))?",Ps=fa+"?",Os="["+ms+"]?",da="(?:"+Es+"(?:"+[_s,nn,vi].join("|")+")"+Os+Ps+")*",ei="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ns="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ts=Os+Ps+da,sn="(?:"+[la,nn,vi].join("|")+")"+Ts,pa="(?:"+[_s+Di+"?",Di,nn,vi,$i].join("|")+")",An=RegExp(Tn,"g"),ga=RegExp(Di,"g"),on=RegExp(rn+"(?="+rn+")|"+pa+Ts,"g"),Rs=RegExp([pr+"?"+ws+"+"+Ss+"(?="+[Rn,pr,"$"].join("|")+")",Kr+"+"+xs+"(?="+[Rn,pr+Is,"$"].join("|")+")",pr+"?"+Is+"+"+Ss,pr+"+"+xs,Ns,ei,vs,sn].join("|"),"g"),As=RegExp("["+Es+en+ps+ms+"]"),Ui=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ya=-1,Ke={};Ke[lt]=Ke[Me]=Ke[Pt]=Ke[Dt]=Ke[Ft]=Ke[Ht]=Ke[Lt]=Ke[Yt]=Ke[or]=!0,Ke[Ie]=Ke[St]=Ke[$e]=Ke[z]=Ke[Ve]=Ke[j]=Ke[A]=Ke[ae]=Ke[_e]=Ke[Ce]=Ke[Pe]=Ke[at]=Ke[je]=Ke[Xe]=Ke[Fe]=!1;var He={};He[Ie]=He[St]=He[$e]=He[Ve]=He[z]=He[j]=He[lt]=He[Me]=He[Pt]=He[Dt]=He[Ft]=He[_e]=He[Ce]=He[Pe]=He[at]=He[je]=He[Xe]=He[Ze]=He[Ht]=He[Lt]=He[Yt]=He[or]=!0,He[A]=He[ae]=He[Fe]=!1;var I={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},re={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,ve=parseInt,tt=typeof ts=="object"&&ts&&ts.Object===Object&&ts,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Ne=tt||Ct||Function("return this")(),Ge=t&&!t.nodeType&&t,_t=Ge&&!0&&n&&!n.nodeType&&n,ar=_t&&_t.exports===Ge,$t=ar&&tt.process,rt=function(){try{var D=_t&&_t.require&&_t.require("util").types;return D||$t&&$t.binding&&$t.binding("util")}catch{}}(),Zt=rt&&rt.isArrayBuffer,Dr=rt&&rt.isDate,Er=rt&&rt.isMap,Wr=rt&&rt.isRegExp,Cn=rt&&rt.isSet,ji=rt&&rt.isTypedArray;function Mt(D,k,q){switch(q.length){case 0:return D.call(k);case 1:return D.call(k,q[0]);case 2:return D.call(k,q[0],q[1]);case 3:return D.call(k,q[0],q[1],q[2])}return D.apply(k,q)}function Kd(D,k,q,ne){for(var me=-1,Ue=D==null?0:D.length;++me<Ue;){var Ut=D[me];k(ne,Ut,q(Ut),D)}return ne}function Ir(D,k){for(var q=-1,ne=D==null?0:D.length;++q<ne&&k(D[q],q,D)!==!1;);return D}function Wd(D,k){for(var q=D==null?0:D.length;q--&&k(D[q],q,D)!==!1;);return D}function wu(D,k){for(var q=-1,ne=D==null?0:D.length;++q<ne;)if(!k(D[q],q,D))return!1;return!0}function wi(D,k){for(var q=-1,ne=D==null?0:D.length,me=0,Ue=[];++q<ne;){var Ut=D[q];k(Ut,q,D)&&(Ue[me++]=Ut)}return Ue}function $s(D,k){var q=D==null?0:D.length;return!!q&&an(D,k,0)>-1}function ma(D,k,q){for(var ne=-1,me=D==null?0:D.length;++ne<me;)if(q(k,D[ne]))return!0;return!1}function st(D,k){for(var q=-1,ne=D==null?0:D.length,me=Array(ne);++q<ne;)me[q]=k(D[q],q,D);return me}function bi(D,k){for(var q=-1,ne=k.length,me=D.length;++q<ne;)D[me+q]=k[q];return D}function va(D,k,q,ne){var me=-1,Ue=D==null?0:D.length;for(ne&&Ue&&(q=D[++me]);++me<Ue;)q=k(q,D[me],me,D);return q}function Gd(D,k,q,ne){var me=D==null?0:D.length;for(ne&&me&&(q=D[--me]);me--;)q=k(q,D[me],me,D);return q}function wa(D,k){for(var q=-1,ne=D==null?0:D.length;++q<ne;)if(k(D[q],q,D))return!0;return!1}var Jd=ba("length");function Qd(D){return D.split("")}function Yd(D){return D.match(At)||[]}function bu(D,k,q){var ne;return q(D,function(me,Ue,Ut){if(k(me,Ue,Ut))return ne=Ue,!1}),ne}function Ds(D,k,q,ne){for(var me=D.length,Ue=q+(ne?1:-1);ne?Ue--:++Ue<me;)if(k(D[Ue],Ue,D))return Ue;return-1}function an(D,k,q){return k===k?up(D,k,q):Ds(D,_u,q)}function Xd(D,k,q,ne){for(var me=q-1,Ue=D.length;++me<Ue;)if(ne(D[me],k))return me;return-1}function _u(D){return D!==D}function Eu(D,k){var q=D==null?0:D.length;return q?Ea(D,k)/q:Y}function ba(D){return function(k){return k==null?r:k[D]}}function _a(D){return function(k){return D==null?r:D[k]}}function Iu(D,k,q,ne,me){return me(D,function(Ue,Ut,Je){q=ne?(ne=!1,Ue):k(q,Ue,Ut,Je)}),q}function Zd(D,k){var q=D.length;for(D.sort(k);q--;)D[q]=D[q].value;return D}function Ea(D,k){for(var q,ne=-1,me=D.length;++ne<me;){var Ue=k(D[ne]);Ue!==r&&(q=q===r?Ue:q+Ue)}return q}function Ia(D,k){for(var q=-1,ne=Array(D);++q<D;)ne[q]=k(q);return ne}function ep(D,k){return st(k,function(q){return[q,D[q]]})}function Su(D){return D&&D.slice(0,Nu(D)+1).replace(yt,"")}function gr(D){return function(k){return D(k)}}function Sa(D,k){return st(k,function(q){return D[q]})}function $n(D,k){return D.has(k)}function xu(D,k){for(var q=-1,ne=D.length;++q<ne&&an(k,D[q],0)>-1;);return q}function Pu(D,k){for(var q=D.length;q--&&an(k,D[q],0)>-1;);return q}function tp(D,k){for(var q=D.length,ne=0;q--;)D[q]===k&&++ne;return ne}var rp=_a(I),ip=_a($);function np(D){return"\\"+re[D]}function sp(D,k){return D==null?r:D[k]}function cn(D){return As.test(D)}function op(D){return Ui.test(D)}function ap(D){for(var k,q=[];!(k=D.next()).done;)q.push(k.value);return q}function xa(D){var k=-1,q=Array(D.size);return D.forEach(function(ne,me){q[++k]=[me,ne]}),q}function Ou(D,k){return function(q){return D(k(q))}}function _i(D,k){for(var q=-1,ne=D.length,me=0,Ue=[];++q<ne;){var Ut=D[q];(Ut===k||Ut===E)&&(D[q]=E,Ue[me++]=q)}return Ue}function Us(D){var k=-1,q=Array(D.size);return D.forEach(function(ne){q[++k]=ne}),q}function cp(D){var k=-1,q=Array(D.size);return D.forEach(function(ne){q[++k]=[ne,ne]}),q}function up(D,k,q){for(var ne=q-1,me=D.length;++ne<me;)if(D[ne]===k)return ne;return-1}function hp(D,k,q){for(var ne=q+1;ne--;)if(D[ne]===k)return ne;return ne}function un(D){return cn(D)?fp(D):Jd(D)}function Ur(D){return cn(D)?dp(D):Qd(D)}function Nu(D){for(var k=D.length;k--&&bt.test(D.charAt(k)););return k}var lp=_a(K);function fp(D){for(var k=on.lastIndex=0;on.test(D);)++k;return k}function dp(D){return D.match(on)||[]}function pp(D){return D.match(Rs)||[]}var gp=function D(k){k=k==null?Ne:hn.defaults(Ne.Object(),k,hn.pick(Ne,Cs));var q=k.Array,ne=k.Date,me=k.Error,Ue=k.Function,Ut=k.Math,Je=k.Object,Pa=k.RegExp,yp=k.String,Sr=k.TypeError,js=q.prototype,mp=Ue.prototype,ln=Je.prototype,Ls=k["__core-js_shared__"],Ms=mp.toString,qe=ln.hasOwnProperty,vp=0,Tu=function(){var e=/[^.]+$/.exec(Ls&&Ls.keys&&Ls.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),qs=ln.toString,wp=Ms.call(Je),bp=Ne._,_p=Pa("^"+Ms.call(qe).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zs=ar?k.Buffer:r,Ei=k.Symbol,Fs=k.Uint8Array,Ru=zs?zs.allocUnsafe:r,Hs=Ou(Je.getPrototypeOf,Je),Au=Je.create,Cu=ln.propertyIsEnumerable,ks=js.splice,$u=Ei?Ei.isConcatSpreadable:r,Dn=Ei?Ei.iterator:r,Li=Ei?Ei.toStringTag:r,Bs=function(){try{var e=Hi(Je,"defineProperty");return e({},"",{}),e}catch{}}(),Ep=k.clearTimeout!==Ne.clearTimeout&&k.clearTimeout,Ip=ne&&ne.now!==Ne.Date.now&&ne.now,Sp=k.setTimeout!==Ne.setTimeout&&k.setTimeout,Vs=Ut.ceil,Ks=Ut.floor,Oa=Je.getOwnPropertySymbols,xp=zs?zs.isBuffer:r,Du=k.isFinite,Pp=js.join,Op=Ou(Je.keys,Je),jt=Ut.max,Kt=Ut.min,Np=ne.now,Tp=k.parseInt,Uu=Ut.random,Rp=js.reverse,Na=Hi(k,"DataView"),Un=Hi(k,"Map"),Ta=Hi(k,"Promise"),fn=Hi(k,"Set"),jn=Hi(k,"WeakMap"),Ln=Hi(Je,"create"),Ws=jn&&new jn,dn={},Ap=ki(Na),Cp=ki(Un),$p=ki(Ta),Dp=ki(fn),Up=ki(jn),Gs=Ei?Ei.prototype:r,Mn=Gs?Gs.valueOf:r,ju=Gs?Gs.toString:r;function v(e){if(vt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof xr)return e;if(qe.call(e,"__wrapped__"))return Lh(e)}return new xr(e)}var pn=function(){function e(){}return function(i){if(!ht(i))return{};if(Au)return Au(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Js(){}function xr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}v.templateSettings={escape:dt,evaluate:pt,interpolate:ut,variable:"",imports:{_:v}},v.prototype=Js.prototype,v.prototype.constructor=v,xr.prototype=pn(Js.prototype),xr.prototype.constructor=xr;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Z,this.__views__=[]}function jp(){var e=new Oe(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function Lp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Mp(){var e=this.__wrapped__.value(),i=this.__dir__,o=we(e),c=i<0,f=o?e.length:0,w=Qg(0,f,this.__views__),P=w.start,R=w.end,U=R-P,B=c?R:P-1,V=this.__iteratees__,G=V.length,ee=0,ce=Kt(U,this.__takeCount__);if(!o||!c&&f==U&&ce==U)return oh(e,this.__actions__);var le=[];e:for(;U--&&ee<ce;){B+=i;for(var Ee=-1,fe=e[B];++Ee<G;){var xe=V[Ee],Te=xe.iteratee,vr=xe.type,rr=Te(fe);if(vr==C)fe=rr;else if(!rr){if(vr==S)continue e;break e}}le[ee++]=fe}return le}Oe.prototype=pn(Js.prototype),Oe.prototype.constructor=Oe;function Mi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function qp(){this.__data__=Ln?Ln(null):{},this.size=0}function zp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Fp(e){var i=this.__data__;if(Ln){var o=i[e];return o===O?r:o}return qe.call(i,e)?i[e]:r}function Hp(e){var i=this.__data__;return Ln?i[e]!==r:qe.call(i,e)}function kp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Ln&&i===r?O:i,this}Mi.prototype.clear=qp,Mi.prototype.delete=zp,Mi.prototype.get=Fp,Mi.prototype.has=Hp,Mi.prototype.set=kp;function ti(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Bp(){this.__data__=[],this.size=0}function Vp(e){var i=this.__data__,o=Qs(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():ks.call(i,o,1),--this.size,!0}function Kp(e){var i=this.__data__,o=Qs(i,e);return o<0?r:i[o][1]}function Wp(e){return Qs(this.__data__,e)>-1}function Gp(e,i){var o=this.__data__,c=Qs(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ti.prototype.clear=Bp,ti.prototype.delete=Vp,ti.prototype.get=Kp,ti.prototype.has=Wp,ti.prototype.set=Gp;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Jp(){this.size=0,this.__data__={hash:new Mi,map:new(Un||ti),string:new Mi}}function Qp(e){var i=co(this,e).delete(e);return this.size-=i?1:0,i}function Yp(e){return co(this,e).get(e)}function Xp(e){return co(this,e).has(e)}function Zp(e,i){var o=co(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ri.prototype.clear=Jp,ri.prototype.delete=Qp,ri.prototype.get=Yp,ri.prototype.has=Xp,ri.prototype.set=Zp;function qi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ri;++i<o;)this.add(e[i])}function eg(e){return this.__data__.set(e,O),this}function tg(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=eg,qi.prototype.has=tg;function jr(e){var i=this.__data__=new ti(e);this.size=i.size}function rg(){this.__data__=new ti,this.size=0}function ig(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function ng(e){return this.__data__.get(e)}function sg(e){return this.__data__.has(e)}function og(e,i){var o=this.__data__;if(o instanceof ti){var c=o.__data__;if(!Un||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ri(c)}return o.set(e,i),this.size=o.size,this}jr.prototype.clear=rg,jr.prototype.delete=ig,jr.prototype.get=ng,jr.prototype.has=sg,jr.prototype.set=og;function Lu(e,i){var o=we(e),c=!o&&Bi(e),f=!o&&!c&&Oi(e),w=!o&&!c&&!f&&vn(e),P=o||c||f||w,R=P?Ia(e.length,yp):[],U=R.length;for(var B in e)(i||qe.call(e,B))&&!(P&&(B=="length"||f&&(B=="offset"||B=="parent")||w&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||oi(B,U)))&&R.push(B);return R}function Mu(e){var i=e.length;return i?e[za(0,i-1)]:r}function ag(e,i){return uo(cr(e),zi(i,0,e.length))}function cg(e){return uo(cr(e))}function Ra(e,i,o){(o!==r&&!Lr(e[i],o)||o===r&&!(i in e))&&ii(e,i,o)}function qn(e,i,o){var c=e[i];(!(qe.call(e,i)&&Lr(c,o))||o===r&&!(i in e))&&ii(e,i,o)}function Qs(e,i){for(var o=e.length;o--;)if(Lr(e[o][0],i))return o;return-1}function ug(e,i,o,c){return Ii(e,function(f,w,P){i(c,f,o(f),P)}),c}function qu(e,i){return e&&Jr(i,qt(i),e)}function hg(e,i){return e&&Jr(i,hr(i),e)}function ii(e,i,o){i=="__proto__"&&Bs?Bs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Aa(e,i){for(var o=-1,c=i.length,f=q(c),w=e==null;++o<c;)f[o]=w?r:lc(e,i[o]);return f}function zi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Pr(e,i,o,c,f,w){var P,R=i&N,U=i&L,B=i&H;if(o&&(P=f?o(e,c,f,w):o(e)),P!==r)return P;if(!ht(e))return e;var V=we(e);if(V){if(P=Xg(e),!R)return cr(e,P)}else{var G=Wt(e),ee=G==ae||G==ye;if(Oi(e))return uh(e,R);if(G==Pe||G==Ie||ee&&!f){if(P=U||ee?{}:Nh(e),!R)return U?Fg(e,hg(P,e)):zg(e,qu(P,e))}else{if(!He[G])return f?e:{};P=Zg(e,G,R)}}w||(w=new jr);var ce=w.get(e);if(ce)return ce;w.set(e,P),il(e)?e.forEach(function(fe){P.add(Pr(fe,i,o,fe,e,w))}):tl(e)&&e.forEach(function(fe,xe){P.set(xe,Pr(fe,i,o,xe,e,w))});var le=B?U?Ya:Qa:U?hr:qt,Ee=V?r:le(e);return Ir(Ee||e,function(fe,xe){Ee&&(xe=fe,fe=e[xe]),qn(P,xe,Pr(fe,i,o,xe,e,w))}),P}function lg(e){var i=qt(e);return function(o){return zu(o,e,i)}}function zu(e,i,o){var c=o.length;if(e==null)return!c;for(e=Je(e);c--;){var f=o[c],w=i[f],P=e[f];if(P===r&&!(f in e)||!w(P))return!1}return!0}function Fu(e,i,o){if(typeof e!="function")throw new Sr(y);return Kn(function(){e.apply(r,o)},i)}function zn(e,i,o,c){var f=-1,w=$s,P=!0,R=e.length,U=[],B=i.length;if(!R)return U;o&&(i=st(i,gr(o))),c?(w=ma,P=!1):i.length>=a&&(w=$n,P=!1,i=new qi(i));e:for(;++f<R;){var V=e[f],G=o==null?V:o(V);if(V=c||V!==0?V:0,P&&G===G){for(var ee=B;ee--;)if(i[ee]===G)continue e;U.push(V)}else w(i,G,c)||U.push(V)}return U}var Ii=ph(Gr),Hu=ph($a,!0);function fg(e,i){var o=!0;return Ii(e,function(c,f,w){return o=!!i(c,f,w),o}),o}function Ys(e,i,o){for(var c=-1,f=e.length;++c<f;){var w=e[c],P=i(w);if(P!=null&&(R===r?P===P&&!mr(P):o(P,R)))var R=P,U=w}return U}function dg(e,i,o,c){var f=e.length;for(o=be(o),o<0&&(o=-o>f?0:f+o),c=c===r||c>f?f:be(c),c<0&&(c+=f),c=o>c?0:sl(c);o<c;)e[o++]=i;return e}function ku(e,i){var o=[];return Ii(e,function(c,f,w){i(c,f,w)&&o.push(c)}),o}function kt(e,i,o,c,f){var w=-1,P=e.length;for(o||(o=ty),f||(f=[]);++w<P;){var R=e[w];i>0&&o(R)?i>1?kt(R,i-1,o,c,f):bi(f,R):c||(f[f.length]=R)}return f}var Ca=gh(),Bu=gh(!0);function Gr(e,i){return e&&Ca(e,i,qt)}function $a(e,i){return e&&Bu(e,i,qt)}function Xs(e,i){return wi(i,function(o){return ai(e[o])})}function Fi(e,i){i=xi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Qr(i[o++])];return o&&o==c?e:r}function Vu(e,i,o){var c=i(e);return we(e)?c:bi(c,o(e))}function er(e){return e==null?e===r?ct:De:Li&&Li in Je(e)?Jg(e):cy(e)}function Da(e,i){return e>i}function pg(e,i){return e!=null&&qe.call(e,i)}function gg(e,i){return e!=null&&i in Je(e)}function yg(e,i,o){return e>=Kt(i,o)&&e<jt(i,o)}function Ua(e,i,o){for(var c=o?ma:$s,f=e[0].length,w=e.length,P=w,R=q(w),U=1/0,B=[];P--;){var V=e[P];P&&i&&(V=st(V,gr(i))),U=Kt(V.length,U),R[P]=!o&&(i||f>=120&&V.length>=120)?new qi(P&&V):r}V=e[0];var G=-1,ee=R[0];e:for(;++G<f&&B.length<U;){var ce=V[G],le=i?i(ce):ce;if(ce=o||ce!==0?ce:0,!(ee?$n(ee,le):c(B,le,o))){for(P=w;--P;){var Ee=R[P];if(!(Ee?$n(Ee,le):c(e[P],le,o)))continue e}ee&&ee.push(le),B.push(ce)}}return B}function mg(e,i,o,c){return Gr(e,function(f,w,P){i(c,o(f),w,P)}),c}function Fn(e,i,o){i=xi(i,e),e=Ch(e,i);var c=e==null?e:e[Qr(Nr(i))];return c==null?r:Mt(c,e,o)}function Ku(e){return vt(e)&&er(e)==Ie}function vg(e){return vt(e)&&er(e)==$e}function wg(e){return vt(e)&&er(e)==j}function Hn(e,i,o,c,f){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:bg(e,i,o,c,Hn,f)}function bg(e,i,o,c,f,w){var P=we(e),R=we(i),U=P?St:Wt(e),B=R?St:Wt(i);U=U==Ie?Pe:U,B=B==Ie?Pe:B;var V=U==Pe,G=B==Pe,ee=U==B;if(ee&&Oi(e)){if(!Oi(i))return!1;P=!0,V=!1}if(ee&&!V)return w||(w=new jr),P||vn(e)?xh(e,i,o,c,f,w):Wg(e,i,U,o,c,f,w);if(!(o&M)){var ce=V&&qe.call(e,"__wrapped__"),le=G&&qe.call(i,"__wrapped__");if(ce||le){var Ee=ce?e.value():e,fe=le?i.value():i;return w||(w=new jr),f(Ee,fe,o,c,w)}}return ee?(w||(w=new jr),Gg(e,i,o,c,f,w)):!1}function _g(e){return vt(e)&&Wt(e)==_e}function ja(e,i,o,c){var f=o.length,w=f,P=!c;if(e==null)return!w;for(e=Je(e);f--;){var R=o[f];if(P&&R[2]?R[1]!==e[R[0]]:!(R[0]in e))return!1}for(;++f<w;){R=o[f];var U=R[0],B=e[U],V=R[1];if(P&&R[2]){if(B===r&&!(U in e))return!1}else{var G=new jr;if(c)var ee=c(B,V,U,e,i,G);if(!(ee===r?Hn(V,B,M|J,c,G):ee))return!1}}return!0}function Wu(e){if(!ht(e)||iy(e))return!1;var i=ai(e)?_p:ta;return i.test(ki(e))}function Eg(e){return vt(e)&&er(e)==at}function Ig(e){return vt(e)&&Wt(e)==je}function Sg(e){return vt(e)&&yo(e.length)&&!!Ke[er(e)]}function Gu(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?we(e)?Yu(e[0],e[1]):Qu(e):yl(e)}function La(e){if(!Vn(e))return Op(e);var i=[];for(var o in Je(e))qe.call(e,o)&&o!="constructor"&&i.push(o);return i}function xg(e){if(!ht(e))return ay(e);var i=Vn(e),o=[];for(var c in e)c=="constructor"&&(i||!qe.call(e,c))||o.push(c);return o}function Ma(e,i){return e<i}function Ju(e,i){var o=-1,c=ur(e)?q(e.length):[];return Ii(e,function(f,w,P){c[++o]=i(f,w,P)}),c}function Qu(e){var i=Za(e);return i.length==1&&i[0][2]?Rh(i[0][0],i[0][1]):function(o){return o===e||ja(o,e,i)}}function Yu(e,i){return tc(e)&&Th(i)?Rh(Qr(e),i):function(o){var c=lc(o,e);return c===r&&c===i?fc(o,e):Hn(i,c,M|J)}}function Zs(e,i,o,c,f){e!==i&&Ca(i,function(w,P){if(f||(f=new jr),ht(w))Pg(e,i,P,o,Zs,c,f);else{var R=c?c(ic(e,P),w,P+"",e,i,f):r;R===r&&(R=w),Ra(e,P,R)}},hr)}function Pg(e,i,o,c,f,w,P){var R=ic(e,o),U=ic(i,o),B=P.get(U);if(B){Ra(e,o,B);return}var V=w?w(R,U,o+"",e,i,P):r,G=V===r;if(G){var ee=we(U),ce=!ee&&Oi(U),le=!ee&&!ce&&vn(U);V=U,ee||ce||le?we(R)?V=R:Et(R)?V=cr(R):ce?(G=!1,V=uh(U,!0)):le?(G=!1,V=hh(U,!0)):V=[]:Wn(U)||Bi(U)?(V=R,Bi(R)?V=ol(R):(!ht(R)||ai(R))&&(V=Nh(U))):G=!1}G&&(P.set(U,V),f(V,U,c,w,P),P.delete(U)),Ra(e,o,V)}function Xu(e,i){var o=e.length;if(o)return i+=i<0?o:0,oi(i,o)?e[i]:r}function Zu(e,i,o){i.length?i=st(i,function(w){return we(w)?function(P){return Fi(P,w.length===1?w[0]:w)}:w}):i=[lr];var c=-1;i=st(i,gr(he()));var f=Ju(e,function(w,P,R){var U=st(i,function(B){return B(w)});return{criteria:U,index:++c,value:w}});return Zd(f,function(w,P){return qg(w,P,o)})}function Og(e,i){return eh(e,i,function(o,c){return fc(e,c)})}function eh(e,i,o){for(var c=-1,f=i.length,w={};++c<f;){var P=i[c],R=Fi(e,P);o(R,P)&&kn(w,xi(P,e),R)}return w}function Ng(e){return function(i){return Fi(i,e)}}function qa(e,i,o,c){var f=c?Xd:an,w=-1,P=i.length,R=e;for(e===i&&(i=cr(i)),o&&(R=st(e,gr(o)));++w<P;)for(var U=0,B=i[w],V=o?o(B):B;(U=f(R,V,U,c))>-1;)R!==e&&ks.call(R,U,1),ks.call(e,U,1);return e}function th(e,i){for(var o=e?i.length:0,c=o-1;o--;){var f=i[o];if(o==c||f!==w){var w=f;oi(f)?ks.call(e,f,1):ka(e,f)}}return e}function za(e,i){return e+Ks(Uu()*(i-e+1))}function Tg(e,i,o,c){for(var f=-1,w=jt(Vs((i-e)/(o||1)),0),P=q(w);w--;)P[c?w:++f]=e,e+=o;return P}function Fa(e,i){var o="";if(!e||i<1||i>X)return o;do i%2&&(o+=e),i=Ks(i/2),i&&(e+=e);while(i);return o}function Se(e,i){return nc(Ah(e,i,lr),e+"")}function Rg(e){return Mu(wn(e))}function Ag(e,i){var o=wn(e);return uo(o,zi(i,0,o.length))}function kn(e,i,o,c){if(!ht(e))return e;i=xi(i,e);for(var f=-1,w=i.length,P=w-1,R=e;R!=null&&++f<w;){var U=Qr(i[f]),B=o;if(U==="__proto__"||U==="constructor"||U==="prototype")return e;if(f!=P){var V=R[U];B=c?c(V,U,R):r,B===r&&(B=ht(V)?V:oi(i[f+1])?[]:{})}qn(R,U,B),R=R[U]}return e}var rh=Ws?function(e,i){return Ws.set(e,i),e}:lr,Cg=Bs?function(e,i){return Bs(e,"toString",{configurable:!0,enumerable:!1,value:pc(i),writable:!0})}:lr;function $g(e){return uo(wn(e))}function Or(e,i,o){var c=-1,f=e.length;i<0&&(i=-i>f?0:f+i),o=o>f?f:o,o<0&&(o+=f),f=i>o?0:o-i>>>0,i>>>=0;for(var w=q(f);++c<f;)w[c]=e[c+i];return w}function Dg(e,i){var o;return Ii(e,function(c,f,w){return o=i(c,f,w),!o}),!!o}function eo(e,i,o){var c=0,f=e==null?c:e.length;if(typeof i=="number"&&i===i&&f<=Be){for(;c<f;){var w=c+f>>>1,P=e[w];P!==null&&!mr(P)&&(o?P<=i:P<i)?c=w+1:f=w}return f}return Ha(e,i,lr,o)}function Ha(e,i,o,c){var f=0,w=e==null?0:e.length;if(w===0)return 0;i=o(i);for(var P=i!==i,R=i===null,U=mr(i),B=i===r;f<w;){var V=Ks((f+w)/2),G=o(e[V]),ee=G!==r,ce=G===null,le=G===G,Ee=mr(G);if(P)var fe=c||le;else B?fe=le&&(c||ee):R?fe=le&&ee&&(c||!ce):U?fe=le&&ee&&!ce&&(c||!Ee):ce||Ee?fe=!1:fe=c?G<=i:G<i;fe?f=V+1:w=V}return Kt(w,Qe)}function ih(e,i){for(var o=-1,c=e.length,f=0,w=[];++o<c;){var P=e[o],R=i?i(P):P;if(!o||!Lr(R,U)){var U=R;w[f++]=P===0?0:P}}return w}function nh(e){return typeof e=="number"?e:mr(e)?Y:+e}function yr(e){if(typeof e=="string")return e;if(we(e))return st(e,yr)+"";if(mr(e))return ju?ju.call(e):"";var i=e+"";return i=="0"&&1/e==-de?"-0":i}function Si(e,i,o){var c=-1,f=$s,w=e.length,P=!0,R=[],U=R;if(o)P=!1,f=ma;else if(w>=a){var B=i?null:Vg(e);if(B)return Us(B);P=!1,f=$n,U=new qi}else U=i?[]:R;e:for(;++c<w;){var V=e[c],G=i?i(V):V;if(V=o||V!==0?V:0,P&&G===G){for(var ee=U.length;ee--;)if(U[ee]===G)continue e;i&&U.push(G),R.push(V)}else f(U,G,o)||(U!==R&&U.push(G),R.push(V))}return R}function ka(e,i){return i=xi(i,e),e=Ch(e,i),e==null||delete e[Qr(Nr(i))]}function sh(e,i,o,c){return kn(e,i,o(Fi(e,i)),c)}function to(e,i,o,c){for(var f=e.length,w=c?f:-1;(c?w--:++w<f)&&i(e[w],w,e););return o?Or(e,c?0:w,c?w+1:f):Or(e,c?w+1:0,c?f:w)}function oh(e,i){var o=e;return o instanceof Oe&&(o=o.value()),va(i,function(c,f){return f.func.apply(f.thisArg,bi([c],f.args))},o)}function Ba(e,i,o){var c=e.length;if(c<2)return c?Si(e[0]):[];for(var f=-1,w=q(c);++f<c;)for(var P=e[f],R=-1;++R<c;)R!=f&&(w[f]=zn(w[f]||P,e[R],i,o));return Si(kt(w,1),i,o)}function ah(e,i,o){for(var c=-1,f=e.length,w=i.length,P={};++c<f;){var R=c<w?i[c]:r;o(P,e[c],R)}return P}function Va(e){return Et(e)?e:[]}function Ka(e){return typeof e=="function"?e:lr}function xi(e,i){return we(e)?e:tc(e,i)?[e]:jh(Le(e))}var Ug=Se;function Pi(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Or(e,i,o)}var ch=Ep||function(e){return Ne.clearTimeout(e)};function uh(e,i){if(i)return e.slice();var o=e.length,c=Ru?Ru(o):new e.constructor(o);return e.copy(c),c}function Wa(e){var i=new e.constructor(e.byteLength);return new Fs(i).set(new Fs(e)),i}function jg(e,i){var o=i?Wa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Lg(e){var i=new e.constructor(e.source,_r.exec(e));return i.lastIndex=e.lastIndex,i}function Mg(e){return Mn?Je(Mn.call(e)):{}}function hh(e,i){var o=i?Wa(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function lh(e,i){if(e!==i){var o=e!==r,c=e===null,f=e===e,w=mr(e),P=i!==r,R=i===null,U=i===i,B=mr(i);if(!R&&!B&&!w&&e>i||w&&P&&U&&!R&&!B||c&&P&&U||!o&&U||!f)return 1;if(!c&&!w&&!B&&e<i||B&&o&&f&&!c&&!w||R&&o&&f||!P&&f||!U)return-1}return 0}function qg(e,i,o){for(var c=-1,f=e.criteria,w=i.criteria,P=f.length,R=o.length;++c<P;){var U=lh(f[c],w[c]);if(U){if(c>=R)return U;var B=o[c];return U*(B=="desc"?-1:1)}}return e.index-i.index}function fh(e,i,o,c){for(var f=-1,w=e.length,P=o.length,R=-1,U=i.length,B=jt(w-P,0),V=q(U+B),G=!c;++R<U;)V[R]=i[R];for(;++f<P;)(G||f<w)&&(V[o[f]]=e[f]);for(;B--;)V[R++]=e[f++];return V}function dh(e,i,o,c){for(var f=-1,w=e.length,P=-1,R=o.length,U=-1,B=i.length,V=jt(w-R,0),G=q(V+B),ee=!c;++f<V;)G[f]=e[f];for(var ce=f;++U<B;)G[ce+U]=i[U];for(;++P<R;)(ee||f<w)&&(G[ce+o[P]]=e[f++]);return G}function cr(e,i){var o=-1,c=e.length;for(i||(i=q(c));++o<c;)i[o]=e[o];return i}function Jr(e,i,o,c){var f=!o;o||(o={});for(var w=-1,P=i.length;++w<P;){var R=i[w],U=c?c(o[R],e[R],R,o,e):r;U===r&&(U=e[R]),f?ii(o,R,U):qn(o,R,U)}return o}function zg(e,i){return Jr(e,ec(e),i)}function Fg(e,i){return Jr(e,Ph(e),i)}function ro(e,i){return function(o,c){var f=we(o)?Kd:ug,w=i?i():{};return f(o,e,he(c,2),w)}}function gn(e){return Se(function(i,o){var c=-1,f=o.length,w=f>1?o[f-1]:r,P=f>2?o[2]:r;for(w=e.length>3&&typeof w=="function"?(f--,w):r,P&&tr(o[0],o[1],P)&&(w=f<3?r:w,f=1),i=Je(i);++c<f;){var R=o[c];R&&e(i,R,c,w)}return i})}function ph(e,i){return function(o,c){if(o==null)return o;if(!ur(o))return e(o,c);for(var f=o.length,w=i?f:-1,P=Je(o);(i?w--:++w<f)&&c(P[w],w,P)!==!1;);return o}}function gh(e){return function(i,o,c){for(var f=-1,w=Je(i),P=c(i),R=P.length;R--;){var U=P[e?R:++f];if(o(w[U],U,w)===!1)break}return i}}function Hg(e,i,o){var c=i&te,f=Bn(e);function w(){var P=this&&this!==Ne&&this instanceof w?f:e;return P.apply(c?o:this,arguments)}return w}function yh(e){return function(i){i=Le(i);var o=cn(i)?Ur(i):r,c=o?o[0]:i.charAt(0),f=o?Pi(o,1).join(""):i.slice(1);return c[e]()+f}}function yn(e){return function(i){return va(pl(dl(i).replace(An,"")),e,"")}}function Bn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=pn(e.prototype),c=e.apply(o,i);return ht(c)?c:o}}function kg(e,i,o){var c=Bn(e);function f(){for(var w=arguments.length,P=q(w),R=w,U=mn(f);R--;)P[R]=arguments[R];var B=w<3&&P[0]!==U&&P[w-1]!==U?[]:_i(P,U);if(w-=B.length,w<o)return _h(e,i,io,f.placeholder,r,P,B,r,r,o-w);var V=this&&this!==Ne&&this instanceof f?c:e;return Mt(V,this,P)}return f}function mh(e){return function(i,o,c){var f=Je(i);if(!ur(i)){var w=he(o,3);i=qt(i),o=function(R){return w(f[R],R,f)}}var P=e(i,o,c);return P>-1?f[w?i[P]:P]:r}}function vh(e){return si(function(i){var o=i.length,c=o,f=xr.prototype.thru;for(e&&i.reverse();c--;){var w=i[c];if(typeof w!="function")throw new Sr(y);if(f&&!P&&ao(w)=="wrapper")var P=new xr([],!0)}for(c=P?c:o;++c<o;){w=i[c];var R=ao(w),U=R=="wrapper"?Xa(w):r;U&&rc(U[0])&&U[1]==(T|d|g|x)&&!U[4].length&&U[9]==1?P=P[ao(U[0])].apply(P,U[3]):P=w.length==1&&rc(w)?P[R]():P.thru(w)}return function(){var B=arguments,V=B[0];if(P&&B.length==1&&we(V))return P.plant(V).value();for(var G=0,ee=o?i[G].apply(this,B):V;++G<o;)ee=i[G].call(this,ee);return ee}})}function io(e,i,o,c,f,w,P,R,U,B){var V=i&T,G=i&te,ee=i&ue,ce=i&(d|m),le=i&Q,Ee=ee?r:Bn(e);function fe(){for(var xe=arguments.length,Te=q(xe),vr=xe;vr--;)Te[vr]=arguments[vr];if(ce)var rr=mn(fe),wr=tp(Te,rr);if(c&&(Te=fh(Te,c,f,ce)),w&&(Te=dh(Te,w,P,ce)),xe-=wr,ce&&xe<B){var It=_i(Te,rr);return _h(e,i,io,fe.placeholder,o,Te,It,R,U,B-xe)}var Mr=G?o:this,ui=ee?Mr[e]:e;return xe=Te.length,R?Te=uy(Te,R):le&&xe>1&&Te.reverse(),V&&U<xe&&(Te.length=U),this&&this!==Ne&&this instanceof fe&&(ui=Ee||Bn(ui)),ui.apply(Mr,Te)}return fe}function wh(e,i){return function(o,c){return mg(o,e,i(c),{})}}function no(e,i){return function(o,c){var f;if(o===r&&c===r)return i;if(o!==r&&(f=o),c!==r){if(f===r)return c;typeof o=="string"||typeof c=="string"?(o=yr(o),c=yr(c)):(o=nh(o),c=nh(c)),f=e(o,c)}return f}}function Ga(e){return si(function(i){return i=st(i,gr(he())),Se(function(o){var c=this;return e(i,function(f){return Mt(f,c,o)})})})}function so(e,i){i=i===r?" ":yr(i);var o=i.length;if(o<2)return o?Fa(i,e):i;var c=Fa(i,Vs(e/un(i)));return cn(i)?Pi(Ur(c),0,e).join(""):c.slice(0,e)}function Bg(e,i,o,c){var f=i&te,w=Bn(e);function P(){for(var R=-1,U=arguments.length,B=-1,V=c.length,G=q(V+U),ee=this&&this!==Ne&&this instanceof P?w:e;++B<V;)G[B]=c[B];for(;U--;)G[B++]=arguments[++R];return Mt(ee,f?o:this,G)}return P}function bh(e){return function(i,o,c){return c&&typeof c!="number"&&tr(i,o,c)&&(o=c=r),i=ci(i),o===r?(o=i,i=0):o=ci(o),c=c===r?i<o?1:-1:ci(c),Tg(i,o,c,e)}}function oo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Tr(i),o=Tr(o)),e(i,o)}}function _h(e,i,o,c,f,w,P,R,U,B){var V=i&d,G=V?P:r,ee=V?r:P,ce=V?w:r,le=V?r:w;i|=V?g:p,i&=~(V?p:g),i&u||(i&=~(te|ue));var Ee=[e,i,f,ce,G,le,ee,R,U,B],fe=o.apply(r,Ee);return rc(e)&&$h(fe,Ee),fe.placeholder=c,Dh(fe,e,i)}function Ja(e){var i=Ut[e];return function(o,c){if(o=Tr(o),c=c==null?0:Kt(be(c),292),c&&Du(o)){var f=(Le(o)+"e").split("e"),w=i(f[0]+"e"+(+f[1]+c));return f=(Le(w)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return i(o)}}var Vg=fn&&1/Us(new fn([,-0]))[1]==de?function(e){return new fn(e)}:mc;function Eh(e){return function(i){var o=Wt(i);return o==_e?xa(i):o==je?cp(i):ep(i,e(i))}}function ni(e,i,o,c,f,w,P,R){var U=i&ue;if(!U&&typeof e!="function")throw new Sr(y);var B=c?c.length:0;if(B||(i&=~(g|p),c=f=r),P=P===r?P:jt(be(P),0),R=R===r?R:be(R),B-=f?f.length:0,i&p){var V=c,G=f;c=f=r}var ee=U?r:Xa(e),ce=[e,i,o,c,f,V,G,w,P,R];if(ee&&oy(ce,ee),e=ce[0],i=ce[1],o=ce[2],c=ce[3],f=ce[4],R=ce[9]=ce[9]===r?U?0:e.length:jt(ce[9]-B,0),!R&&i&(d|m)&&(i&=~(d|m)),!i||i==te)var le=Hg(e,i,o);else i==d||i==m?le=kg(e,i,R):(i==g||i==(te|g))&&!f.length?le=Bg(e,i,o,c):le=io.apply(r,ce);var Ee=ee?rh:$h;return Dh(Ee(le,ce),e,i)}function Ih(e,i,o,c){return e===r||Lr(e,ln[o])&&!qe.call(c,o)?i:e}function Sh(e,i,o,c,f,w){return ht(e)&&ht(i)&&(w.set(i,e),Zs(e,i,r,Sh,w),w.delete(i)),e}function Kg(e){return Wn(e)?r:e}function xh(e,i,o,c,f,w){var P=o&M,R=e.length,U=i.length;if(R!=U&&!(P&&U>R))return!1;var B=w.get(e),V=w.get(i);if(B&&V)return B==i&&V==e;var G=-1,ee=!0,ce=o&J?new qi:r;for(w.set(e,i),w.set(i,e);++G<R;){var le=e[G],Ee=i[G];if(c)var fe=P?c(Ee,le,G,i,e,w):c(le,Ee,G,e,i,w);if(fe!==r){if(fe)continue;ee=!1;break}if(ce){if(!wa(i,function(xe,Te){if(!$n(ce,Te)&&(le===xe||f(le,xe,o,c,w)))return ce.push(Te)})){ee=!1;break}}else if(!(le===Ee||f(le,Ee,o,c,w))){ee=!1;break}}return w.delete(e),w.delete(i),ee}function Wg(e,i,o,c,f,w,P){switch(o){case Ve:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!w(new Fs(e),new Fs(i)));case z:case j:case Ce:return Lr(+e,+i);case A:return e.name==i.name&&e.message==i.message;case at:case Xe:return e==i+"";case _e:var R=xa;case je:var U=c&M;if(R||(R=Us),e.size!=i.size&&!U)return!1;var B=P.get(e);if(B)return B==i;c|=J,P.set(e,i);var V=xh(R(e),R(i),c,f,w,P);return P.delete(e),V;case Ze:if(Mn)return Mn.call(e)==Mn.call(i)}return!1}function Gg(e,i,o,c,f,w){var P=o&M,R=Qa(e),U=R.length,B=Qa(i),V=B.length;if(U!=V&&!P)return!1;for(var G=U;G--;){var ee=R[G];if(!(P?ee in i:qe.call(i,ee)))return!1}var ce=w.get(e),le=w.get(i);if(ce&&le)return ce==i&&le==e;var Ee=!0;w.set(e,i),w.set(i,e);for(var fe=P;++G<U;){ee=R[G];var xe=e[ee],Te=i[ee];if(c)var vr=P?c(Te,xe,ee,i,e,w):c(xe,Te,ee,e,i,w);if(!(vr===r?xe===Te||f(xe,Te,o,c,w):vr)){Ee=!1;break}fe||(fe=ee=="constructor")}if(Ee&&!fe){var rr=e.constructor,wr=i.constructor;rr!=wr&&"constructor"in e&&"constructor"in i&&!(typeof rr=="function"&&rr instanceof rr&&typeof wr=="function"&&wr instanceof wr)&&(Ee=!1)}return w.delete(e),w.delete(i),Ee}function si(e){return nc(Ah(e,r,zh),e+"")}function Qa(e){return Vu(e,qt,ec)}function Ya(e){return Vu(e,hr,Ph)}var Xa=Ws?function(e){return Ws.get(e)}:mc;function ao(e){for(var i=e.name+"",o=dn[i],c=qe.call(dn,i)?o.length:0;c--;){var f=o[c],w=f.func;if(w==null||w==e)return f.name}return i}function mn(e){var i=qe.call(v,"placeholder")?v:e;return i.placeholder}function he(){var e=v.iteratee||gc;return e=e===gc?Gu:e,arguments.length?e(arguments[0],arguments[1]):e}function co(e,i){var o=e.__data__;return ry(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Za(e){for(var i=qt(e),o=i.length;o--;){var c=i[o],f=e[c];i[o]=[c,f,Th(f)]}return i}function Hi(e,i){var o=sp(e,i);return Wu(o)?o:r}function Jg(e){var i=qe.call(e,Li),o=e[Li];try{e[Li]=r;var c=!0}catch{}var f=qs.call(e);return c&&(i?e[Li]=o:delete e[Li]),f}var ec=Oa?function(e){return e==null?[]:(e=Je(e),wi(Oa(e),function(i){return Cu.call(e,i)}))}:vc,Ph=Oa?function(e){for(var i=[];e;)bi(i,ec(e)),e=Hs(e);return i}:vc,Wt=er;(Na&&Wt(new Na(new ArrayBuffer(1)))!=Ve||Un&&Wt(new Un)!=_e||Ta&&Wt(Ta.resolve())!=xt||fn&&Wt(new fn)!=je||jn&&Wt(new jn)!=Fe)&&(Wt=function(e){var i=er(e),o=i==Pe?e.constructor:r,c=o?ki(o):"";if(c)switch(c){case Ap:return Ve;case Cp:return _e;case $p:return xt;case Dp:return je;case Up:return Fe}return i});function Qg(e,i,o){for(var c=-1,f=o.length;++c<f;){var w=o[c],P=w.size;switch(w.type){case"drop":e+=P;break;case"dropRight":i-=P;break;case"take":i=Kt(i,e+P);break;case"takeRight":e=jt(e,i-P);break}}return{start:e,end:i}}function Yg(e){var i=e.match(Ye);return i?i[1].split(Rt):[]}function Oh(e,i,o){i=xi(i,e);for(var c=-1,f=i.length,w=!1;++c<f;){var P=Qr(i[c]);if(!(w=e!=null&&o(e,P)))break;e=e[P]}return w||++c!=f?w:(f=e==null?0:e.length,!!f&&yo(f)&&oi(P,f)&&(we(e)||Bi(e)))}function Xg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Nh(e){return typeof e.constructor=="function"&&!Vn(e)?pn(Hs(e)):{}}function Zg(e,i,o){var c=e.constructor;switch(i){case $e:return Wa(e);case z:case j:return new c(+e);case Ve:return jg(e,o);case lt:case Me:case Pt:case Dt:case Ft:case Ht:case Lt:case Yt:case or:return hh(e,o);case _e:return new c;case Ce:case Xe:return new c(e);case at:return Lg(e);case je:return new c;case Ze:return Mg(e)}}function ey(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(mt,`{
/* [wrapped with `+i+`] */
`)}function ty(e){return we(e)||Bi(e)||!!($u&&e&&e[$u])}function oi(e,i){var o=typeof e;return i=i??X,!!i&&(o=="number"||o!="symbol"&&ia.test(e))&&e>-1&&e%1==0&&e<i}function tr(e,i,o){if(!ht(o))return!1;var c=typeof i;return(c=="number"?ur(o)&&oi(i,o.length):c=="string"&&i in o)?Lr(o[i],e):!1}function tc(e,i){if(we(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||mr(e)?!0:Ot.test(e)||!nt.test(e)||i!=null&&e in Je(i)}function ry(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function rc(e){var i=ao(e),o=v[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var c=Xa(o);return!!c&&e===c[0]}function iy(e){return!!Tu&&Tu in e}var ny=Ls?ai:wc;function Vn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||ln;return e===o}function Th(e){return e===e&&!ht(e)}function Rh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Je(o))}}function sy(e){var i=po(e,function(c){return o.size===_&&o.clear(),c}),o=i.cache;return i}function oy(e,i){var o=e[1],c=i[1],f=o|c,w=f<(te|ue|T),P=c==T&&o==d||c==T&&o==x&&e[7].length<=i[8]||c==(T|x)&&i[7].length<=i[8]&&o==d;if(!(w||P))return e;c&te&&(e[2]=i[2],f|=o&te?0:u);var R=i[3];if(R){var U=e[3];e[3]=U?fh(U,R,i[4]):R,e[4]=U?_i(e[3],E):i[4]}return R=i[5],R&&(U=e[5],e[5]=U?dh(U,R,i[6]):R,e[6]=U?_i(e[5],E):i[6]),R=i[7],R&&(e[7]=R),c&T&&(e[8]=e[8]==null?i[8]:Kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function ay(e){var i=[];if(e!=null)for(var o in Je(e))i.push(o);return i}function cy(e){return qs.call(e)}function Ah(e,i,o){return i=jt(i===r?e.length-1:i,0),function(){for(var c=arguments,f=-1,w=jt(c.length-i,0),P=q(w);++f<w;)P[f]=c[i+f];f=-1;for(var R=q(i+1);++f<i;)R[f]=c[f];return R[i]=o(P),Mt(e,this,R)}}function Ch(e,i){return i.length<2?e:Fi(e,Or(i,0,-1))}function uy(e,i){for(var o=e.length,c=Kt(i.length,o),f=cr(e);c--;){var w=i[c];e[c]=oi(w,o)?f[w]:r}return e}function ic(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var $h=Uh(rh),Kn=Sp||function(e,i){return Ne.setTimeout(e,i)},nc=Uh(Cg);function Dh(e,i,o){var c=i+"";return nc(e,ey(c,hy(Yg(c),o)))}function Uh(e){var i=0,o=0;return function(){var c=Np(),f=ze-(c-o);if(o=c,f>0){if(++i>=Ae)return arguments[0]}else i=0;return e.apply(r,arguments)}}function uo(e,i){var o=-1,c=e.length,f=c-1;for(i=i===r?c:i;++o<i;){var w=za(o,f),P=e[w];e[w]=e[o],e[o]=P}return e.length=i,e}var jh=sy(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Nt,function(o,c,f,w){i.push(f?w.replace(Yo,"$1"):c||o)}),i});function Qr(e){if(typeof e=="string"||mr(e))return e;var i=e+"";return i=="0"&&1/e==-de?"-0":i}function ki(e){if(e!=null){try{return Ms.call(e)}catch{}try{return e+""}catch{}}return""}function hy(e,i){return Ir(Br,function(o){var c="_."+o[0];i&o[1]&&!$s(e,c)&&e.push(c)}),e.sort()}function Lh(e){if(e instanceof Oe)return e.clone();var i=new xr(e.__wrapped__,e.__chain__);return i.__actions__=cr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function ly(e,i,o){(o?tr(e,i,o):i===r)?i=1:i=jt(be(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var f=0,w=0,P=q(Vs(c/i));f<c;)P[w++]=Or(e,f,f+=i);return P}function fy(e){for(var i=-1,o=e==null?0:e.length,c=0,f=[];++i<o;){var w=e[i];w&&(f[c++]=w)}return f}function dy(){var e=arguments.length;if(!e)return[];for(var i=q(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return bi(we(o)?cr(o):[o],kt(i,1))}var py=Se(function(e,i){return Et(e)?zn(e,kt(i,1,Et,!0)):[]}),gy=Se(function(e,i){var o=Nr(i);return Et(o)&&(o=r),Et(e)?zn(e,kt(i,1,Et,!0),he(o,2)):[]}),yy=Se(function(e,i){var o=Nr(i);return Et(o)&&(o=r),Et(e)?zn(e,kt(i,1,Et,!0),r,o):[]});function my(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),Or(e,i<0?0:i,c)):[]}function vy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Or(e,0,i<0?0:i)):[]}function wy(e,i){return e&&e.length?to(e,he(i,3),!0,!0):[]}function by(e,i){return e&&e.length?to(e,he(i,3),!0):[]}function _y(e,i,o,c){var f=e==null?0:e.length;return f?(o&&typeof o!="number"&&tr(e,i,o)&&(o=0,c=f),dg(e,i,o,c)):[]}function Mh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=o==null?0:be(o);return f<0&&(f=jt(c+f,0)),Ds(e,he(i,3),f)}function qh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=c-1;return o!==r&&(f=be(o),f=o<0?jt(c+f,0):Kt(f,c-1)),Ds(e,he(i,3),f,!0)}function zh(e){var i=e==null?0:e.length;return i?kt(e,1):[]}function Ey(e){var i=e==null?0:e.length;return i?kt(e,de):[]}function Iy(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:be(i),kt(e,i)):[]}function Sy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var f=e[i];c[f[0]]=f[1]}return c}function Fh(e){return e&&e.length?e[0]:r}function xy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=o==null?0:be(o);return f<0&&(f=jt(c+f,0)),an(e,i,f)}function Py(e){var i=e==null?0:e.length;return i?Or(e,0,-1):[]}var Oy=Se(function(e){var i=st(e,Va);return i.length&&i[0]===e[0]?Ua(i):[]}),Ny=Se(function(e){var i=Nr(e),o=st(e,Va);return i===Nr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Ua(o,he(i,2)):[]}),Ty=Se(function(e){var i=Nr(e),o=st(e,Va);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Ua(o,r,i):[]});function Ry(e,i){return e==null?"":Pp.call(e,i)}function Nr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Ay(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var f=c;return o!==r&&(f=be(o),f=f<0?jt(c+f,0):Kt(f,c-1)),i===i?hp(e,i,f):Ds(e,_u,f,!0)}function Cy(e,i){return e&&e.length?Xu(e,be(i)):r}var $y=Se(Hh);function Hh(e,i){return e&&e.length&&i&&i.length?qa(e,i):e}function Dy(e,i,o){return e&&e.length&&i&&i.length?qa(e,i,he(o,2)):e}function Uy(e,i,o){return e&&e.length&&i&&i.length?qa(e,i,r,o):e}var jy=si(function(e,i){var o=e==null?0:e.length,c=Aa(e,i);return th(e,st(i,function(f){return oi(f,o)?+f:f}).sort(lh)),c});function Ly(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,f=[],w=e.length;for(i=he(i,3);++c<w;){var P=e[c];i(P,c,e)&&(o.push(P),f.push(c))}return th(e,f),o}function sc(e){return e==null?e:Rp.call(e)}function My(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&tr(e,i,o)?(i=0,o=c):(i=i==null?0:be(i),o=o===r?c:be(o)),Or(e,i,o)):[]}function qy(e,i){return eo(e,i)}function zy(e,i,o){return Ha(e,i,he(o,2))}function Fy(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i);if(c<o&&Lr(e[c],i))return c}return-1}function Hy(e,i){return eo(e,i,!0)}function ky(e,i,o){return Ha(e,i,he(o,2),!0)}function By(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i,!0)-1;if(Lr(e[c],i))return c}return-1}function Vy(e){return e&&e.length?ih(e):[]}function Ky(e,i){return e&&e.length?ih(e,he(i,2)):[]}function Wy(e){var i=e==null?0:e.length;return i?Or(e,1,i):[]}function Gy(e,i,o){return e&&e.length?(i=o||i===r?1:be(i),Or(e,0,i<0?0:i)):[]}function Jy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Or(e,i<0?0:i,c)):[]}function Qy(e,i){return e&&e.length?to(e,he(i,3),!1,!0):[]}function Yy(e,i){return e&&e.length?to(e,he(i,3)):[]}var Xy=Se(function(e){return Si(kt(e,1,Et,!0))}),Zy=Se(function(e){var i=Nr(e);return Et(i)&&(i=r),Si(kt(e,1,Et,!0),he(i,2))}),em=Se(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Si(kt(e,1,Et,!0),r,i)});function tm(e){return e&&e.length?Si(e):[]}function rm(e,i){return e&&e.length?Si(e,he(i,2)):[]}function im(e,i){return i=typeof i=="function"?i:r,e&&e.length?Si(e,r,i):[]}function oc(e){if(!(e&&e.length))return[];var i=0;return e=wi(e,function(o){if(Et(o))return i=jt(o.length,i),!0}),Ia(i,function(o){return st(e,ba(o))})}function kh(e,i){if(!(e&&e.length))return[];var o=oc(e);return i==null?o:st(o,function(c){return Mt(i,r,c)})}var nm=Se(function(e,i){return Et(e)?zn(e,i):[]}),sm=Se(function(e){return Ba(wi(e,Et))}),om=Se(function(e){var i=Nr(e);return Et(i)&&(i=r),Ba(wi(e,Et),he(i,2))}),am=Se(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Ba(wi(e,Et),r,i)}),cm=Se(oc);function um(e,i){return ah(e||[],i||[],qn)}function hm(e,i){return ah(e||[],i||[],kn)}var lm=Se(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,kh(e,o)});function Bh(e){var i=v(e);return i.__chain__=!0,i}function fm(e,i){return i(e),e}function ho(e,i){return i(e)}var dm=si(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,f=function(w){return Aa(w,e)};return i>1||this.__actions__.length||!(c instanceof Oe)||!oi(o)?this.thru(f):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:ho,args:[f],thisArg:r}),new xr(c,this.__chain__).thru(function(w){return i&&!w.length&&w.push(r),w}))});function pm(){return Bh(this)}function gm(){return new xr(this.value(),this.__chain__)}function ym(){this.__values__===r&&(this.__values__=nl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function mm(){return this}function vm(e){for(var i,o=this;o instanceof Js;){var c=Lh(o);c.__index__=0,c.__values__=r,i?f.__wrapped__=c:i=c;var f=c;o=o.__wrapped__}return f.__wrapped__=e,i}function wm(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:ho,args:[sc],thisArg:r}),new xr(i,this.__chain__)}return this.thru(sc)}function bm(){return oh(this.__wrapped__,this.__actions__)}var _m=ro(function(e,i,o){qe.call(e,o)?++e[o]:ii(e,o,1)});function Em(e,i,o){var c=we(e)?wu:fg;return o&&tr(e,i,o)&&(i=r),c(e,he(i,3))}function Im(e,i){var o=we(e)?wi:ku;return o(e,he(i,3))}var Sm=mh(Mh),xm=mh(qh);function Pm(e,i){return kt(lo(e,i),1)}function Om(e,i){return kt(lo(e,i),de)}function Nm(e,i,o){return o=o===r?1:be(o),kt(lo(e,i),o)}function Vh(e,i){var o=we(e)?Ir:Ii;return o(e,he(i,3))}function Kh(e,i){var o=we(e)?Wd:Hu;return o(e,he(i,3))}var Tm=ro(function(e,i,o){qe.call(e,o)?e[o].push(i):ii(e,o,[i])});function Rm(e,i,o,c){e=ur(e)?e:wn(e),o=o&&!c?be(o):0;var f=e.length;return o<0&&(o=jt(f+o,0)),mo(e)?o<=f&&e.indexOf(i,o)>-1:!!f&&an(e,i,o)>-1}var Am=Se(function(e,i,o){var c=-1,f=typeof i=="function",w=ur(e)?q(e.length):[];return Ii(e,function(P){w[++c]=f?Mt(i,P,o):Fn(P,i,o)}),w}),Cm=ro(function(e,i,o){ii(e,o,i)});function lo(e,i){var o=we(e)?st:Ju;return o(e,he(i,3))}function $m(e,i,o,c){return e==null?[]:(we(i)||(i=i==null?[]:[i]),o=c?r:o,we(o)||(o=o==null?[]:[o]),Zu(e,i,o))}var Dm=ro(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function Um(e,i,o){var c=we(e)?va:Iu,f=arguments.length<3;return c(e,he(i,4),o,f,Ii)}function jm(e,i,o){var c=we(e)?Gd:Iu,f=arguments.length<3;return c(e,he(i,4),o,f,Hu)}function Lm(e,i){var o=we(e)?wi:ku;return o(e,go(he(i,3)))}function Mm(e){var i=we(e)?Mu:Rg;return i(e)}function qm(e,i,o){(o?tr(e,i,o):i===r)?i=1:i=be(i);var c=we(e)?ag:Ag;return c(e,i)}function zm(e){var i=we(e)?cg:$g;return i(e)}function Fm(e){if(e==null)return 0;if(ur(e))return mo(e)?un(e):e.length;var i=Wt(e);return i==_e||i==je?e.size:La(e).length}function Hm(e,i,o){var c=we(e)?wa:Dg;return o&&tr(e,i,o)&&(i=r),c(e,he(i,3))}var km=Se(function(e,i){if(e==null)return[];var o=i.length;return o>1&&tr(e,i[0],i[1])?i=[]:o>2&&tr(i[0],i[1],i[2])&&(i=[i[0]]),Zu(e,kt(i,1),[])}),fo=Ip||function(){return Ne.Date.now()};function Bm(e,i){if(typeof i!="function")throw new Sr(y);return e=be(e),function(){if(--e<1)return i.apply(this,arguments)}}function Wh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,ni(e,T,r,r,r,r,i)}function Gh(e,i){var o;if(typeof i!="function")throw new Sr(y);return e=be(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var ac=Se(function(e,i,o){var c=te;if(o.length){var f=_i(o,mn(ac));c|=g}return ni(e,c,i,o,f)}),Jh=Se(function(e,i,o){var c=te|ue;if(o.length){var f=_i(o,mn(Jh));c|=g}return ni(i,c,e,o,f)});function Qh(e,i,o){i=o?r:i;var c=ni(e,d,r,r,r,r,r,i);return c.placeholder=Qh.placeholder,c}function Yh(e,i,o){i=o?r:i;var c=ni(e,m,r,r,r,r,r,i);return c.placeholder=Yh.placeholder,c}function Xh(e,i,o){var c,f,w,P,R,U,B=0,V=!1,G=!1,ee=!0;if(typeof e!="function")throw new Sr(y);i=Tr(i)||0,ht(o)&&(V=!!o.leading,G="maxWait"in o,w=G?jt(Tr(o.maxWait)||0,i):w,ee="trailing"in o?!!o.trailing:ee);function ce(It){var Mr=c,ui=f;return c=f=r,B=It,P=e.apply(ui,Mr),P}function le(It){return B=It,R=Kn(xe,i),V?ce(It):P}function Ee(It){var Mr=It-U,ui=It-B,ml=i-Mr;return G?Kt(ml,w-ui):ml}function fe(It){var Mr=It-U,ui=It-B;return U===r||Mr>=i||Mr<0||G&&ui>=w}function xe(){var It=fo();if(fe(It))return Te(It);R=Kn(xe,Ee(It))}function Te(It){return R=r,ee&&c?ce(It):(c=f=r,P)}function vr(){R!==r&&ch(R),B=0,c=U=f=R=r}function rr(){return R===r?P:Te(fo())}function wr(){var It=fo(),Mr=fe(It);if(c=arguments,f=this,U=It,Mr){if(R===r)return le(U);if(G)return ch(R),R=Kn(xe,i),ce(U)}return R===r&&(R=Kn(xe,i)),P}return wr.cancel=vr,wr.flush=rr,wr}var Vm=Se(function(e,i){return Fu(e,1,i)}),Km=Se(function(e,i,o){return Fu(e,Tr(i)||0,o)});function Wm(e){return ni(e,Q)}function po(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Sr(y);var o=function(){var c=arguments,f=i?i.apply(this,c):c[0],w=o.cache;if(w.has(f))return w.get(f);var P=e.apply(this,c);return o.cache=w.set(f,P)||w,P};return o.cache=new(po.Cache||ri),o}po.Cache=ri;function go(e){if(typeof e!="function")throw new Sr(y);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Gm(e){return Gh(2,e)}var Jm=Ug(function(e,i){i=i.length==1&&we(i[0])?st(i[0],gr(he())):st(kt(i,1),gr(he()));var o=i.length;return Se(function(c){for(var f=-1,w=Kt(c.length,o);++f<w;)c[f]=i[f].call(this,c[f]);return Mt(e,this,c)})}),cc=Se(function(e,i){var o=_i(i,mn(cc));return ni(e,g,r,i,o)}),Zh=Se(function(e,i){var o=_i(i,mn(Zh));return ni(e,p,r,i,o)}),Qm=si(function(e,i){return ni(e,x,r,r,r,i)});function Ym(e,i){if(typeof e!="function")throw new Sr(y);return i=i===r?i:be(i),Se(e,i)}function Xm(e,i){if(typeof e!="function")throw new Sr(y);return i=i==null?0:jt(be(i),0),Se(function(o){var c=o[i],f=Pi(o,0,i);return c&&bi(f,c),Mt(e,this,f)})}function Zm(e,i,o){var c=!0,f=!0;if(typeof e!="function")throw new Sr(y);return ht(o)&&(c="leading"in o?!!o.leading:c,f="trailing"in o?!!o.trailing:f),Xh(e,i,{leading:c,maxWait:i,trailing:f})}function e0(e){return Wh(e,1)}function t0(e,i){return cc(Ka(i),e)}function r0(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function i0(e){return Pr(e,H)}function n0(e,i){return i=typeof i=="function"?i:r,Pr(e,H,i)}function s0(e){return Pr(e,N|H)}function o0(e,i){return i=typeof i=="function"?i:r,Pr(e,N|H,i)}function a0(e,i){return i==null||zu(e,i,qt(i))}function Lr(e,i){return e===i||e!==e&&i!==i}var c0=oo(Da),u0=oo(function(e,i){return e>=i}),Bi=Ku(function(){return arguments}())?Ku:function(e){return vt(e)&&qe.call(e,"callee")&&!Cu.call(e,"callee")},we=q.isArray,h0=Zt?gr(Zt):vg;function ur(e){return e!=null&&yo(e.length)&&!ai(e)}function Et(e){return vt(e)&&ur(e)}function l0(e){return e===!0||e===!1||vt(e)&&er(e)==z}var Oi=xp||wc,f0=Dr?gr(Dr):wg;function d0(e){return vt(e)&&e.nodeType===1&&!Wn(e)}function p0(e){if(e==null)return!0;if(ur(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Oi(e)||vn(e)||Bi(e)))return!e.length;var i=Wt(e);if(i==_e||i==je)return!e.size;if(Vn(e))return!La(e).length;for(var o in e)if(qe.call(e,o))return!1;return!0}function g0(e,i){return Hn(e,i)}function y0(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Hn(e,i,r,o):!!c}function uc(e){if(!vt(e))return!1;var i=er(e);return i==A||i==l||typeof e.message=="string"&&typeof e.name=="string"&&!Wn(e)}function m0(e){return typeof e=="number"&&Du(e)}function ai(e){if(!ht(e))return!1;var i=er(e);return i==ae||i==ye||i==F||i==wt}function el(e){return typeof e=="number"&&e==be(e)}function yo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=X}function ht(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var tl=Er?gr(Er):_g;function v0(e,i){return e===i||ja(e,i,Za(i))}function w0(e,i,o){return o=typeof o=="function"?o:r,ja(e,i,Za(i),o)}function b0(e){return rl(e)&&e!=+e}function _0(e){if(ny(e))throw new me(h);return Wu(e)}function E0(e){return e===null}function I0(e){return e==null}function rl(e){return typeof e=="number"||vt(e)&&er(e)==Ce}function Wn(e){if(!vt(e)||er(e)!=Pe)return!1;var i=Hs(e);if(i===null)return!0;var o=qe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Ms.call(o)==wp}var hc=Wr?gr(Wr):Eg;function S0(e){return el(e)&&e>=-X&&e<=X}var il=Cn?gr(Cn):Ig;function mo(e){return typeof e=="string"||!we(e)&&vt(e)&&er(e)==Xe}function mr(e){return typeof e=="symbol"||vt(e)&&er(e)==Ze}var vn=ji?gr(ji):Sg;function x0(e){return e===r}function P0(e){return vt(e)&&Wt(e)==Fe}function O0(e){return vt(e)&&er(e)==et}var N0=oo(Ma),T0=oo(function(e,i){return e<=i});function nl(e){if(!e)return[];if(ur(e))return mo(e)?Ur(e):cr(e);if(Dn&&e[Dn])return ap(e[Dn]());var i=Wt(e),o=i==_e?xa:i==je?Us:wn;return o(e)}function ci(e){if(!e)return e===0?e:0;if(e=Tr(e),e===de||e===-de){var i=e<0?-1:1;return i*W}return e===e?e:0}function be(e){var i=ci(e),o=i%1;return i===i?o?i-o:i:0}function sl(e){return e?zi(be(e),0,Z):0}function Tr(e){if(typeof e=="number")return e;if(mr(e))return Y;if(ht(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ht(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Su(e);var o=ea.test(e);return o||ra.test(e)?ve(e.slice(2),o?2:8):Zo.test(e)?Y:+e}function ol(e){return Jr(e,hr(e))}function R0(e){return e?zi(be(e),-X,X):e===0?e:0}function Le(e){return e==null?"":yr(e)}var A0=gn(function(e,i){if(Vn(i)||ur(i)){Jr(i,qt(i),e);return}for(var o in i)qe.call(i,o)&&qn(e,o,i[o])}),al=gn(function(e,i){Jr(i,hr(i),e)}),vo=gn(function(e,i,o,c){Jr(i,hr(i),e,c)}),C0=gn(function(e,i,o,c){Jr(i,qt(i),e,c)}),$0=si(Aa);function D0(e,i){var o=pn(e);return i==null?o:qu(o,i)}var U0=Se(function(e,i){e=Je(e);var o=-1,c=i.length,f=c>2?i[2]:r;for(f&&tr(i[0],i[1],f)&&(c=1);++o<c;)for(var w=i[o],P=hr(w),R=-1,U=P.length;++R<U;){var B=P[R],V=e[B];(V===r||Lr(V,ln[B])&&!qe.call(e,B))&&(e[B]=w[B])}return e}),j0=Se(function(e){return e.push(r,Sh),Mt(cl,r,e)});function L0(e,i){return bu(e,he(i,3),Gr)}function M0(e,i){return bu(e,he(i,3),$a)}function q0(e,i){return e==null?e:Ca(e,he(i,3),hr)}function z0(e,i){return e==null?e:Bu(e,he(i,3),hr)}function F0(e,i){return e&&Gr(e,he(i,3))}function H0(e,i){return e&&$a(e,he(i,3))}function k0(e){return e==null?[]:Xs(e,qt(e))}function B0(e){return e==null?[]:Xs(e,hr(e))}function lc(e,i,o){var c=e==null?r:Fi(e,i);return c===r?o:c}function V0(e,i){return e!=null&&Oh(e,i,pg)}function fc(e,i){return e!=null&&Oh(e,i,gg)}var K0=wh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),e[i]=o},pc(lr)),W0=wh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=qs.call(i)),qe.call(e,i)?e[i].push(o):e[i]=[o]},he),G0=Se(Fn);function qt(e){return ur(e)?Lu(e):La(e)}function hr(e){return ur(e)?Lu(e,!0):xg(e)}function J0(e,i){var o={};return i=he(i,3),Gr(e,function(c,f,w){ii(o,i(c,f,w),c)}),o}function Q0(e,i){var o={};return i=he(i,3),Gr(e,function(c,f,w){ii(o,f,i(c,f,w))}),o}var Y0=gn(function(e,i,o){Zs(e,i,o)}),cl=gn(function(e,i,o,c){Zs(e,i,o,c)}),X0=si(function(e,i){var o={};if(e==null)return o;var c=!1;i=st(i,function(w){return w=xi(w,e),c||(c=w.length>1),w}),Jr(e,Ya(e),o),c&&(o=Pr(o,N|L|H,Kg));for(var f=i.length;f--;)ka(o,i[f]);return o});function Z0(e,i){return ul(e,go(he(i)))}var ev=si(function(e,i){return e==null?{}:Og(e,i)});function ul(e,i){if(e==null)return{};var o=st(Ya(e),function(c){return[c]});return i=he(i),eh(e,o,function(c,f){return i(c,f[0])})}function tv(e,i,o){i=xi(i,e);var c=-1,f=i.length;for(f||(f=1,e=r);++c<f;){var w=e==null?r:e[Qr(i[c])];w===r&&(c=f,w=o),e=ai(w)?w.call(e):w}return e}function rv(e,i,o){return e==null?e:kn(e,i,o)}function iv(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:kn(e,i,o,c)}var hl=Eh(qt),ll=Eh(hr);function nv(e,i,o){var c=we(e),f=c||Oi(e)||vn(e);if(i=he(i,4),o==null){var w=e&&e.constructor;f?o=c?new w:[]:ht(e)?o=ai(w)?pn(Hs(e)):{}:o={}}return(f?Ir:Gr)(e,function(P,R,U){return i(o,P,R,U)}),o}function sv(e,i){return e==null?!0:ka(e,i)}function ov(e,i,o){return e==null?e:sh(e,i,Ka(o))}function av(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:sh(e,i,Ka(o),c)}function wn(e){return e==null?[]:Sa(e,qt(e))}function cv(e){return e==null?[]:Sa(e,hr(e))}function uv(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Tr(o),o=o===o?o:0),i!==r&&(i=Tr(i),i=i===i?i:0),zi(Tr(e),i,o)}function hv(e,i,o){return i=ci(i),o===r?(o=i,i=0):o=ci(o),e=Tr(e),yg(e,i,o)}function lv(e,i,o){if(o&&typeof o!="boolean"&&tr(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ci(e),i===r?(i=e,e=0):i=ci(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var f=Uu();return Kt(e+f*(i-e+We("1e-"+((f+"").length-1))),i)}return za(e,i)}var fv=yn(function(e,i,o){return i=i.toLowerCase(),e+(o?fl(i):i)});function fl(e){return dc(Le(e).toLowerCase())}function dl(e){return e=Le(e),e&&e.replace(Zr,rp).replace(ga,"")}function dv(e,i,o){e=Le(e),i=yr(i);var c=e.length;o=o===r?c:zi(be(o),0,c);var f=o;return o-=i.length,o>=0&&e.slice(o,f)==i}function pv(e){return e=Le(e),e&&it.test(e)?e.replace(Ai,ip):e}function gv(e){return e=Le(e),e&&Tt.test(e)?e.replace(gt,"\\$&"):e}var yv=yn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),mv=yn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),vv=yh("toLowerCase");function wv(e,i,o){e=Le(e),i=be(i);var c=i?un(e):0;if(!i||c>=i)return e;var f=(i-c)/2;return so(Ks(f),o)+e+so(Vs(f),o)}function bv(e,i,o){e=Le(e),i=be(i);var c=i?un(e):0;return i&&c<i?e+so(i-c,o):e}function _v(e,i,o){e=Le(e),i=be(i);var c=i?un(e):0;return i&&c<i?so(i-c,o)+e:e}function Ev(e,i,o){return o||i==null?i=0:i&&(i=+i),Tp(Le(e).replace(yt,""),i||0)}function Iv(e,i,o){return(o?tr(e,i,o):i===r)?i=1:i=be(i),Fa(Le(e),i)}function Sv(){var e=arguments,i=Le(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var xv=yn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function Pv(e,i,o){return o&&typeof o!="number"&&tr(e,i,o)&&(i=o=r),o=o===r?Z:o>>>0,o?(e=Le(e),e&&(typeof i=="string"||i!=null&&!hc(i))&&(i=yr(i),!i&&cn(e))?Pi(Ur(e),0,o):e.split(i,o)):[]}var Ov=yn(function(e,i,o){return e+(o?" ":"")+dc(i)});function Nv(e,i,o){return e=Le(e),o=o==null?0:zi(be(o),0,e.length),i=yr(i),e.slice(o,o+i.length)==i}function Tv(e,i,o){var c=v.templateSettings;o&&tr(e,i,o)&&(i=r),e=Le(e),i=vo({},i,c,Ih);var f=vo({},i.imports,c.imports,Ih),w=qt(f),P=Sa(f,w),R,U,B=0,V=i.interpolate||Zi,G="__p += '",ee=Pa((i.escape||Zi).source+"|"+V.source+"|"+(V===ut?Xo:Zi).source+"|"+(i.evaluate||Zi).source+"|$","g"),ce="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ya+"]")+`
`;e.replace(ee,function(fe,xe,Te,vr,rr,wr){return Te||(Te=vr),G+=e.slice(B,wr).replace(na,np),xe&&(R=!0,G+=`' +
__e(`+xe+`) +
'`),rr&&(U=!0,G+=`';
`+rr+`;
__p += '`),Te&&(G+=`' +
((__t = (`+Te+`)) == null ? '' : __t) +
'`),B=wr+fe.length,fe}),G+=`';
`;var le=qe.call(i,"variable")&&i.variable;if(!le)G=`with (obj) {
`+G+`
}
`;else if(Qo.test(le))throw new me(b);G=(U?G.replace(Vr,""):G).replace(Xt,"$1").replace(Xr,"$1;"),G="function("+(le||"obj")+`) {
`+(le?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(U?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Ee=gl(function(){return Ue(w,ce+"return "+G).apply(r,P)});if(Ee.source=G,uc(Ee))throw Ee;return Ee}function Rv(e){return Le(e).toLowerCase()}function Av(e){return Le(e).toUpperCase()}function Cv(e,i,o){if(e=Le(e),e&&(o||i===r))return Su(e);if(!e||!(i=yr(i)))return e;var c=Ur(e),f=Ur(i),w=xu(c,f),P=Pu(c,f)+1;return Pi(c,w,P).join("")}function $v(e,i,o){if(e=Le(e),e&&(o||i===r))return e.slice(0,Nu(e)+1);if(!e||!(i=yr(i)))return e;var c=Ur(e),f=Pu(c,Ur(i))+1;return Pi(c,0,f).join("")}function Dv(e,i,o){if(e=Le(e),e&&(o||i===r))return e.replace(yt,"");if(!e||!(i=yr(i)))return e;var c=Ur(e),f=xu(c,Ur(i));return Pi(c,f).join("")}function Uv(e,i){var o=se,c=pe;if(ht(i)){var f="separator"in i?i.separator:f;o="length"in i?be(i.length):o,c="omission"in i?yr(i.omission):c}e=Le(e);var w=e.length;if(cn(e)){var P=Ur(e);w=P.length}if(o>=w)return e;var R=o-un(c);if(R<1)return c;var U=P?Pi(P,0,R).join(""):e.slice(0,R);if(f===r)return U+c;if(P&&(R+=U.length-R),hc(f)){if(e.slice(R).search(f)){var B,V=U;for(f.global||(f=Pa(f.source,Le(_r.exec(f))+"g")),f.lastIndex=0;B=f.exec(V);)var G=B.index;U=U.slice(0,G===r?R:G)}}else if(e.indexOf(yr(f),R)!=R){var ee=U.lastIndexOf(f);ee>-1&&(U=U.slice(0,ee))}return U+c}function jv(e){return e=Le(e),e&&ft.test(e)?e.replace(mi,lp):e}var Lv=yn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),dc=yh("toUpperCase");function pl(e,i,o){return e=Le(e),i=o?r:i,i===r?op(e)?pp(e):Yd(e):e.match(i)||[]}var gl=Se(function(e,i){try{return Mt(e,r,i)}catch(o){return uc(o)?o:new me(o)}}),Mv=si(function(e,i){return Ir(i,function(o){o=Qr(o),ii(e,o,ac(e[o],e))}),e});function qv(e){var i=e==null?0:e.length,o=he();return e=i?st(e,function(c){if(typeof c[1]!="function")throw new Sr(y);return[o(c[0]),c[1]]}):[],Se(function(c){for(var f=-1;++f<i;){var w=e[f];if(Mt(w[0],this,c))return Mt(w[1],this,c)}})}function zv(e){return lg(Pr(e,N))}function pc(e){return function(){return e}}function Fv(e,i){return e==null||e!==e?i:e}var Hv=vh(),kv=vh(!0);function lr(e){return e}function gc(e){return Gu(typeof e=="function"?e:Pr(e,N))}function Bv(e){return Qu(Pr(e,N))}function Vv(e,i){return Yu(e,Pr(i,N))}var Kv=Se(function(e,i){return function(o){return Fn(o,e,i)}}),Wv=Se(function(e,i){return function(o){return Fn(e,o,i)}});function yc(e,i,o){var c=qt(i),f=Xs(i,c);o==null&&!(ht(i)&&(f.length||!c.length))&&(o=i,i=e,e=this,f=Xs(i,qt(i)));var w=!(ht(o)&&"chain"in o)||!!o.chain,P=ai(e);return Ir(f,function(R){var U=i[R];e[R]=U,P&&(e.prototype[R]=function(){var B=this.__chain__;if(w||B){var V=e(this.__wrapped__),G=V.__actions__=cr(this.__actions__);return G.push({func:U,args:arguments,thisArg:e}),V.__chain__=B,V}return U.apply(e,bi([this.value()],arguments))})}),e}function Gv(){return Ne._===this&&(Ne._=bp),this}function mc(){}function Jv(e){return e=be(e),Se(function(i){return Xu(i,e)})}var Qv=Ga(st),Yv=Ga(wu),Xv=Ga(wa);function yl(e){return tc(e)?ba(Qr(e)):Ng(e)}function Zv(e){return function(i){return e==null?r:Fi(e,i)}}var ew=bh(),tw=bh(!0);function vc(){return[]}function wc(){return!1}function rw(){return{}}function iw(){return""}function nw(){return!0}function sw(e,i){if(e=be(e),e<1||e>X)return[];var o=Z,c=Kt(e,Z);i=he(i),e-=Z;for(var f=Ia(c,i);++o<e;)i(o);return f}function ow(e){return we(e)?st(e,Qr):mr(e)?[e]:cr(jh(Le(e)))}function aw(e){var i=++vp;return Le(e)+i}var cw=no(function(e,i){return e+i},0),uw=Ja("ceil"),hw=no(function(e,i){return e/i},1),lw=Ja("floor");function fw(e){return e&&e.length?Ys(e,lr,Da):r}function dw(e,i){return e&&e.length?Ys(e,he(i,2),Da):r}function pw(e){return Eu(e,lr)}function gw(e,i){return Eu(e,he(i,2))}function yw(e){return e&&e.length?Ys(e,lr,Ma):r}function mw(e,i){return e&&e.length?Ys(e,he(i,2),Ma):r}var vw=no(function(e,i){return e*i},1),ww=Ja("round"),bw=no(function(e,i){return e-i},0);function _w(e){return e&&e.length?Ea(e,lr):0}function Ew(e,i){return e&&e.length?Ea(e,he(i,2)):0}return v.after=Bm,v.ary=Wh,v.assign=A0,v.assignIn=al,v.assignInWith=vo,v.assignWith=C0,v.at=$0,v.before=Gh,v.bind=ac,v.bindAll=Mv,v.bindKey=Jh,v.castArray=r0,v.chain=Bh,v.chunk=ly,v.compact=fy,v.concat=dy,v.cond=qv,v.conforms=zv,v.constant=pc,v.countBy=_m,v.create=D0,v.curry=Qh,v.curryRight=Yh,v.debounce=Xh,v.defaults=U0,v.defaultsDeep=j0,v.defer=Vm,v.delay=Km,v.difference=py,v.differenceBy=gy,v.differenceWith=yy,v.drop=my,v.dropRight=vy,v.dropRightWhile=wy,v.dropWhile=by,v.fill=_y,v.filter=Im,v.flatMap=Pm,v.flatMapDeep=Om,v.flatMapDepth=Nm,v.flatten=zh,v.flattenDeep=Ey,v.flattenDepth=Iy,v.flip=Wm,v.flow=Hv,v.flowRight=kv,v.fromPairs=Sy,v.functions=k0,v.functionsIn=B0,v.groupBy=Tm,v.initial=Py,v.intersection=Oy,v.intersectionBy=Ny,v.intersectionWith=Ty,v.invert=K0,v.invertBy=W0,v.invokeMap=Am,v.iteratee=gc,v.keyBy=Cm,v.keys=qt,v.keysIn=hr,v.map=lo,v.mapKeys=J0,v.mapValues=Q0,v.matches=Bv,v.matchesProperty=Vv,v.memoize=po,v.merge=Y0,v.mergeWith=cl,v.method=Kv,v.methodOf=Wv,v.mixin=yc,v.negate=go,v.nthArg=Jv,v.omit=X0,v.omitBy=Z0,v.once=Gm,v.orderBy=$m,v.over=Qv,v.overArgs=Jm,v.overEvery=Yv,v.overSome=Xv,v.partial=cc,v.partialRight=Zh,v.partition=Dm,v.pick=ev,v.pickBy=ul,v.property=yl,v.propertyOf=Zv,v.pull=$y,v.pullAll=Hh,v.pullAllBy=Dy,v.pullAllWith=Uy,v.pullAt=jy,v.range=ew,v.rangeRight=tw,v.rearg=Qm,v.reject=Lm,v.remove=Ly,v.rest=Ym,v.reverse=sc,v.sampleSize=qm,v.set=rv,v.setWith=iv,v.shuffle=zm,v.slice=My,v.sortBy=km,v.sortedUniq=Vy,v.sortedUniqBy=Ky,v.split=Pv,v.spread=Xm,v.tail=Wy,v.take=Gy,v.takeRight=Jy,v.takeRightWhile=Qy,v.takeWhile=Yy,v.tap=fm,v.throttle=Zm,v.thru=ho,v.toArray=nl,v.toPairs=hl,v.toPairsIn=ll,v.toPath=ow,v.toPlainObject=ol,v.transform=nv,v.unary=e0,v.union=Xy,v.unionBy=Zy,v.unionWith=em,v.uniq=tm,v.uniqBy=rm,v.uniqWith=im,v.unset=sv,v.unzip=oc,v.unzipWith=kh,v.update=ov,v.updateWith=av,v.values=wn,v.valuesIn=cv,v.without=nm,v.words=pl,v.wrap=t0,v.xor=sm,v.xorBy=om,v.xorWith=am,v.zip=cm,v.zipObject=um,v.zipObjectDeep=hm,v.zipWith=lm,v.entries=hl,v.entriesIn=ll,v.extend=al,v.extendWith=vo,yc(v,v),v.add=cw,v.attempt=gl,v.camelCase=fv,v.capitalize=fl,v.ceil=uw,v.clamp=uv,v.clone=i0,v.cloneDeep=s0,v.cloneDeepWith=o0,v.cloneWith=n0,v.conformsTo=a0,v.deburr=dl,v.defaultTo=Fv,v.divide=hw,v.endsWith=dv,v.eq=Lr,v.escape=pv,v.escapeRegExp=gv,v.every=Em,v.find=Sm,v.findIndex=Mh,v.findKey=L0,v.findLast=xm,v.findLastIndex=qh,v.findLastKey=M0,v.floor=lw,v.forEach=Vh,v.forEachRight=Kh,v.forIn=q0,v.forInRight=z0,v.forOwn=F0,v.forOwnRight=H0,v.get=lc,v.gt=c0,v.gte=u0,v.has=V0,v.hasIn=fc,v.head=Fh,v.identity=lr,v.includes=Rm,v.indexOf=xy,v.inRange=hv,v.invoke=G0,v.isArguments=Bi,v.isArray=we,v.isArrayBuffer=h0,v.isArrayLike=ur,v.isArrayLikeObject=Et,v.isBoolean=l0,v.isBuffer=Oi,v.isDate=f0,v.isElement=d0,v.isEmpty=p0,v.isEqual=g0,v.isEqualWith=y0,v.isError=uc,v.isFinite=m0,v.isFunction=ai,v.isInteger=el,v.isLength=yo,v.isMap=tl,v.isMatch=v0,v.isMatchWith=w0,v.isNaN=b0,v.isNative=_0,v.isNil=I0,v.isNull=E0,v.isNumber=rl,v.isObject=ht,v.isObjectLike=vt,v.isPlainObject=Wn,v.isRegExp=hc,v.isSafeInteger=S0,v.isSet=il,v.isString=mo,v.isSymbol=mr,v.isTypedArray=vn,v.isUndefined=x0,v.isWeakMap=P0,v.isWeakSet=O0,v.join=Ry,v.kebabCase=yv,v.last=Nr,v.lastIndexOf=Ay,v.lowerCase=mv,v.lowerFirst=vv,v.lt=N0,v.lte=T0,v.max=fw,v.maxBy=dw,v.mean=pw,v.meanBy=gw,v.min=yw,v.minBy=mw,v.stubArray=vc,v.stubFalse=wc,v.stubObject=rw,v.stubString=iw,v.stubTrue=nw,v.multiply=vw,v.nth=Cy,v.noConflict=Gv,v.noop=mc,v.now=fo,v.pad=wv,v.padEnd=bv,v.padStart=_v,v.parseInt=Ev,v.random=lv,v.reduce=Um,v.reduceRight=jm,v.repeat=Iv,v.replace=Sv,v.result=tv,v.round=ww,v.runInContext=D,v.sample=Mm,v.size=Fm,v.snakeCase=xv,v.some=Hm,v.sortedIndex=qy,v.sortedIndexBy=zy,v.sortedIndexOf=Fy,v.sortedLastIndex=Hy,v.sortedLastIndexBy=ky,v.sortedLastIndexOf=By,v.startCase=Ov,v.startsWith=Nv,v.subtract=bw,v.sum=_w,v.sumBy=Ew,v.template=Tv,v.times=sw,v.toFinite=ci,v.toInteger=be,v.toLength=sl,v.toLower=Rv,v.toNumber=Tr,v.toSafeInteger=R0,v.toString=Le,v.toUpper=Av,v.trim=Cv,v.trimEnd=$v,v.trimStart=Dv,v.truncate=Uv,v.unescape=jv,v.uniqueId=aw,v.upperCase=Lv,v.upperFirst=dc,v.each=Vh,v.eachRight=Kh,v.first=Fh,yc(v,function(){var e={};return Gr(v,function(i,o){qe.call(v.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),v.VERSION=s,Ir(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){v[e].placeholder=v}),Ir(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:jt(be(o),0);var c=this.__filtered__&&!i?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Kt(o,c.__takeCount__):c.__views__.push({size:Kt(o,Z),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Ir(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==S||o==ie;Oe.prototype[e]=function(f){var w=this.clone();return w.__iteratees__.push({iteratee:he(f,3),type:o}),w.__filtered__=w.__filtered__||c,w}}),Ir(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),Ir(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(lr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=Se(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return Fn(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(go(he(e)))},Oe.prototype.slice=function(e,i){e=be(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=be(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(Z)},Gr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),f=v[c?"take"+(i=="last"?"Right":""):i],w=c||/^find/.test(i);f&&(v.prototype[i]=function(){var P=this.__wrapped__,R=c?[1]:arguments,U=P instanceof Oe,B=R[0],V=U||we(P),G=function(xe){var Te=f.apply(v,bi([xe],R));return c&&ee?Te[0]:Te};V&&o&&typeof B=="function"&&B.length!=1&&(U=V=!1);var ee=this.__chain__,ce=!!this.__actions__.length,le=w&&!ee,Ee=U&&!ce;if(!w&&V){P=Ee?P:new Oe(this);var fe=e.apply(P,R);return fe.__actions__.push({func:ho,args:[G],thisArg:r}),new xr(fe,ee)}return le&&Ee?e.apply(this,R):(fe=this.thru(G),le?c?fe.value()[0]:fe.value():fe)})}),Ir(["pop","push","shift","sort","splice","unshift"],function(e){var i=js[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);v.prototype[e]=function(){var f=arguments;if(c&&!this.__chain__){var w=this.value();return i.apply(we(w)?w:[],f)}return this[o](function(P){return i.apply(we(P)?P:[],f)})}}),Gr(Oe.prototype,function(e,i){var o=v[i];if(o){var c=o.name+"";qe.call(dn,c)||(dn[c]=[]),dn[c].push({name:i,func:o})}}),dn[io(r,ue).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=jp,Oe.prototype.reverse=Lp,Oe.prototype.value=Mp,v.prototype.at=dm,v.prototype.chain=pm,v.prototype.commit=gm,v.prototype.next=ym,v.prototype.plant=vm,v.prototype.reverse=wm,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=bm,v.prototype.first=v.prototype.head,Dn&&(v.prototype[Dn]=mm),v},hn=gp();_t?((_t.exports=hn)._=hn,Ge._=hn):Ne._=hn}).call(ts)})(Zc,Zc.exports);var fx=Object.defineProperty,dx=Object.defineProperties,px=Object.getOwnPropertyDescriptors,Uf=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?fx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Io=(n,t)=>{for(var r in t||(t={}))gx.call(t,r)&&jf(n,r,t[r]);if(Uf)for(var r of Uf(t))yx.call(t,r)&&jf(n,r,t[r]);return n},mx=(n,t)=>dx(n,px(t));function Ti(n,t,r){var s;const a=rx(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${lx}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function Xi(n){return n.includes(":")?n.split(":")[1]:n}function Bd(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function vx(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const h=t.namespaces[a].accounts;s.push(...h)}),s}function wx(n={},t={}){const r=Lf(n),s=Lf(t);return Zc.exports.merge(r,s)}function Lf(n){var t,r,s,a;const h={};if(!nx(n))return h;for(const[y,b]of Object.entries(n)){const O=yu(y)?[y]:b.chains,_=b.methods||[],E=b.events||[],N=b.rpcMap||{},L=ns(y);h[L]=mx(Io(Io({},h[L]),b),{chains:jc(O,(t=h[L])==null?void 0:t.chains),methods:jc(_,(r=h[L])==null?void 0:r.methods),events:jc(E,(s=h[L])==null?void 0:s.events),rpcMap:Io(Io({},N),(a=h[L])==null?void 0:a.rpcMap)})}return h}function bx(n){return n.includes(":")?n.split(":")[2]:n}function _x(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],h=s.events||[],y=s.accounts||[],b=yu(r)?[r]:s.chains?s.chains:Bd(s.accounts);t[r]={chains:b,methods:a,events:h,accounts:y}}return t}function Lc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Vd={},ot=n=>Vd[n],Mc=(n,t)=>{Vd[n]=t};class Ex{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Xi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class Ix{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ti(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(Xi(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const h=parseInt(a,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Sx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Xi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class xx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Xi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class Px{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=Xi(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class Ox{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Xi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class Nx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=Xi(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new gi(new Ri(s,ot("disableProviderPing")))}}class Tx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ti(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(yi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ti(t,this.namespace);return typeof s>"u"?void 0:new gi(new Ri(s,ot("disableProviderPing")))}}var Rx=Object.defineProperty,Ax=Object.defineProperties,Cx=Object.getOwnPropertyDescriptors,Mf=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,Dx=Object.prototype.propertyIsEnumerable,qf=(n,t,r)=>t in n?Rx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,So=(n,t)=>{for(var r in t||(t={}))$x.call(t,r)&&qf(n,r,t[r]);if(Mf)for(var r of Mf(t))Dx.call(t,r)&&qf(n,r,t[r]);return n},qc=(n,t)=>Ax(n,Cx(t));class mu{constructor(t){this.events=new ru,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Re.pino(Re.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||$f})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new mu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:So({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Nf("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(h=>{this.session=h,this.namespaces||(this.namespaces=_x(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Hd)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Tf(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ZS.init({logger:this.providerOpts.logger||$f,relayUrl:this.providerOpts.relayUrl||cx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ns(r)))];Mc("client",this.client),Mc("events",this.events),Mc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=vx(r,this.session),a=Bd(s),h=wx(this.namespaces,this.optionalNamespaces),y=qc(So({},h[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new Ix({namespace:y});break;case"solana":this.rpcProviders[r]=new Sx({namespace:y});break;case"cosmos":this.rpcProviders[r]=new xx({namespace:y});break;case"polkadot":this.rpcProviders[r]=new Ex({namespace:y});break;case"cip34":this.rpcProviders[r]=new Px({namespace:y});break;case"elrond":this.rpcProviders[r]=new Ox({namespace:y});break;case"multiversx":this.rpcProviders[r]=new Nx({namespace:y});break;case"near":this.rpcProviders[r]=new Tx({namespace:y});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Tf(a)&&this.events.emit("accountsChanged",a.map(bx))}else if(s.name==="chainChanged"){const a=r.chainId,h=r.event.data,y=ns(a),b=Lc(a)!==Lc(h)?`${y}:${Lc(h)}`:a;this.onChainChanged(b)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,h=(s=this.client)==null?void 0:s.session.get(t);this.session=qc(So({},h),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",qc(So({},Nf("USER_DISCONNECTED")),{data:t.topic}))}),this.on(yi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(y=>ns(y)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=ns(Object.keys(this.namespaces)[0]),h=this.rpcProviders[a].getDefaultChain();return[a,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,h]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(h),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Df}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Df}/${t}`)}}const Ux=mu,jx="wc",Lx="ethereum_provider",Mx=`${jx}@2:${Lx}:`,qx="https://rpc.walletconnect.com/v1/",eu=["eth_sendTransaction","personal_sign"],zx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],tu=["chainChanged","accountsChanged"],Fx=["chainChanged","accountsChanged","message","disconnect","connect"];var Hx=Object.defineProperty,kx=Object.defineProperties,Bx=Object.getOwnPropertyDescriptors,zf=Object.getOwnPropertySymbols,Vx=Object.prototype.hasOwnProperty,Kx=Object.prototype.propertyIsEnumerable,Ff=(n,t,r)=>t in n?Hx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ss=(n,t)=>{for(var r in t||(t={}))Vx.call(t,r)&&Ff(n,r,t[r]);if(zf)for(var r of zf(t))Kx.call(t,r)&&Ff(n,r,t[r]);return n},Hf=(n,t)=>kx(n,Bx(t));function Uo(n){return Number(n[0].split(":")[1])}function zc(n){return`0x${n.toString(16)}`}function Wx(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:h,optionalEvents:y,rpcMap:b}=n;if(!Hc(t))throw new Error("Invalid chains");const O={chains:t,methods:s||eu,events:h||tu,rpcMap:ss({},t.length?{[Uo(t)]:b[Uo(t)]}:{})},_=h==null?void 0:h.filter(H=>!tu.includes(H)),E=s==null?void 0:s.filter(H=>!eu.includes(H));if(!r&&!y&&!a&&!(_!=null&&_.length)&&!(E!=null&&E.length))return{required:t.length?O:void 0};const N=(_==null?void 0:_.length)&&(E==null?void 0:E.length)||!r,L={chains:[...new Set(N?O.chains.concat(r||[]):r)],methods:[...new Set(O.methods.concat(a!=null&&a.length?a:zx))],events:[...new Set(O.events.concat(y!=null&&y.length?y:Fx))],rpcMap:b};return{required:t.length?O:void 0,optional:r.length?L:void 0}}class vu{constructor(){this.events=new Cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Mx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new vu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=Wx(this.rpc);try{const a=await new Promise(async(y,b)=>{var O;this.rpc.showQrModal&&((O=this.modal)==null||O.subscribeModal(_=>{!_.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),b(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Hf(ss({namespaces:ss({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(_=>{y(_)}).catch(_=>{b(new Error(_.message))})});if(!a)return;const h=eb(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:zc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",zc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Hf(ss({},rb("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",zc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],h=(s=t==null?void 0:t.optionalChains)!=null?s:[],y=a.concat(h);if(!y.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const b=a.length?(t==null?void 0:t.methods)||eu:[],O=a.length?(t==null?void 0:t.events)||tu:[],_=(t==null?void 0:t.optionalMethods)||[],E=(t==null?void 0:t.optionalEvents)||[],N=(t==null?void 0:t.rpcMap)||this.buildRpcMap(y,t.projectId),L=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(H=>this.formatChainId(H)),optionalChains:h.map(H=>this.formatChainId(H)),methods:b,events:O,optionalMethods:_,optionalEvents:E,rpcMap:N,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:L,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Uo(this.rpc.chains):Uo(this.rpc.optionalChains),this.signer=await Ux.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Mw(()=>import("./index-X8Gy0Qgl.js.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ss({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Hc(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)})),s&&Hc(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(h=>this.formatChainId(h)),s.forEach(h=>{this.rpc.rpcMap[h]=(a==null?void 0:a[h])||this.getRpcUrl(h)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${qx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const pP=vu;export{pP as EthereumProvider,Fx as OPTIONAL_EVENTS,zx as OPTIONAL_METHODS,tu as REQUIRED_EVENTS,eu as REQUIRED_METHODS,vu as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-X8Gy0Qgl.js","assets/index-K6XkS2Nf.js","assets/index-2dimJmuZ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}